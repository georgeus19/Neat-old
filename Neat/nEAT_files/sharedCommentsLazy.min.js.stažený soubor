(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[10],{526:function(t,e,n){"use strict";n.r(e);var o=n(91),r=n(49),i=n(13),a=n(210),s=n(3),c=n(20),l=n(32),d=n(338),p=n(678),u=n(679),f=n(144),h=n(145),m=n(19),y=n(332),g=n(335),b=n(656),v=n(315);var C=n(17),x=n(1),T=n(411),O=n(528),S=n(311),E=n(601),P=n(635),w=n(543),I=n(119),k=n(0),R=n(186),A=n(71),D=n(309),j=n(198),N=n(16),M=n(642),_=n(169),B=n(306),L=n(687),F=n(136),H=n(267),U=n(26),z=n(201),V=n(643),q=n(82),K=n(647),G=n(515),W={fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',width:"300px"},Y=Object(F.a)({height:"100%"}),Q=Object(F.a)({display:"flex",flexDirection:"column",alignItems:"stretch",height:"100%",overflowX:"hidden",overflowY:"hidden",selectors:{":focus":{color:"#333333",outline:"thin dotted"}}}),J=Object(F.a)({display:"flex",flexDirection:"column",flex:"1 1 auto",overflowY:"auto",overflowX:"hidden",justifyContent:"space-between",selectors:{":focus":{outline:"none"},"::-webkit-scrollbar-button:start:increment":{display:"none"},"::-webkit-scrollbar-button:end:decrement":{display:"none"}}}),X=Object(F.a)({display:"flex",flex:"1 0 auto"}),Z=Object(F.a)({display:"flex",flexDirection:"row",direction:"inherit",flexWrap:"nowrap",overflow:"hidden",width:V.a,minHeight:"26px",paddingRight:"22px",paddingLeft:"10px",paddingTop:"12px",paddingBottom:"6px",backgroundColor:"transparent",outline:"none"}),$=Object(F.a)({fontWeight:"normal",fontFamily:'"Segoe UI Light", "Segoe UI Web", Arial, Verdana, sans-serif',fontSize:"21px",lineHeight:"21px",flexGrow:1,outline:"none",alignContent:"center"}),tt={root:{color:q.a.GRAY_E,padding:0,border:"1px solid transparent",margin:0,width:"21px",height:"21px",alignContent:"center",marginLeft:"0px",selectors:{".ms-Fabric--isFocusVisible &:focus::after":G.l,".ms-Button-flexContainer":{position:"relative"}}},icon:{color:q.a.GRAY_F,margin:0,marginTop:-1,width:"16px"},iconHovered:{color:q.a.GRAY_J},iconPressed:{color:q.a.GRAY_J},rootPressed:{color:q.a.GRAY_J},rootHovered:Object(F.a)({color:q.a.GRAY_J},G.k),rootFocused:Object(F.a)({color:"#333333",outline:"none",border:"1px dotted"},G.j)},et=Object(F.a)({color:"#333333",fontWeight:"normal",fontFamily:"inherit",fontSize:"12px",outline:"none",border:"1px solid transparent",marginLeft:"9px",marginRight:"9px",marginTop:"8px",selectors:{":focus":{color:"#333333",outline:"none",border:"1px dotted"}}}),nt={clip:"rect(1px, 1px, 1px, 1px)",height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1},ot={selectors:{"& .ms-Spinner-circle":{borderColor:K.a,borderTopColor:K.b}}},rt=Object(F.a)({display:"flex",flexDirection:"row-reverse",direction:"inherit",flexWrap:"nowrap",overflow:"hidden",width:V.a,minHeight:"41px",marginBottom:"5px",paddingLeft:"10px",paddingBottom:0,backgroundColor:"transparent",outline:"none"}),it={root:G.c.DEFAULT,icon:{width:"16px",padding:"8px",paddingLeft:"12px",margin:0,marginBottom:"16px",marginTop:"16px"},label:{fontSize:"14px",textAlign:"right",fontFamily:"inherit",padding:"8px",paddingRight:"12px",paddingLeft:0,margin:0,marginBottom:"16px",marginTop:"16px"},rootHovered:G.c.HOVER,rootPressed:G.c.PRESSED,rootFocused:G.c.FOCUSED,rootDisabled:G.c.DISABLED,iconHovered:{color:q.a.GRAY_J},iconPressed:{color:q.a.GRAY_J},labelHovered:{color:q.a.GRAY_J}},at=Object(U.b)(function(){return{paneContainer:Q,listContainer:J,commentList:X,paneHeader:Z,paneTitle:Object(F.a)($,{color:Object(z.a)().primary}),iconClosePane:tt,emptyPaneMessage:et,offscreenLiveRegion:nt,spinnerStyles:ot,newCommentButtonContainer:rt,newCommentButton:Object(H.a)(it,{icon:{color:Object(z.a)().primary}}),focusTrapZone:Y}}),st=Object(U.b)(function(){return{paneContainer:Q,listContainer:J,commentList:X,paneHeader:Z,paneTitle:Object(F.a)($,{color:"#333333"}),iconClosePane:tt,emptyPaneMessage:et,offscreenLiveRegion:nt,spinnerStyles:ot,newCommentButtonContainer:rt,newCommentButton:it,focusTrapZone:Y}}),ct=n(645),lt=n(110),dt=n(50),pt=Object(U.b)(function(t){return{labelContainer:Object(F.a)({display:"flex",color:q.a.GRAY_E,opacity:"100%",fontFamily:"inherit",fontSize:"12px",lineHeight:"1.3",justifyContent:"center",width:V.a,marginTop:"7px",marginBottom:"10px",minHeight:"20px"}),cardContainer:Object(F.a)({display:"flex",flexDirection:"column",width:V.a,cursor:"pointer",marginTop:"20px",marginRight:"8px",marginLeft:"8px",backgroundColor:"transparent",flexGrow:0,transition:"ease-in-out",transitionProperty:"margin-top,max-height,min-height",transitionDuration:"0.20s",minHeight:"70px",maxHeight:"70px",border:"1px solid transparent",selectors:{":hover":Object(F.a)({marginTop:"5px",minHeight:"85px",maxHeight:"85px"},G.k),":focus":Object(F.a)({color:"#333333",outline:"none",border:"1px dotted"},G.j)}}),ghostCardContainer:Object(F.a)({width:V.a,overflow:"hidden"}),svgStyle:Object(F.a)({width:V.a},t&&{transform:"scaleX(-1)"})}}),ut=function(t){function e(e){var n=t.call(this,e)||this;return n.clickHandler=n.clickHandler.bind(n),n.keyDownHandler=n.keyDownHandler.bind(n),n}return x.d(e,t),e.prototype.clickHandler=function(t){this.props.onClick&&this.props.onClick(),t.stopPropagation()},e.prototype.keyDownHandler=function(t){Object(_.c)(t.key)===_.a.Enter&&(this.props.onClick&&this.props.onClick(),t.stopPropagation())},e.prototype.render=function(){var t=n(751),e=Object(lt.a)(),o=pt(e);return k.createElement("div",{title:this.props.ghostCommentString,"aria-label":this.props.accessibilityLabel,id:dt.t(this.props.id),className:o.cardContainer,role:"button",onClick:this.clickHandler,onKeyDown:this.keyDownHandler,tabIndex:0},k.createElement("span",{className:o.labelContainer},this.props.ghostCommentString),k.createElement("span",{className:o.ghostCardContainer},k.createElement(t,{className:o.svgStyle,focusable:!1})))},e}(k.PureComponent),ft=n(689),ht=n(646),mt=n(640),yt=n(680),gt=n(657),bt=n(304),vt=n(648),Ct=n(94),xt=function(t){function e(e){var n=t.call(this,e)||this;return n.onRenderCell=function(t,e){return n.renderCommentThread(t,{accessibilityPositionInSet:void 0!==e?e+1:void 0,accessibilitySetSize:n.state.allRenderableItemThreads.length})},n.onRenderPage=n.onRenderPage.bind(n),n.scrollToThreadById=n.scrollToThreadById.bind(n),n.closePaneButtonClickHandler=n.closePaneButtonClickHandler.bind(n),n.closePaneButtonKeyDownHandler=n.closePaneButtonKeyDownHandler.bind(n),n.onReceiveListRef=n.onReceiveListRef.bind(n),n.paneFocusHandler=n.paneFocusHandler.bind(n),n.setPaneRootDivRef=n.setPaneRootDivRef.bind(n),n.newCommentButtonClickHandler=n.newCommentButtonClickHandler.bind(n),n.newCommentButtonKeyDownHandler=n.newCommentButtonKeyDownHandler.bind(n),n.getMentionableCommentEditorProps=Object(D.a)(n.getMentionableCommentEditorProps.bind(n)),n.styles=i.g()?at():st(),n.state=n.getInitialState(e),n}return x.d(e,t),e.prototype.onReceiveListRef=function(t){this.listRef=t},e.prototype.isPaneEmpty=function(){var t=this.props.nextPopulatedContextDetails===A.a.NoComments;return t&&Object(s.g)().assertConditionTag(!this.props.dataItems.length,"CommentData length should be 0 if NextPopulatedContextDetails is NoComments.",595981022),t&&!this.props.dataItems.length&&!this.props.createdCommentLie},e.prototype.scrollToThreadById=function(t){var e=this;if(this.listRef){var n=this.state.allRenderableItemThreads,o=Math.max(n.findIndex(function(e){return Ct.f(e).commentId===t}),0);this.listRef.scrollToIndex(o,function(t){return e.getCardScrollHeight(t,n)})}},e.prototype.paneFocusHandler=function(t){t.target===this.paneRootRef&&this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)},e.prototype.setPaneRootDivRef=function(t){this.paneRootRef=t},e.prototype.closePaneButtonClickHandler=function(t){this.closePane(),t.stopPropagation()},e.prototype.closePaneButtonKeyDownHandler=function(t){Object(_.c)(t.key)===_.a.Enter&&(this.closePane(),t.preventDefault(),t.stopPropagation())},e.prototype.newCommentButtonClickHandler=function(t){this.createNewComment(),t.stopPropagation()},e.prototype.newCommentButtonKeyDownHandler=function(t){Object(_.c)(t.key)===_.a.Enter&&(this.createNewComment(),t.stopPropagation())},e.prototype.createNewComment=function(){this.props.requestCreateCommentSession({renderContextType:this.props.componentTree.renderContextType,trackback:s.f.reserveTag(595882845),telemetryVisitor:this.props.telemetryVisitor})},e.prototype.getGhostCommentProps=function(){var t=bt.e(this.props.localizationAPI,this.props.nextPopulatedContextDetails);return{id:dt.u(),onClick:this.onGhostCommentClicked,ghostCommentString:t,accessibilityLabel:t}},e.prototype.onContextChanged=function(){},e.prototype.getAuthToken=function(){},e.prototype.renderCommentPaneHeader=function(){return k.createElement("div",{className:this.styles.paneHeader,tabIndex:-1},k.createElement("div",{className:this.styles.paneTitle,tabIndex:-1},this.props.localizationAPI.getString(18)),k.createElement(O.a,{id:dt.l(),styles:this.styles.iconClosePane,onClick:this.closePaneButtonClickHandler,onKeyDown:this.closePaneButtonKeyDownHandler,iconProps:{iconName:"CancelGlyph"},title:this.props.localizationAPI.getString(19),ariaLabel:this.props.localizationAPI.getString(20),tabIndex:0}))},e.prototype.renderNewCommentButton=function(){if(!i.q()||this.props.readOnly)return null;var t=!Object(j.a)(this.props.focusedCommentInfo?this.props.focusedCommentInfo.focusedComment:void 0,this.props.createdCommentLie),e=i.n();return k.createElement("div",{className:this.styles.newCommentButtonContainer},k.createElement(S.a,{id:dt.x(),styles:this.styles.newCommentButton,text:this.props.localizationAPI.getString(91),ariaLabel:this.props.localizationAPI.getString(92),iconProps:{iconName:"NewComment"},onClick:this.newCommentButtonClickHandler,onKeyDown:this.newCommentButtonKeyDownHandler,disabled:t,allowDisabledFocus:e,tabIndex:t&&e?-1:0}))},e.prototype.renderEmptyPaneMessage=function(){return k.createElement("div",{className:this.styles.emptyPaneMessage,id:dt.u(),"aria-label":this.props.localizationAPI.getString(13),tabIndex:0},this.props.localizationAPI.getString(13))},e.prototype.onRenderPage=function(t,e){if(this.props.virtualized&&t.page.items){var n=t.page.items.map(function(t){return t[0].commentId});n.length&&this.onLoadThreads(n)}return e?e(t):null},e.prototype.getCreateCommentInitialHeight=function(){return 0},e.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:ht.a.ExpandedCardOrFirstCardTabbable,postTabbingMode:ht.b.ExpandedCardRootPostTabbable}},e.prototype.componentDidUpdate=function(e,n){var o=e.focusedCommentInfo?e.focusedCommentInfo.focusedComment.selectedCardId:void 0,r=this.props.focusedCommentInfo?this.props.focusedCommentInfo.focusedComment.selectedCardId:void 0,i=o!==r,a=Object(L.b)(e),s=Object(L.b)(this.props);i?r&&this.scrollToThreadById(r):!this.props.focusedCommentInfo&&a!==s&&s&&this.scrollToThreadById(s),!this.listRef||this.props.focusedCommentInfo===e.focusedCommentInfo&&this.props.cardViewStates===e.cardViewStates&&this.props.postViewStates===e.postViewStates&&this.props.highlightedCommentId===e.highlightedCommentId&&this.props.atMentionState===e.atMentionState||this.listRef.forceUpdate(),t.prototype.componentDidUpdate.call(this,e,n)},e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this)},e.prototype.UNSAFE_componentWillReceiveProps=function(t){var e=this.getUpdatedItemThreads(t);this.setState({allRenderableItemThreads:e})},e.prototype.getCardScrollHeight=function(t,e){return Object(s.g)().assertConditionTag(void 0!==e[t],"No comment thread in the given index: '"+t+"'. Thread length: '"+e.length+"'",595981023),e[t]&&1===e[t].length?160:e[t]&&2===e[t].length?206:235},e.prototype.getChildContext=function(){return{getComponent:this.props.componentTree.getComponent,getComponentById:this.props.componentTree.getComponentById,getComponentByTag_deprecated:this.props.componentTree.getComponentByTag_deprecated,isEventTarget:this.props.componentTree.isEventTarget,isFocusWithin:this.props.componentTree.isFocusWithin,isFocusWithinAny:this.props.componentTree.isFocusWithinAny,isFocusWithinPane:this.props.componentTree.isFocusWithinPane,isFocusOn:this.props.componentTree.isFocusOn,getCurrentlyFocused:this.props.componentTree.getCurrentlyFocused,renderContextType:this.props.componentTree.renderContextType}},e.prototype.getCommentCardStyleOptions=function(t){return{highlightCard:this.props.highlightedCommentId&&this.props.highlightedCommentId===t||Object(L.b)(this.props)===t,restrictActionControls:this.props.focusedCommentInfo&&Object(N.i)(this.props.focusedCommentInfo.focusedComment.focusDetails)}},e.prototype.cardOnDelete=function(e){if(!i.B()){var n=this.getLiveRegion();n&&n.appendLiveRegionUpdate(this.props.localizationAPI.getString(63))}return t.prototype.cardOnDelete.call(this,e),i.q()?this.focusNewCommentButton():this.focusClosePaneButton()},e.prototype.onCardReplyCancel=function(e){if(!i.B()){var n=this.getLiveRegion();n&&n.appendLiveRegionUpdate(this.props.localizationAPI.getString(64))}t.prototype.onCardReplyCancel.call(this,e)},e.prototype.onCardDraftCancel=function(e){if(!i.B()){var n=this.getLiveRegion();n&&n.appendLiveRegionUpdate(this.props.localizationAPI.getString(103))}t.prototype.onCardDraftCancel.call(this,e),i.n()&&(i.q()?this.focusNewCommentButton():this.focusClosePaneButton())},e.prototype.getCommentPostStyleOptions=function(t,e){var n=this.getRestrictActionControls(t,e),o=void 0!==this.props.focusedCommentInfo?this.props.focusedCommentInfo.focusedComment:void 0,r=e||t,i=Object(vt.b)(r,o),a=i===M.a.Expanded,s=i===M.a.Collapsed;return{restrictActionControls:n,hideTimestamp:s,showFullComment:a,collapsed:s}},e.prototype.onPostCancel=function(e){if(!i.B()){var n=this.getLiveRegion();n&&n.appendLiveRegionUpdate(this.props.localizationAPI.getString(66))}t.prototype.onPostCancel.call(this,e)},e.prototype.onPostCommit=function(e){if(!i.B()){var n=this.getLiveRegion();n&&n.appendLiveRegionUpdate(this.props.localizationAPI.getString(67))}t.prototype.onPostCommit.call(this,e)},e.prototype.focusClosePaneButton=function(){var t=document.getElementById(dt.l());return!!t&&(t.focus(),!0)},e.prototype.focusNewCommentButton=function(){var t=document.getElementById(dt.x());return!!t&&(t.focus(),!0)},e.prototype.cardOnFocusNextTabStop_deprecated=function(){return!i.e()&&(!this.shouldShowGhostComment()&&this.focusClosePaneButton())},e.prototype.cardOnFocusPreviousTabStop_deprecated=function(){return!i.e()&&(!this.shouldShowGhostComment()&&(i.q()?this.focusNewCommentButton():this.focusClosePaneButton()))},e.prototype.onGetUserContacts=function(t,e,n){return gt.m(t,e,n,this.props)},e.prototype.onCloseCanceled=function(){t.prototype.onCloseCanceled.call(this);var e=document.getElementById(dt.s());e&&e.focus()},e.prototype.invokeModalDialog=function(t,e,n){var o=Object(s.g)().createActivityObject("InvokeModalDialog",this.props.telemetryVisitor,s.a.None);switch(o.addDataField(s.c.ModalDialogMode,t,s.d.SystemMetadata),t){case B.a.ClosePaneDraft:var r,i=bt.c(this.props.localizationAPI),a=new Promise(function(t){r=t});return this.props.requestModalConfirmation({renderContextType:this.props.componentTree.renderContextType,trackback:s.f.reserveTag(595928218),telemetryVisitor:this.props.telemetryVisitor},function(){return r(e())},function(){return r(n())},i),o.successTag(595981199),a;default:return Object(s.g)().assertConditionTag(!1,"ModalDialogMode "+t+" not implemented for web",595981025),o.failTag(595981026,-2130957557),Promise.resolve(R.a.Unhandled)}},e.prototype.getMentionableCommentEditorProps=function(t,e){if(Object(yt.a)(t,e))return{onMentionCreated:this.onMentionCreated,onCurrentMentionsUpdated:this.onCurrentMentionsUpdated,peoplePickerProps:{onGetUserContacts:this.onGetUserContacts,pickerLocalizationDetails:bt.g(this.props.localizationAPI),preventDismissOnScroll:i.z()}}},e.prototype.onAtMentionCapabilityStateChange=function(){},e.prototype.getComponentTree=function(){return this.props.componentTree},e.prototype.showDiscardDialogOnPostCancel=function(){return!1},e.prototype.render=function(){var t=this.paneContainerKeyDownHandler.onKeyDown,e=i.f()?-1:0,n=null;return n=this.isReadyToRender()?this.isPaneEmpty()?i.K()?k.createElement("div",{id:dt.s(),ref:this.setPaneRootDivRef,onFocus:this.paneFocusHandler,className:this.styles.paneContainer,onKeyDown:t,tabIndex:e,style:W},this.renderCommentPaneHeader(),this.renderNewCommentButton(),this.renderEmptyPaneMessage(),k.createElement(ft.a,{ref:this.liveRegionRef})):k.createElement("div",{id:dt.s(),ref:this.setPaneRootDivRef,onFocus:this.paneFocusHandler,className:this.styles.paneContainer,onKeyDown:t,tabIndex:e,style:W},this.renderCommentPaneHeader(),this.renderNewCommentButton(),this.renderEmptyPaneMessage()):k.createElement("div",{ref:this.setPaneRootDivRef,id:dt.s(),"aria-label":this.props.localizationAPI.getString(31),className:this.styles.paneContainer,onKeyDown:t,tabIndex:-1,style:W,onFocus:this.paneFocusHandler},this.renderCommentPaneHeader(),this.renderNewCommentButton(),k.createElement(ct.b,{ref:this.getContentManagerRef},k.createElement("div",{"data-is-scrollable":"true",className:this.styles.listContainer,onKeyDown:this.commentContentsKeyDownHandler.onKeyDown,tabIndex:-1},k.createElement(P.a,{ref:this.onReceiveListRef,className:this.styles.commentList,items:this.state.allRenderableItemThreads,role:"tree",onRenderPage:this.onRenderPage,onRenderCell:this.onRenderCell,"aria-label":this.props.localizationAPI.getString(32)}),this.shouldShowGhostComment()?k.createElement(ut,x.a({},this.getGhostCommentProps())):void 0)),k.createElement(ft.a,{ref:this.liveRegionRef})):k.createElement("div",{id:dt.s(),ref:this.setPaneRootDivRef,onFocus:this.paneFocusHandler,className:this.styles.paneContainer,onKeyDown:t,tabIndex:e,style:W},this.renderCommentPaneHeader(),this.renderNewCommentButton(),k.createElement(T.a,{delay:G.f},k.createElement(w.a,{size:I.a.large,className:this.styles.spinnerStyles}))),i.e()?k.createElement(E.a,{className:this.styles.focusTrapZone,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0},n):n},e.childContextTypes=x.a({},mt.a),e}(L.a),Tt=n(660);function Ot(){var t=i.a()?Tt.j():Tt.k();return function(e){var n={cardViewStates:Tt.b(e),dataItems:t(e),taskState:e.taskState,personaIconPropertiesMap:Tt.h(e),createdCommentLie:Tt.d(e),nextPopulatedContextDetails:e.contextState.nextPopulatedContextDetails,pendingCommentLoad:e.pendingCommentLoad,postViewStates:Tt.i(e),componentTree:e.paneState.componentTree,commentThreadCountsContextDetails:e.contextState.commentThreadCounts,virtualized:e.virtualized,focusedThreadIdBeforeCommentSession:e.focusedThreadIdBeforeCommentSession,readOnly:Tt.g(e),highlightedCommentId:Tt.f(e),lastContextChangeIncrement:e.contextState.lastContextChangeIncrement,initializationStatus:e.paneState.initializationStatus,focusTypeAfterContextChange:e.paneState.focusTypeAfterContextChange,atMentionState:Tt.a(e),draftState:Tt.e(e),capabilities:e.capabilities};if(e.focusedComment&&(n.focusedCommentInfo={focusedComment:e.focusedComment,index:Object(C.r)(e.commentData,e.focusedComment)}),e.topVisibleThreadId){var o=e.commentData.filter(r.a).findIndex(function(t){return t.commentId===e.topVisibleThreadId});o>-1&&(n.topVisibleThread={cardId:e.topVisibleThreadId,index:o})}return n}}function St(t,e){return{cancelCommentPostEdit_deprecated:function(e,n,o,r){t(c.f(e,n,o,r))},cancelCommentReply_deprecated:function(e,n,o,r){t(c.g(e,n,o,r))},clearCurrentComments:function(e){t(c.k(e))},highlightComment:function(e,n){t(c.o(e,n,l.a.SharedComments))},requestDeleteComment:function(e,n){t(c.x(e,n))},requestDeleteThread:function(e,n,o){t(c.y(e,n,o))},selectCommentCardExpand:function(e,n,o){t(c.F(e,n,void 0,c.c.ExpandCard,o))},selectCommentCardCollapse:function(e,n,o){t(c.F(e,n,void 0,c.c.CollapseCard,o))},selectCommentPost:function(e,n,o,r){t(c.F(e,n,o,c.c.SelectPost,r))},requestReopenThread:function(e,n,o){t(c.B(e,n,o))},requestCreateCommentSession:function(n){t(Object(v.a)(n,e.commentAPI,{sessionType:"CREATE"},!1,e.peopleAPI))},requestEditCommentSession:function(n,o){t(Object(v.a)(n,e.commentAPI,{sessionType:"EDIT",commentId:o},!1,e.peopleAPI))},requestReplyCommentSession:function(n,o){t(Object(v.a)(n,e.commentAPI,{sessionType:"REPLY",threadId:o},!1,e.peopleAPI))},requestResolveThread:function(e,n,o){t(c.D(e,n,o))},commitComment_Deprecated:function(n,o,r,i){return t(Object(p.a)(n,e.peopleAPI,i,o,r))},commitCommentAndFocus:function(n,o,r,i,a,s){return t(Object(p.a)(n,e.peopleAPI,i,o,r,s)).then(function(t){return t.shareFailed&&e.focusManager.focusActiveEditor(r,a),t})},requestLoadThreads:function(e,n){t(c.z(e,n))},selectFirstThreadInNextCommentContext:function(e){t(c.G(e))},selectLastThreadInPreviousCommentContext:function(e){t(c.H(e))},nextPopulatedContextDetailsUpdated:function(e,n){t(c.p(e,n))},showLowFidelityWarning:function(e,n,o){t(Object(d.a)(e,n,o))},clearCommentHighlight:function(e){t(c.i(e,l.a.SharedComments))},discardDraftAsync:function(e,n,o,r){return t(Object(u.a)(e,n,o,r))},requestClosePane:function(e){t(c.t(e))},requestDisplayConfiguration:function(e,n){return t(Object(b.a)(e,n))},readyToRender:function(e){t(c.q(e))},requestModalConfirmation:function(e,n,o,r){t(c.A(e,n,o,r))},initializeView:function(n){t(function(t,e,n,o,r){return function(i){return i(Object(y.a)({renderContextType:t,trackback:s.f.reserveTag(595899542),telemetryVisitor:r})),e===h.a.NewThread?(t===m.a.HalfPane&&i(Object(b.a)({renderContextType:t,trackback:s.f.reserveTag(595899543),telemetryVisitor:r},{displayMode:f.a.Variable,desiredHeight:0})),i(Object(v.a)({renderContextType:t,trackback:s.f.reserveTag(595898586),telemetryVisitor:r},n,{sessionType:"CREATE"},!1,o)).then(function(){i(Object(g.a)({renderContextType:t,trackback:s.f.reserveTag(595899545),telemetryVisitor:r}))})):i(Object(g.a)({renderContextType:t,trackback:s.f.reserveTag(595899546),telemetryVisitor:r}))}}(n,e.initializationReason,e.commentAPI,e.peopleAPI,e.telemetryVisitor))},updateFocusTypeAfterContextChange:function(e,n){t(c.M(e,n))},saveDraft:function(e,n,o){t(c.E(e,{draftId:n,draftContent:o}))},updateRenderLocksForAllDrafts:function(e,n){t(c.L(e,n))},checkUserAccess:function(t){return e.peopleAPI.checkUserAccess(t)},getUserContacts:function(t,n,o){return e.peopleAPI.capabilities&a.a.GetContactsForMentions?e.peopleAPI.getContactsForMentions(t,n,o):(Object(s.g)().assertConditionTag(!1,"Attempted to retrieve contacts on API without capability.",595870034),Promise.resolve([]))},updateCurrentMentionees:function(e,n){t(c.K(e,n))},updateSelectedTaskAssignee:function(e,n){t(c.N(e,n))}}}n.d(e,"makeMapStateToProps",function(){return Ot}),n.d(e,"mapDispatchToProps",function(){return St}),n.d(e,"connectCommentPane",function(){return Et}),n.d(e,"CommentPaneContainer",function(){return Pt});var Et=Object(o.connect)(Ot,St,void 0,{withRef:!0}),Pt=Et(xt)},555:function(t,e,n){"use strict";n.r(e);var o,r=n(1),i=n(0),a=n(91),s=function(){function t(t){}return t.prototype.registerForMockUIActions=function(t){},t.prototype.unregisterForMockUIActions=function(t){},t}(),c=n(526),l=n(186);!function(t){t.CreateThread="CreateThread",t.CancelCreateThread="CancelCreateThread",t.StartReplySession="StartReplySession",t.CancelReplySession="CancelReplySession",t.PostReply="PostReply",t.DeleteComment="DeleteComment",t.DeleteThread="DeleteThread",t.ResolveThread="ResolveThread",t.ReopenThread="ReopenThread",t.StartEditSession="StartEditSession",t.CancelEditSession="CancelEditSession",t.PostEdit="PostEdit",t.SelectComment="SelectComment",t.ClosePane="ClosePane",t.ClickGhostCard="ClickGhostCard"}(o||(o={}));var d,p=n(3),u=n(123),f=n(306),h=n(687),m=n(646),y=n(32),g=n(16),b=n(74),v=function(){function t(t,e){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),this.draftHasContent=this.draftHasContent.bind(this),t&&(this.mockId=t),e&&(this.mockContents=e)}return t.prototype.getId=function(){return this.mockId},t.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},t.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},t.prototype.draftHasContent=function(){return this.mockContents.length>0},t}(),C=function(){function t(t){this.mockContents="",this.mockId="",t&&(this.mockId=t)}return t.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},t.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},t.prototype.setContents=function(t){this.mockContents=t},t.prototype.getId=function(){return this.mockId},t}();!function(t){t[t.None=0]="None",t[t.NeedDrafting=1]="NeedDrafting",t[t.NeedNotDrafting=2]="NeedNotDrafting"}(d||(d={}));var x=function(t){function e(e){return t.call(this,e)||this}return r.d(e,t),e.prototype.render=function(){return i.createElement("div",null)},e}(function(t){function e(e){var n=t.call(this,e)||this;return n.pendingActionReason=d.None,n.pendingAction=void 0,n.onMockUIAction=n.onMockUIAction.bind(n),n.state=n.getInitialState(e),n}return r.d(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props.mockUIDriver.registerForMockUIActions(this.onMockUIAction)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this.props.mockUIDriver.unregisterForMockUIActions(this.onMockUIAction)},e.prototype.componentDidUpdate=function(e,n){t.prototype.componentDidUpdate.call(this,e,n),!(this.props.focusedCommentInfo&&Object(g.i)(this.props.focusedCommentInfo.focusedComment.focusDetails))&&this.pendingActionReason===d.NeedNotDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=d.None);var o=this.props.focusedCommentInfo&&this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===g.a.Active,r=e.focusedCommentInfo&&e.focusedCommentInfo.focusedComment.focusDetails.editingSession===g.a.Active;o&&!r&&this.pendingActionReason===d.NeedDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=d.None)},e.prototype.onDrafting=function(t){this.props.focusedCommentInfo&&this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===g.a.Active?t():(this.pendingAction=t,this.pendingActionReason=d.NeedDrafting)},e.prototype.onNotDrafting=function(t){this.props.focusedCommentInfo&&Object(g.i)(this.props.focusedCommentInfo.focusedComment.focusDetails)?(this.pendingAction=t,this.pendingActionReason=d.NeedNotDrafting):t()},e.prototype.onMockUIAction=function(t){var e=this;if(this.pendingAction)Object(p.g)().assertConditionTag(!1,"Action is already pending",0);else switch(t.actionType){case o.CancelCreateThread:!function(t){return t.actionType===o.CancelCreateThread}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onDrafting(function(){return e.onCardDraftCancel(new v(b.a))});break;case o.CancelEditSession:!function(t){return t.actionType===o.CancelEditSession&&void 0!==t.commentId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onDrafting(function(){return e.onPostCancel(new C(t.commentId))});break;case o.CancelReplySession:!function(t){return t.actionType===o.CancelReplySession&&void 0!==t.threadId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onDrafting(function(){return e.onCardReplyCancel(new v(t.threadId))});break;case o.ClickGhostCard:!function(t){return t.actionType===o.ClickGhostCard}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.onGhostCommentClicked()});break;case o.ClosePane:!function(t){return t.actionType===o.ClosePane}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.closePane()});break;case o.CreateThread:!function(t){return t.actionType===o.CreateThread&&void 0!==t.content}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onDrafting(function(){return e.cardOnCreate(new v(b.a,t.content))});break;case o.DeleteComment:!function(t){return t.actionType===o.DeleteComment&&void 0!==t.commentId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.onPostDelete(new C(t.commentId))});break;case o.DeleteThread:!function(t){return t.actionType===o.DeleteThread&&void 0!==t.threadId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.cardOnDelete(t.threadId)});break;case o.PostEdit:if(function(t){return t.actionType===o.PostEdit&&void 0!==t.commentId&&void 0!==t.content}(t)){var n=new C(t.commentId);n.setContents(t.content),this.onDrafting(function(){return e.onPostCommit(n)})}else Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0);break;case o.PostReply:!function(t){return t.actionType===o.PostReply&&void 0!==t.threadId&&void 0!==t.content}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onDrafting(function(){return e.cardOnPostReply(new v(t.threadId,t.content))});break;case o.ReopenThread:!function(t){return t.actionType===o.ReopenThread&&void 0!==t.threadId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.cardOnReopenThread(t.threadId)});break;case o.ResolveThread:!function(t){return t.actionType===o.ResolveThread&&void 0!==t.threadId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.cardOnResolveThread(t.threadId)});break;case o.SelectComment:!function(t){return t.actionType===o.SelectComment&&void 0!==t.commentId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.onRenderableItemSelect(new C(t.commentId))});break;case o.StartEditSession:!function(t){return t.actionType===o.StartEditSession&&void 0!==t.commentId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.onPostEdit(new C(t.commentId))});break;case o.StartReplySession:!function(t){return t.actionType===o.StartReplySession&&void 0!==t.threadId}(t)?Object(p.g)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",0):this.onNotDrafting(function(){return e.cardOnBeginReplyCallback(new v(t.threadId))});break;default:Object(p.g)().assertConditionTag(!1,"Unknown MockUIActionType",0)}},e.prototype.getMentionableCommentEditorProps=function(t,e){},e.prototype.cardOnFocusNextTabStop_deprecated=function(){return!1},e.prototype.cardOnFocusPreviousTabStop_deprecated=function(){return!1},e.prototype.getCommentCardStyleOptions=function(t){return{highlightCard:!1}},e.prototype.getCommentPostStyleOptions=function(t,e){return{}},e.prototype.onContextChanged=function(){this.props.initializationStatus===u.a.NotInitialized&&this.props.initializeView(this.props.componentTree.renderContextType)},e.prototype.getAuthToken=function(){},e.prototype.invokeModalDialog=function(t,e,n){var o={renderContextType:this.props.componentTree.renderContextType,trackback:p.e,telemetryVisitor:this.props.telemetryVisitor};switch(t){case f.a.CancelNewDraft:case f.a.CancelReplyDraft:return this.props.discardDraftAsync(o,y.a.SharedComments,!1);case f.a.DeleteThread:return this.props.focusedCommentInfo&&this.props.requestDeleteThread(o,this.props.focusedCommentInfo.focusedComment.selectedCardId),Promise.resolve(l.a.Handled);case f.a.ClosePaneDraft:return this.closePane(),Promise.resolve(l.a.Handled);default:return Object(p.g)().assertConditionTag(!1,"Unknown ModalDialogMode",0),Promise.resolve(l.a.Unhandled)}},e.prototype.getCreateCommentInitialHeight=function(){return 0},e.prototype.onGetUserContacts=function(t,e,n){return Promise.resolve([])},e.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:m.a.AllCardsTabbable,postTabbingMode:m.b.AllPostsTabbable}},e.prototype.getComponentTree=function(){return this.props.componentTree},e.prototype.showDiscardDialog=function(){return Promise.resolve(!1)},e.prototype.onAtMentionCapabilityStateChange=function(){},e.prototype.showDiscardDialogOnPostCancel=function(){return!1},e}(h.a)),T=Object(c.connectCommentPane)(x),O=n(236),S=n(132),E=n(176),P=n(389),w=n(342),I=function(t){function e(e){var n=t.call(this,e)||this;n._useMock=!1,n._hostRef=i.createRef();var o=n.props.getCommentAPI();return n._useMock=n.props.useMockCommentPane,n._useMock&&(n._mockUIDriver=new s(e.apiContext)),n._commentManager=new O.a(n.props.apiContext,n.props.viewContainerAPI,o,n.props.peopleAPI,n.props.localizationAPI,n.props.initializationReason,Object(w.a)(o,n.props.viewContainerAPI,Object(b.c)(n.props.viewContainerAPI.getViewContainer(),!0),E.a.getTelemetryVisitor(n.props.apiContext)),new P.a,!0),n}return r.d(e,t),e.prototype.teardownManager=function(){this._commentManager.teardown()},e.prototype.componentWillUnmount=function(){this.teardownManager()},e.prototype.getWrappedPaneInstance=function(){return this._hostRef.current&&this._hostRef.current.getWrappedInstance()},e.prototype.render=function(){var t={ref:this._hostRef,commentAPI:this.props.getCommentAPI(),peopleAPI:this.props.peopleAPI,localizationAPI:this.props.localizationAPI,focusManager:this._commentManager.getFocusManager(),selectionManager:this._commentManager.getSelectionManager(),initializationReason:this.props.initializationReason,registerComponentUIActionListener:this._commentManager.registerComponentUIActionListener,unregisterComponentUIActionListener:this._commentManager.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:this._commentManager.registerComponentInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this._commentManager.unregisterComponentInterruptableCommandListener,refreshAtMentionAuthToken:this._commentManager.refreshAtMentionAuthToken,resource:{id:S.a},telemetryVisitor:E.a.getTelemetryVisitor(this.props.apiContext)};return this._useMock?i.createElement(a.Provider,{store:this._commentManager.getCommentStore()},i.createElement(T,r.a({},t,{mockUIDriver:this._mockUIDriver}))):i.createElement(a.Provider,{store:this._commentManager.getCommentStore()},i.createElement(c.CommentPaneContainer,r.a({},t)))},e}(i.Component);e.default=I},558:function(t,e,n){"use strict";n.r(e);var o=n(91),r=n(1),i=n(752),a=n(0),s=n(79),c=n(688),l=function(t){function e(e){return t.call(this,e)||this}return r.d(e,t),e.prototype.render=function(){return this.props.isResourceAvailable?!this.props.isExtensionEnabled&&s.b?a.createElement(i.Text,{textStyle:"MediumBold"},"Debug Error: This comment card's extension is disabled."):a.createElement(c.a,{key:this.props.resource.id,commentAPI:this.props.commentAPI,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:this.props.resource,telemetryVisitor:this.props.telemetryVisitor,componentRef:this.props.componentRef,componentTree:this.props.componentTree,maximumDimensions:this.props.maximumDimensions}):null},e}(a.PureComponent),d=n(683);n.d(e,"makeMapStateToProps",function(){return p}),n.d(e,"HostableCommentCardRendererContainer",function(){return u});var p=function(){var t=d.c(),e=d.j(t),n=d.d(e),o=d.m(n),r=d.l();return function(t,e){return{isResourceAvailable:o(t,e),isExtensionEnabled:r(t,e)}}},u=Object(o.connect)(p)(l)},640:function(t,e,n){"use strict";var o=n(1),r=n(69),i={renderContextType:r.number.isRequired},a={isFocusWithinPane:r.func.isRequired,isFocusWithinAny:r.func.isRequired,isFocusOn:r.func.isRequired,isFocusWithin:r.func.isRequired,getCurrentlyFocused:r.func.isRequired};n.d(e,"a",function(){return s});var s=o.a({},a,i,{getComponent:r.func.isRequired,getComponentById:r.func.isRequired,getComponentByTag_deprecated:r.func.isRequired,isEventTarget:r.func.isRequired})},642:function(t,e,n){"use strict";var o;!function(t){t[t.Collapsed=0]="Collapsed",t[t.Expanded=1]="Expanded"}(o||(o={})),e.a=o},643:function(t,e,n){"use strict";n.d(e,"a",function(){return h}),n.d(e,"e",function(){return m}),n.d(e,"f",function(){return y}),n.d(e,"b",function(){return g}),n.d(e,"d",function(){return b}),n.d(e,"c",function(){return v}),n.d(e,"h",function(){return M}),n.d(e,"i",function(){return _}),n.d(e,"g",function(){return B});var o=n(136),r=n(267),i=n(26),a=n(13),s=n(19),c=n(681),l=n(682),d=n(50),p=n(82),u=n(647),f=n(515),h=268,m=10,y=h-2*m,g=300,b=10,v=266,C=function(t){return t-28},x=function(t){return t-7},T=Object(o.a)({border:"1px solid",borderColor:p.a.COMMENTS_GRAY,display:"flex",direction:"inherit",flexDirection:"row",boxSizing:"border-box",alignItems:"stretch",flexWrap:"nowrap",overflow:"hidden",padding:0,marginTop:0,marginBottom:"9px",marginRight:"9px",marginLeft:"9px",backgroundColor:"#F8F8F8",cursor:"default",position:"relative",selectors:{":focus":{outline:"none"}}}),O=Object(o.a)(T,{width:h,maxWidth:h}),S=Object(o.a)(T,{width:x(h),borderRadius:f.e,boxShadow:f.a.LEVEL2,overflow:"visible",marginLeft:"16px",backgroundColor:"#FFFFFF",flexDirection:"column"}),E=Object(o.a)(S,{width:C(h)}),P=Object(o.a)({display:"flex",flexWrap:"wrap",justifyContent:"flex-end",alignItems:"flex-end",direction:"inherit",marginLeft:"9px",marginRight:"9px",marginBottom:"8px",marginTop:"8px",minHeight:"30px",border:"1px solid",borderColor:p.a.COMMENTS_GRAY,borderRadius:f.d,boxSizing:"border-box",width:y,overflow:"hidden",backgroundColor:"#ffffff",flexDirection:"row",position:"relative",cursor:"text",selectors:{":focus":Object(o.a)({outline:"none",border:"1px dotted"},f.j)}}),w=Object(o.a)(P,{width:x(y),borderColor:"#B3B0AD",margin:"0px",marginBottom:"10px",marginTop:"9px",minHeight:"22px",backgroundColor:"transparent"}),I=Object(o.a)(w,{width:C(y)}),k=Object(r.a)({root:Object(o.a)({height:"28px",margin:0,padding:0,border:"1px solid transparent",backgroundColor:"#F8F8F8",boxSizing:"border-box",color:p.a.GRAY_E,cursor:"pointer",flexShrink:0,outline:"none",selectors:{".ms-Fabric--isFocusVisible &:focus::after":f.l}}),rootFocused:Object(o.a)({color:p.a.GRAY_H,outline:"none",border:"1px dotted",backgroundColor:"#F8F8F8"},f.j),flexContainer:Object(o.a)({justifyContent:"flex-start"}),textContainer:Object(o.a)({flexGrow:0,flexShrink:0,margin:0,padding:0,marginLeft:"42px"}),label:Object(o.a)({margin:0,padding:0,fontWeight:"normal",fontSize:"12px",lineHeight:"16px",fontFamily:"inherit"}),rootHovered:Object(o.a)({color:p.a.GRAY_H,backgroundColor:"#F8F8F8"},f.k),rootPressed:Object(o.a)({color:p.a.GRAY_H,backgroundColor:"#F8F8F8",outline:"none",border:"1px solid transparent"})}),R=Object(i.b)(function(t){return Object(r.a)(k,{root:Object(o.a)({overflow:"visible",position:"relative",backgroundColor:"transparent",color:t}),rootFocused:Object(o.a)({backgroundColor:"transparent"},f.j),textContainer:Object(o.a)({marginLeft:"16px"}),label:Object(o.a)({fontWeight:"bold",fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif'}),rootHovered:Object(o.a)({backgroundColor:"transparent"},f.k),rootPressed:Object(o.a)({backgroundColor:"transparent"})})}),A=Object(r.a)({rootFocused:Object(o.a)({color:p.a.GRAY_H,outline:"none",border:"1px solid transparent",backgroundColor:"#F8F8F8"},f.j)}),D=Object(r.a)(A,{rootFocused:Object(o.a)({backgroundColor:"transparent"},f.j)}),j=Object(o.a)({selectors:{":focus":{outline:"none",border:"1px solid",borderColor:p.a.COMMENTS_GRAY}}}),N=Object(o.a)({selectors:{"> div:last-child":{width:1,height:1}}}),M=Object(i.b)(function(t,e,n){var i,c,l,m="#"+d.i(e),y=e.renderContextType===s.a.DiscreteIntegrated||e.renderContextType===s.a.DiscreteIsolated,g=y?{margin:"0px"}:{margin:"9px",marginTop:0},b={pointerEvents:a.w()?"auto":void 0};return{cardInnerContainer:Object(o.a)({flexDirection:"row",display:"flex",width:h}),cardContainer:Object(o.a)(O,g,b,{boxShadow:y?"unset":"0px 1px 2px rgba(0,0,0,0.10)"}),cardContainerHover:Object(o.a)(O,g,b,{boxShadow:y?"unset":"0px 8px 16px rgba(0,0,0,0.10)",outline:"2px solid transparent",selectors:(i={},i[m]={borderLeft:"2px solid",borderColor:p.a.COMMENTS_PURPLE,display:"inline"},i)}),cardContainerSelect:Object(o.a)(O,g,b,{boxShadow:y?"unset":"0px 16px 24px rgba(0,0,0,0.10)",outline:"2px dotted transparent",selectors:(c={},c[m]={borderLeft:"2px solid",borderColor:p.a.COMMENTS_PURPLE,display:"inline"},c[":focus"]={boxShadow:y?"unset":"0px 4px 8px 2px rgba(0,0,0,0.15)",selectors:(l={},l[m]={borderLeft:"4px solid",borderColor:p.a.COMMENTS_PURPLE,display:"inline"},l)},c)}),cardBody:Object(o.a)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,maxHeight:n,maxWidth:v,outline:"none"}),cardPlaceholder:Object(o.a)({display:"flex",direction:"inherit",flexDirection:"column",marginLeft:"0.5px",marginRight:"0.5px",justifyContent:"center",height:"160px"}),overflowTextContainerDefault:k,overflowTextContainerRestrictFocus:Object(r.a)(k,A),iconSend:{root:Object(o.a)({background:"#ffffff",color:p.a.GRAY_C,maxHeight:"28px",margin:1,padding:0,borderStyle:"none",border:"1px solid transparent",position:"relative",selectors:{".ms-Fabric--isFocusVisible &:focus::after":f.l,".ms-Button-flexContainer":{position:"relative"}}},t&&{transform:"scaleX(-1)"}),rootPressed:{color:p.a.GRAY_J},rootHovered:Object(o.a)({color:p.a.GRAY_J},f.k),rootFocused:Object(o.a)({color:p.a.GRAY_H,outline:"none",border:"1px dotted"},f.j),iconDisabled:{color:p.a.GRAY_C},icon:{color:p.a.GRAY_F,width:"16px",margin:1},iconPressed:{color:p.a.GRAY_J},iconHovered:{color:p.a.GRAY_J}},iconCancelReply:{root:{color:p.a.GRAY_E,background:"#ffffff",maxHeight:"28px",margin:1,padding:0,border:"1px solid transparent",selectors:{".ms-Fabric--isFocusVisible &:focus::after":f.l,".ms-Button-flexContainer":{position:"relative"}}},rootFocused:Object(o.a)({color:p.a.GRAY_H,outline:"none",border:"1px dotted"},f.j),rootPressed:{color:p.a.GRAY_J},rootHovered:Object(o.a)({color:p.a.GRAY_J},f.k),iconDisabled:{color:p.a.GRAY_C},icon:{color:p.a.GRAY_F,width:12,height:12,margin:2,marginTop:0,padding:0,border:0,lineHeight:12},iconPressed:{color:p.a.GRAY_J},iconHovered:{color:p.a.GRAY_J}},cancelDraft_deprecated:Object(o.a)({marginLeft:"-32px",marginTop:"12px"}),cardOverlay:Object(o.a)({position:"absolute",zIndex:10,left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.5)"}),cardSpinner:Object(o.a)({position:"absolute",zIndex:20,left:"50%",top:"50%",marginLeft:"-18px",marginTop:"-15px",selectors:{"& .ms-Spinner-circle":{borderColor:u.a,borderTopColor:u.b}}}),cardSideBar:Object(o.a)({position:"absolute",left:0,top:0,right:0,bottom:0,width:1,backgroundColor:"transparent",display:"none",outline:"none",flexShrink:0}),replySpinnerContainer:Object(o.a)({marginTop:"8px",zIndex:20,width:"32px",maxHeight:"30px",selectors:{"& .ms-Spinner-circle":{borderColor:u.a,borderTopColor:u.b}}}),iconCancelDraft_deprecated:{rootHovered:Object(o.a)({color:p.a.GRAY_J},f.k),rootPressed:{color:p.a.GRAY_J},rootExpanded:{color:p.a.GRAY_J},rootFocused:Object(o.a)({color:p.a.GRAY_H,outline:"none",border:"1px dotted"},f.j),root:{height:"16px",marginTop:"-6px",width:"16px",padding:0,color:p.a.GRAY_E,border:"1px solid transparent",selectors:{".ms-Fabric--isFocusVisible &:focus::after":f.l,".ms-Button-flexContainer":{position:"relative"}}},icon:{width:12,height:12,margin:2,padding:0,border:0,lineHeight:12}},iconContextMenuAnchor:{menuIconDisabled:{color:p.a.GRAY_C},menuIcon:{color:p.a.GRAY_F,margin:0,width:"16px"},menuIconPressed:{color:p.a.GRAY_J},menuIconHovered:{color:p.a.GRAY_J},rootPressed:{color:p.a.GRAY_J},rootHovered:Object(o.a)({color:p.a.GRAY_J},f.k),rootFocused:Object(o.a)({color:p.a.GRAY_H,outline:"none",border:"1px dotted"},f.j),root:{height:"10px",width:"20px",border:"1px solid transparent",padding:0,margin:0,color:p.a.GRAY_E,selectors:{".ms-Fabric--isFocusVisible &:focus::after":f.l,".ms-Button-flexContainer":{position:"relative"}}}},menuItem:Object(o.a)({margin:0,padding:0,alignSelf:"stretch",textAlign:"right",overflow:"hidden"}),contextMenu:Object(o.a)({minWidth:50,maxWidth:213,paddingTop:"6px",paddingBottom:"6px",margin:0,overflow:"hidden",textAlign:"right",selectors:{".ms-FocusZone.ms-ContextualMenu.is-open":Object(o.a)({display:"flex",alignContent:"flex-end",alignItems:"flex-end",justifyContent:"flex-end",minWidth:50})}}),headerContainer_deprecated:Object(o.a)({marginLeft:"-60px",width:"60px",height:"30px",display:"flex",justifyContent:"flex-end",padding:"8px",boxSizing:"border-box"}),headerItem_deprecated:Object(o.a)({marginLeft:"5px"}),renderableItemList:Object(o.a)({display:"flex",flexWrap:"nowrap",flexDirection:"column",flexGrow:1,maxWidth:v,outline:"none",overflowY:n?"auto":void 0}),replyBoxDefault:P,replyBoxRestrictFocus:Object(o.a)(P,j),replyBoxContainer:Object(o.a)({display:"flex",overflow:"hidden",maxWidth:266,margin:0,flexDirection:"row",flexShrink:0,flexWrap:"nowrap",justifyContent:"center",backgroundColor:"#F8F8F8",alignSelf:"center",outline:"none"}),replyBoxButtons:Object(o.a)({width:"64px",maxHeight:"30px",display:"flex",flexDirection:"row",flexWrap:"nowrap",overflow:"hidden"}),draftBoxButtons:Object(o.a)({width:"32px",height:"32px",display:"flex",flexDirection:"row",flexWrap:"nowrap",overflow:"hidden"}),dividerLine:Object(o.a)({height:"1px",backgroundColor:p.a.COMMENTS_GRAY,flexShrink:0}),separatorLine:Object(o.a)({height:"32px",minWidth:"1px",maxWidth:"1px",backgroundColor:p.a.COMMENTS_GRAY}),anchor_deprecated:Object(o.a)({color:"#333333",fontWeight:"normal",fontFamily:"inherit",fontSize:"11px",lineHeight:"15px",minWidth:"12px",position:"relative",zIndex:20}),commentCardFocusTrapZone:N}}),_=Object(i.b)(function(t,e,n,i,y){var g,b,v,T="#"+d.i(t),O=t.renderContextType===s.a.DiscreteIntegrated||t.renderContextType===s.a.DiscreteIsolated,P=O?{margin:"0px"}:{margin:"9px",marginTop:0,marginLeft:"13px"},k={pointerEvents:a.w()?"auto":void 0},A=O?E:S,M=y?y-c.a-(n?l.a+l.b:0)-2:void 0;return{cardInnerContainer:Object(o.a)({flexDirection:"row",display:"flex",width:O?C(h):x(h)}),cardContainer:Object(o.a)(A,P,k,{boxShadow:f.a.LEVEL1}),cardContainerHover:Object(o.a)(A,P,k,{boxShadow:f.a.LEVEL4,outline:"2px solid transparent",selectors:(g={},g[T]={borderLeft:"2px solid",borderColor:p.a.FLUENT_GRAY,display:"inline"},g)}),cardContainerSelect:Object(o.a)(A,P,k,{boxShadow:f.a.LEVEL5,outline:"2px dotted transparent",selectors:(b={},b[T]={borderLeft:"2px solid",borderColor:p.a.FLUENT_GRAY,display:"inline"},b[":focus"]={boxShadow:f.a.LEVEL3,selectors:(v={},v[T]={borderLeft:"4px solid",borderColor:p.a.FLUENT_GRAY,display:"inline"},v)},b)}),cardBody:Object(o.a)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,maxHeight:M,width:"100%",outline:"none",position:i?"relative":void 0}),cardPlaceholder:Object(o.a)({display:"flex",direction:"inherit",flexDirection:"column",marginLeft:"0.5px",marginRight:"0.5px",justifyContent:"center",height:"160px"}),overflowTextContainerDefault:R(e),overflowTextContainerRestrictFocus:Object(r.a)(R(e),D,{color:e}),cancelDraft_deprecated:Object(o.a)({marginLeft:"-24px",marginTop:"12px"}),cardOverlay:Object(o.a)({position:"absolute",zIndex:10,left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.5)"}),cardSpinner:Object(o.a)({position:"absolute",zIndex:20,left:"50%",top:"50%",marginLeft:"-18px",marginTop:"-15px",selectors:{"& .ms-Spinner-circle":{borderColor:u.a,borderTopColor:u.b}}}),cardSideBar:Object(o.a)({position:"absolute",zIndex:0,left:0,top:!i&&n?l.a:0,right:0,bottom:0,width:1,backgroundColor:"transparent",display:"none",outline:"none",flexShrink:0}),iconCancelDraft_deprecated:{rootHovered:Object(o.a)({color:p.a.GRAY_J},f.k),rootPressed:{color:p.a.GRAY_J},rootExpanded:{color:p.a.GRAY_J},rootFocused:Object(o.a)({color:p.a.GRAY_H,outline:"none",border:"1px dotted"},f.j),root:{height:"16px",marginTop:"-6px",width:"16px",padding:0,color:p.a.GRAY_E,border:"1px solid transparent",selectors:{".ms-Fabric--isFocusVisible &:focus::after":f.l,".ms-Button-flexContainer":{position:"relative"}}},icon:{width:12,height:12,margin:2,padding:0,border:0,lineHeight:12}},menuItem:Object(o.a)({overflow:"hidden",margin:0,padding:0}),headerContainer_deprecated:Object(o.a)({marginLeft:"-60px",width:"60px",height:"30px",display:"flex",justifyContent:"flex-end",padding:"8px",boxSizing:"border-box"}),headerItem_deprecated:Object(o.a)({marginLeft:"5px"}),renderableItemList:Object(o.a)({display:"flex",flexWrap:"nowrap",flexDirection:"column",flexGrow:1,outline:"none",overflowY:y?"auto":void 0}),replyBoxDefault:O?I:w,replyBoxRestrictFocus:Object(o.a)(O?I:w,j),replyBoxContainer:Object(o.a)({display:"flex",overflow:"hidden",margin:0,marginRight:m,marginLeft:m,flexDirection:"column",flexShrink:0,flexWrap:"nowrap",justifyContent:"center",alignSelf:"center",outline:"none"}),draftBoxButtons:Object(o.a)({width:"49px",maxHeight:"30px",marginBottom:"3px",display:"flex",flexDirection:"row-reverse",flexWrap:"nowrap",overflow:"hidden",float:"right"}),dividerLine:{backgroundColor:"transparent",height:0},anchor_deprecated:Object(o.a)({color:"#333333",fontWeight:"normal",fontFamily:"inherit",fontSize:"11px",lineHeight:"15px",minWidth:"12px",position:"relative",zIndex:20}),commentCardFocusTrapZone:N}});function B(){return{root:{borderColor:p.a.COMMENTS_GRAY,boxShadow:f.a.LEVEL2}}}},645:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var o=n(1),r=n(69),i=n(0),a={getContentManager:r.func.isRequired},s=function(t){function e(e){var n=t.call(this,e)||this;return n._persistedContent={},n}return o.d(e,t),e.prototype.getChildContext=function(){var t=this;return{getContentManager:function(){return t}}},e.prototype.render=function(){return i.Children.only(this.props.children)},e.prototype.persistContent=function(t,e){this._persistedContent[t]=e},e.prototype.hasPersistedContent=function(t){return void 0!==this._persistedContent[t]},e.prototype.getPersistedContent=function(t){return this._persistedContent[t]},e.prototype.clearPersistedContent=function(t){delete this._persistedContent[t]},e.childContextTypes=a,e}(i.Component);e.b=s},646:function(t,e,n){"use strict";var o,r;n.d(e,"a",function(){return o}),n.d(e,"b",function(){return r}),function(t){t[t.AllCardsTabbable=0]="AllCardsTabbable",t[t.ExpandedCardTabbable=1]="ExpandedCardTabbable",t[t.ExpandedCardOrFirstCardTabbable=2]="ExpandedCardOrFirstCardTabbable",t[t.SelectedCardTabbable=3]="SelectedCardTabbable"}(o||(o={})),function(t){t[t.AllPostsTabbable=0]="AllPostsTabbable",t[t.ExpandedCardPostsTabbable=1]="ExpandedCardPostsTabbable",t[t.ExpandedCardRootPostTabbable=2]="ExpandedCardRootPostTabbable",t[t.SelectedPostTabbable=3]="SelectedPostTabbable"}(r||(r={}))},647:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return r});var o="#0078d7 !important",r="#c7e0f4 !important"},648:function(t,e,n){"use strict";var o,r=n(1),i=n(0),a=n(139),s=n(83),c=n(13),l=n(187),d=n(3),p=n(17),u=n(66),f=n(16),h=n(62),m=n(93),y=n(642),g=n(87),b=n(310),v=n(102),C=n(110),x=n(411),T=n(311),O=n(528),S=n(40),E=n(601),P=n(543),w=n(119),I=n(26),k=n(201);!function(t){t[t.Editing=0]="Editing",t[t.Disabled=1]="Disabled",t[t.ReadOnly=2]="ReadOnly"}(o||(o={}));var R,A=o,D=n(169);function j(t){return void 0!==t[0].text}!function(t){t[t.Post=0]="Post",t[t.Card=1]="Card"}(R||(R={}));var N,M=n(18),_=n(37),B=n(136),L=n(643),F=n(82),H=n(647),U=n(515),z={fontFamily:"inherit",justifyContent:"center"},V=Object(I.b)(function(){return{persona:Object(B.a)(z),personaResolved:Object(B.a)(z,{opacity:.5}),personaContainer:Object(B.a)({margin:8,marginLeft:6})}}),q=Object(I.b)(function(){return{persona:Object(B.a)(z),personaResolved:Object(B.a)(z),personaRootContainer:Object(B.a)({margin:8,marginLeft:6,position:"absolute",left:"-15px"}),personaContainer:Object(B.a)({margin:6,marginLeft:9})}});!function(t){t[t.collapseContent=4]="collapseContent"}(N||(N={}));var K,G,W=L.c-16-26-8-2,Y=Object(B.a)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,marginTop:"8px"}),Q=Object(B.a)(Y,{position:"relative",overflow:"hidden",marginRight:8}),J=Object(B.a)(Q,{marginLeft:"14px",marginRight:"14px"}),X=(Object(B.a)({fontFamily:"inherit",justifyContent:"center"}),Object(B.a)({display:"flex",direction:"inherit",overflow:"hidden",flexGrow:1,flexDirection:"row",flexWrap:"nowrap",flexShrink:0,margin:0,border:0,position:"relative",selectors:{":focus":{outline:"none"}}})),Z=Object(B.a)({backgroundColor:"#FFFFFF"}),$=Object(B.a)({backgroundColor:"#F8F8F8"}),tt=Object(B.a)({display:"flex",margin:"0px",marginBottom:"5px",backgroundColor:"#FFFFFF",border:"1px solid #B3B0AD",borderRadius:U.d,userSelect:"text",padding:0}),et=Object(I.b)(function(){return{actionbarRoot:Object(B.a)({marginRight:5,marginBottom:4,marginTop:4,alignSelf:"flex-end",height:12}),actionbarNormal:Object(B.a)({marginRight:5,marginBottom:4,marginTop:4,alignSelf:"flex-end",height:12}),actionbarEdit:Object(B.a)({marginRight:5,marginBottom:4,marginTop:4,alignSelf:"flex-end",height:12}),actionbarCollapsed:Object(B.a)({height:4}),body:Y,containerParent:Object(B.a)(X,Z,{selectors:{":focus":{outline:"1px dotted transparent",selectors:{"#postFocusBar":{borderLeft:"2px solid",borderColor:F.a.COMMENTS_PURPLE,display:"inline"}}}}}),containerParentEditing:Object(B.a)(X,Z),containerReplyEditing:Object(B.a)(X,$),containerReply:Object(B.a)(X,$,{selectors:{":focus":{outline:"1px dotted transparent",selectors:{"#postFocusBar":{borderLeft:"2px solid",borderColor:F.a.COMMENTS_PURPLE,display:"inline"}}}}}),containerNew:Object(B.a)(X,{backgroundColor:"#F8F8F8",selectors:{":focus":{outline:"none"}}}),postFocusBar:Object(B.a)({position:"absolute",left:2,top:0,right:0,bottom:0,width:1,backgroundColor:"transparent",display:"none",outline:"none"}),postOverlay:Object(B.a)({position:"absolute",zIndex:10,left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.5)"}),postSpinner:Object(B.a)({position:"absolute",zIndex:20,left:"50%",top:"50%",marginLeft:"-20px",marginTop:"-20px",selectors:{"& .ms-Spinner-circle":{borderColor:H.a,borderTopColor:H.b}}}),editorEditingContainer:Object(B.a)({display:"flex",marginRight:8,backgroundColor:"#FFFFFF",border:"1px solid #EAEAEA",borderRadius:U.d,maxWidth:W,userSelect:"text",padding:0}),editorRestContainer:Object(B.a)({display:"flex",marginRight:8,backgroundColor:"transparent",maxWidth:W,userSelect:"text",padding:"1px",border:0}),lowFidelityWarning:Object(B.a)({display:"flex",fontFamily:"inherit",fontSize:"12px",fontWeight:"normal",fontStyle:"italic",borderStyle:"dotted",borderColor:"red",borderWidth:"1px",maxWidth:"182px",whiteSpace:"normal"})}}),nt=Object(I.b)(function(t){return{actionbarRoot:Object(B.a)({marginBottom:4,marginTop:4,alignSelf:"flex-end",height:12}),actionbarNormal:Object(B.a)({marginBottom:4,marginTop:4,alignSelf:"flex-end",height:12}),actionbarEdit:Object(B.a)({maxHeight:"30px",marginTop:"5px",display:"flex",flexDirection:"row",flexWrap:"nowrap",overflow:"hidden",alignSelf:"flex-end"}),actionbarCollapsed:Object(B.a)({height:4}),body:Object(B.a)(Q),bodyRoot:Object(B.a)(J,{marginTop:t?"0px":void 0}),containerParent:Object(B.a)(X,{selectors:{":focus":{outline:"1px dotted transparent",selectors:{"#postFocusBar":{borderLeft:"2px solid",borderColor:F.a.FLUENT_GRAY,display:"inline"}}}},overflow:"visible",backgroundColor:"transparent"}),containerParentEditing:Object(B.a)(X,{overflow:"visible",backgroundColor:"transparent"}),containerReplyEditing:Object(B.a)(X),containerReply:Object(B.a)(X,{selectors:{":focus":{outline:"1px dotted transparent",selectors:{"#postFocusBar":{borderLeft:"2px solid",borderColor:F.a.FLUENT_GRAY,display:"inline"}}}}}),containerNew:Object(B.a)(X,{overflow:"visible",backgroundColor:"transparent",selectors:{":focus":{outline:"none"}}}),postFocusBar:Object(B.a)({position:"absolute",left:2,top:0,right:0,bottom:0,width:1,backgroundColor:"transparent",display:"none",outline:"none"}),postOverlay:Object(B.a)({position:"absolute",zIndex:10,left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.5)"}),postSpinner:Object(B.a)({position:"absolute",zIndex:20,left:"50%",top:"50%",marginLeft:"-20px",marginTop:"-20px",selectors:{"& .ms-Spinner-circle":{borderColor:H.a,borderTopColor:H.b}}}),editorEditingContainer:Object(B.a)(tt),editorRestContainer:Object(B.a)({display:"flex",marginRight:"0px",backgroundColor:"transparent",userSelect:"text",padding:"1px",border:0}),lowFidelityWarning:Object(B.a)({display:"flex",marginLeft:"4px",fontFamily:"inherit",fontSize:"12px",fontWeight:"normal",fontStyle:"italic",borderStyle:"dotted",borderColor:"red",borderWidth:"1px",whiteSpace:"normal"})}}),ot={selectors:{":focus":{outline:"none"},"& .ql-editor":{boxSizing:"border-box",whiteSpace:"pre-wrap",height:"100%",outline:"none",overflow:"hidden",padding:"0",tabSize:"4",wordWrap:"break-word",userSelect:"text"},"& .ql-clipboard":{left:"-100000px",position:"absolute",top:"50%",height:"1px",userSelect:"text",overflowY:"hidden"},"& .ql-editor p":{margin:0,padding:0,userSelect:"text"},"& .ql-editor a":{userSelect:"text"},"& .ql-editor span":{userSelect:"text"},"& .ql-editor.ql-blank::before":{color:F.a.GRAY_E,content:"attr(data-placeholder)",fontStyle:"normal",fontFamily:"inherit",fontSize:"12px",pointerEvents:"none",position:"absolute"},"& .ql-color-blue":{color:"blue"}}},rt={boxSizing:"border-box",flexGrow:"1",overflowY:"hidden",position:"relative",margin:0,padding:"2px",fontFamily:"inherit",fontSize:"12px",fontWeight:"normal",lineHeight:"1.5",cursor:"text",color:"#333333"},it={maxHeight:96,overflowY:"auto",selectors:{"::-webkit-scrollbar":{width:0}}},at=Object(B.a)(rt,it,{"-ms-overflow-style":"none","scrollbar-width":"none"}),st={paddingBottom:"20px"},ct={paddingBottom:"5px"},lt={minHeight:30,padding:6,paddingTop:5},dt={minHeight:22,padding:10,paddingTop:"2px",paddingBottom:"4px",borderRadius:U.d},pt={pointerEvents:"none",cursor:"default",color:F.a.GRAY_E};(G=K||(K={}))[G.lineHeight=rt.fontSize&&rt.lineHeight?parseInt(rt.fontSize.toString(),10)*parseFloat(rt.lineHeight.toString()):0]="lineHeight",G[G.maxHeight=rt.padding?G.lineHeight*N.collapseContent+2*parseInt(rt.padding.toString(),10):0]="maxHeight";var ut={},ft=K.maxHeight-.75*K.lineHeight+"px",ht={maxHeight:K.maxHeight.toString()+"px"},mt={position:"absolute",left:0,top:0,right:0,bottom:0,backgroundImage:"linear-gradient(rgba(255, 255, 255, 0) 80%, rgba(255, 255, 255, 1) 100%)",visibility:"hidden"},yt={selectors:{":focus":{outline:"none"}}},gt=Object(I.b)(function(t,e,n){var o={};o=e?t?dt:lt:t?ct:st;var r=n?at:rt;return{EditorContainerEditing:Object(B.a)([r,o,ot]),EditorContainerFullContent:Object(B.a)([r,ut,ot]),EditorContainerTruncated:Object(B.a)([r,ut,ht,ot]),EditorDisabled:Object(B.a)([r,pt,ot]),EditorPlaceholder:Object(B.a)([r,pt,t?dt:lt,ot]),InnerEditorDisableFocusOutline:Object(B.a)([yt]),EditorTruncationOverlay:c.o()?Object(B.a)([mt,yt]):Object(B.a)([mt])}}),bt=n(645),vt=n(173),Ct=n(50),xt=n(79),Tt=n(750),Ot=n.n(Tt),St=Ot.a.import("delta"),Et=Ot.a.import("parchment"),Pt=Ot.a.import("blots/inline"),wt=(Ot.a.import("formats/link"),Ot.a.import("modules/clipboard")),It=Ot.a,kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.create=function(n){var o=t.create.call(this,n);return o.setAttribute(e.getDataAttributeName(),n),o.setAttribute("tabIndex","-1"),o.setAttribute("disabled","disabled"),o.setAttribute("style","text-decoration:none; pointer-events: none; cursor: default;"),o.setAttribute("class","ql-color-blue"),o.setAttribute("spellcheck","false"),o},e.formats=function(t){return t.getAttribute(e.getDataAttributeName())||void 0},e.prototype.format=function(n,o){"atmention"===n&&o?this.domNode.setAttribute(e.getDataAttributeName(),o):t.prototype.format.call(this,n,o)},e.prototype.formats=function(){var n=t.prototype.formats.call(this);return n.atmention=e.formats(this.domNode),n},e.getDataAttributeName=function(){return"data-"+e.blotName},e.blotName="atmention",e.tagName="A",e}(Pt),Rt=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.isAtmentionSupported=n.isAtmentionSupported,o.removeAtFormat=o.removeAtFormat.bind(o),o.pasteMentionHandler=o.pasteMentionHandler.bind(o),o}return r.d(e,t),e.prototype.removeAtFormat=function(t,e){this.quill.formatText(t,e,"optional",!1),this.quill.formatText(t,e,"atmention",!1)},e.prototype.pasteMentionHandler=function(){var t=window.getSelection(),e=t&&t.anchorNode?t.anchorNode.parentNode:null,n=t&&t.focusNode?t.focusNode.parentNode:null,o={startBlot:Et.find(e),endBlot:e===n?void 0:Et.find(n)};return o.startBlot&&"atmention"===o.startBlot.statics.blotName&&this.removeAtFormat(o.startBlot.offset(this.quill.scroll),o.startBlot.length()),o.endBlot&&"atmention"===o.endBlot.statics.blotName&&this.removeAtFormat(o.endBlot.offset(this.quill.scroll),o.endBlot.length()),!0},e.prototype.onPaste=function(t){var n=this;if(!t.defaultPrevented&&this.quill.isEnabled())try{e.pasteOperationInProgress=!0,this.pasteMentionHandler();var o=this.quill.getSelection(),r=(new St).retain(o.index),i=this.quill.scrollingContainer.scrollTop;this.container.focus();var a=document.createRange(),s=window.getSelection();a.setStart(this.container,0),a.collapse(!0),s&&(Object(d.g)().assertConditionTag(!!s,"Expected a selection!",595854800),s.removeAllRanges(),s.addRange(a)),this.quill.selection.update("silent"),setTimeout(function(){try{r=r.concat(n.convert()).delete(o.length),r=n.isAtmentionSupported?new St(r.map(function(t){return t.insert&&(t.insert=t.insert.trim(),t.attributes&&t.attributes.optional&&delete t.attributes.optional,!t.attributes||!t.attributes.atmention||Vt(JSON.parse(t.attributes.atmention).fullName,t.insert.slice(1))&&"UnknownEmail"!==JSON.parse(t.attributes.atmention).email||delete t.attributes.atmention),t})):new St(r.map(function(t){return t.insert&&(t.insert=t.insert.trim(),t.attributes&&delete t.attributes.atmention),t})),n.quill.updateContents(r,"user"),n.quill.setSelection(r.length()-o.length,"silent"),n.quill.scrollingContainer.scrollTop=i,n.quill.focus()}catch(t){Object(d.g)().assertConditionTag(!1,"CommentClipboard paste delta scrubbing failed.",595981187)}finally{e.pasteOperationInProgress=!1}},1)}catch(t){Object(d.g)().assertConditionTag(!1,"CommentClipboard preparation for paste failed.",595981188),e.pasteOperationInProgress=!1}},e.pasteOperationInProgress=!1,e}(wt),At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.create=function(n){var o=t.create.call(this,n);return o.setAttribute(e.getDataAttributeName(),n),o},e.formats=function(t){return t.getAttribute(e.getDataAttributeName())||void 0},e.prototype.format=function(n,o){"optional"===n&&o?this.domNode.setAttribute(e.getDataAttributeName(),o):t.prototype.format.call(this,n,o)},e.prototype.formats=function(){var n=t.prototype.formats.call(this);return n.optional=e.formats(this.domNode),n},e.getDataAttributeName=function(){return"data-"+e.blotName},e.blotName="optional",e.tagName="SPAN",e}(Pt),Dt=n(47),jt=n(658),Nt=n(690);It.register(kt),It.register(At),It.register("modules/clipboard",Rt,!0);var Mt=500;function _t(t){var e=xt.c?Object(d.g)().createActivityObject("GetQuillFromOfficeDelta",Object(d.h)(0),d.a.None):void 0;Nt.a.setStartMarker(jt.c.Office2QuillStart);var n={},o=JSON.parse(t).ops.map(function(t){if(void 0!==t.insert){var n={};return n.insert=t.insert,t.attributes&&(n.attributes=t.attributes,n.attributes.atmention&&(n.attributes.atmention=JSON.stringify(t.attributes.atmention))),t.optional&&(n.attributes||(n.attributes={}),n.attributes.optional=JSON.stringify(t.optional)),n}e&&e.failTag(595981190,-2130957543),Object(d.g)().assertConditionTag(!1,"Translation Error: op in office delta is not insert",d.f.reserveTag(595981012))});e&&e.successTag(595981191);var r=Nt.a.getDurationMeasure(jt.c.Office2QuillStart,jt.c.Office2QuillEnd,jt.c.Office2QuillTimer);return Nt.a.updatePerfStruct(jt.b.Office2Quill,r),o.length?(n.ops=o,JSON.stringify(n)):JSON.stringify(new St)}function Bt(t,e,n){var o=xt.c?Object(d.g)().createActivityObject("ComputeTruncation",Object(d.h)(0),d.a.None):void 0;Nt.a.setStartMarker(jt.c.ComputeTruncationStart);var i=document.getElementById(t),a=K.maxHeight,s=0;if(i){o&&(o.addDataField(d.c.TruncationNeeded,1,d.d.SystemMetadata),o.addDataField(d.c.MaxCharSetting,150,d.d.SystemMetadata),o.addDataField(d.c.CommentBodyLength,e.length,d.d.SystemMetadata)),i.textContent="";var c=i.appendChild(document.createElement("p"));c.textContent=e,c.style.whiteSpace="pre-wrap";var l=!1;if(c.offsetHeight>a){for(c.textContent=c.textContent.concat(n);c.offsetHeight>a;){l=!0;var p=c.textContent.length-n.length;if(p>150)c.textContent=c.textContent.slice(0,150);else{var u=0;u=p<=10?p-1:c.offsetHeight-a<=K.lineHeight?Math.floor(p-p/5*.9):Math.floor(.9*p),c.textContent=c.textContent.slice(0,u)}s=c.textContent.length,c.textContent=c.textContent.concat(n)}if(c.textContent=c.textContent.slice(0,c.textContent.length-n.length),l){var f=r.i(c.textContent);f.splice(f.length-1,1),c.textContent=f.join(""),s=c.textContent.length}}}o&&o.successTag(595903715);var h=Nt.a.getDurationMeasure(jt.c.ComputeTruncationStart,jt.c.ComputeTruncationEnd,jt.c.ComputeTruncationTimer);return Nt.a.updatePerfStruct(jt.b.ComputeTruncation,h),s}function Lt(t,e){var n=xt.c?Object(d.g)().createActivityObject("ComputeTruncation",Object(d.h)(0),d.a.None):void 0;Nt.a.setStartMarker(jt.c.ComputeTruncationStart);var o=!1,r=document.getElementById(t);if(r){r.textContent="";var i=r.appendChild(document.createElement("p"));i.textContent=e,i.style.whiteSpace="pre-wrap",o=i.offsetHeight>K.maxHeight}n&&n.successTag(595719133);var a=Nt.a.getDurationMeasure(jt.c.ComputeTruncationStart,jt.c.ComputeTruncationEnd,jt.c.ComputeTruncationTimer);return Nt.a.updatePerfStruct(jt.b.ComputeTruncation,a),o}function Ft(t,e,n){var o=t.slice(0,e);return o.insert(n),o}function Ht(t){return void 0!==t.peoplePickerProps}function Ut(t,e,n){var o,i="#"+Object(Ct.z)(t.id),a=["atmention","optional"],s=(o=t.placeholder?new It(i,{placeholder:t.placeholder,formats:a,modules:r.a({},e,{clipboard:{isAtmentionSupported:Ht(t)}})}):new It(i,{formats:a,modules:r.a({},e,{clipboard:{isAtmentionSupported:Ht(t)}})})).root;if(s){s.spellcheck=!1,o.history.options.delay=Mt,s.id=t.id,s.setAttribute("aria-haspopup","true"),t.displayMode===A.Editing?s.setAttribute("role","textbox"):s.setAttribute("role","presentation"),t.accessibilityLabel&&s.setAttribute("aria-label",t.accessibilityLabel);var l=o.clipboard&&o.clipboard.container;l&&l.setAttribute("aria-hidden","true")}else Object(d.g)().assertConditionTag(!1,"root element on Quill is undefined",595891799);if(t.defaultValue){var p=_t(t.defaultValue);if(o.setContents(JSON.parse(p),"api"),!t.showFullContent){var u=o.getText();if(c.g())Lt(t.id,u)&&(zt(t.id),Object(vt.b)().record(t.id,u.length,o.getText().length)),o.setContents(o.getContents());else{u=u.slice(0,u.length-1);var f=o.getContents(),h=Bt(t.id,u,t.localizedEllipsis||"");if(h&&o.getLength()>=h){var m=Ft(f,h,t.localizedEllipsis||"");o.setText(""),o.setContents(m,"api"),Object(vt.b)().record(t.id,u.length,o.getText().length)}else o.setContents(f)}}}return t.displayMode===A.Disabled||t.displayMode===A.ReadOnly?o.disable():o.enable(),o.on("text-change",function(t,e,o){n(t,e,o)}),o}function zt(t){var e=document.getElementById(Object(Ct.N)(t)),n=document.getElementById(Object(Ct.z)(t));e&&n&&(n.style.maxHeight=ft,e.style.visibility="visible")}function Vt(t,e){var n=e.trim().split(" "),o=t.trim().split(" ");return n.every(function(t){return o.indexOf(t)>=0})}function qt(t){var e=!1;return t.forEach(function(t){e=!!t.delete&&t.delete.valueOf()>1}),e}function Kt(t,e){var n=document.getElementById(t);n&&n.setAttribute("data-placeholder",e)}function Gt(t){var e=new Map;t&&t.ops&&t.ops.forEach(function(t){if(t.attributes){var n=void 0;if("string"==typeof t.attributes.atmention)try{n=JSON.parse(t.attributes.atmention)}catch(t){return void Object(d.g)().assertConditionTag(!1,"Failed to parse atmention attributes",595724291)}else n=t.attributes.atmention;n&&e.set(n.email,{UserId:n.email,Provider:Dt.b,DisplayName:n.fullName})}});var n=[];return e.forEach(function(t){return n.push(t)}),n}var Wt=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.keyboardBindings={tab:{key:9,handler:function(){return o.tabKeyHandler()}},shiftTab:{key:9,shiftKey:!0,handler:function(){return o.tabKeyHandler()}},enter:{key:13,handler:function(){return o.enterNewline(!1)}},back:{key:8,handler:function(){return o.deleteHandler(!1)}},delete:{key:46,handler:function(){return o.deleteHandler(!0)}},commitWithCtrl:{key:13,shortKey:!0,handler:function(){return o.handleCommitKeys()}},newlineWithShift:{key:13,shiftKey:!0,handler:function(){return o.enterNewline(!0)}},requestEscape:{key:27,handler:function(){return o.handleEscapeKeys()}}},o.onClickHandler=o.onClickHandler.bind(o),o.onFocusHandler=o.onFocusHandler.bind(o),o.onKeyDownHandler=o.onKeyDownHandler.bind(o),o.onKeyPressHandler=o.onKeyPressHandler.bind(o),o.onTextChangedHandler=o.onTextChangedHandler.bind(o),o.deleteHandler=o.deleteHandler.bind(o),o.removeAtFormat=o.removeAtFormat.bind(o),o.tabKeyHandler=o.tabKeyHandler.bind(o),o.onBlurHandler=o.onBlurHandler.bind(o),o.setEditorRef=o.setEditorRef.bind(o),o.enterNewline=o.enterNewline.bind(o),o.handleCommitKeys=o.handleCommitKeys.bind(o),o.handleEscapeKeys=o.handleEscapeKeys.bind(o),o}return r.d(e,t),e.prototype.componentDidUpdate=function(t,e){var n=document.getElementById(Object(Ct.z)(this.props.id));if(n){var o=n.getElementsByClassName("ql-editor")[0];o?this.props.displayMode===A.Editing?(this.props.accessibilityLabel&&o.setAttribute("aria-label",this.props.accessibilityLabel.toString()),o.setAttribute("role","textbox")):(o.removeAttribute("aria-label"),o.setAttribute("role","presentation")):Object(d.g)().assertConditionTag(!1,"quillEditorDiv missing in CommentEditor",595735041)}var r=this.props.defaultValue;if(this.props.showFullContent||!t.showFullContent&&t.displayMode===this.props.displayMode){if(!t.showFullContent&&this.props.showFullContent&&r){if(c.g()){var i=document.getElementById(Object(Ct.z)(this.props.id));i&&(i.style.maxHeight="none")}this.myQuill.setContents(JSON.parse(r))}}else{var a=this.myQuill.getText(),s=this.myQuill.getContents();if(c.g())Lt(this.props.id,a)&&(zt(this.props.id),Object(vt.b)().record(this.props.id,a.length,this.myQuill.getText().length)),this.myQuill.setContents(s);else{a=a.slice(0,a.length-1);var l=Bt(this.props.id,a,t.localizedEllipsis||"");if(l&&this.myQuill.getLength()>=l){var p=Ft(s,l,t.localizedEllipsis||"");this.myQuill.setText(""),this.myQuill.setContents(p,"api"),Object(vt.b)().record(this.props.id,a.length,this.myQuill.getText().length)}else this.myQuill.setContents(s)}}if(t.displayMode!==this.props.displayMode)switch(this.props.displayMode){case A.Disabled:case A.ReadOnly:this.myQuill.disable(),r&&this.props.showFullContent&&this.setContents(r);break;case A.Editing:this.myQuill.history.clear(),this.myQuill.enable();var u=this.myQuill.getLength();this.myQuill.setSelection(u-1,0),this.myQuill.focus();break;default:throw Object(d.g)().assertConditionTag(!1,"Unknown display mode transition.",595961796),new M.a("Unknown display mode: "+this.props.displayMode,-2130957529)}this.props.initialDraftContent&&this.props.initialDraftContent!==t.initialDraftContent&&this.restoreDraftIfExists();var f=this.props.placeholder;f&&t.placeholder!==f&&Kt(this.props.id,f)},e.prototype.componentDidMount=function(){this.initializeQuill(),this.restoreDraftIfExists(),this.props.componentRef(this)},e.prototype.componentWillUnmount=function(){if(this.context.getContentManager&&this.props.shouldPersistContentOnUnmount&&!c.r()){var t=this.context.getContentManager();if(t){var e=0;this.myQuill.getSelection()&&(e=this.myQuill.getSelection().index);var n={editorContent:this.getContentsAsync(),editorCursorPosition:Promise.resolve(e)};t.persistContent(this.props.contentManagerId,n)}}},e.prototype.onTextChangedHandler=function(t,e,n){var o=this;if("user"===n&&this.props.displayMode===A.Editing&&!this.myQuill.history.ignoreChange)if(qt(t)){var r=this.myQuill.getContents(),i=0;r.forEach(function(t){t.attributes&&t.attributes.atmention&&(Vt(JSON.parse(t.attributes.atmention).fullName,t.insert.slice(1))||o.removeAtFormat(i,t.insert.length)),i+=t.insert.length})}else{var a=window.getSelection(),s=a&&a.anchorNode?a.anchorNode.parentNode:null,c=Et.find(s);setTimeout(function(){var e=o.myQuill.getSelection();if(c&&"atmention"===c.statics.blotName){var n=c.offset(o.myQuill.scroll);if(e.index===n+1)o.removeAtFormat(n,1);else if(e.index<n+c.length()&&e.index>n)o.removeAtFormat(n,c.length());else if(e.index===n+c.length()){t.filter(function(t){return"string"==typeof t.insert}).length&&o.removeAtFormat(e.index-1,1)}}},0)}this.props.onTextChange&&this.props.onTextChange(this.myQuill.getText())},e.prototype.restoreDraftIfExists=function(){var t=this,e=void 0,n=void 0;if(c.r()?e=this.props.initialDraftContent:this.context.getContentManager&&(n=this.context.getContentManager())&&n.hasPersistedContent(this.props.contentManagerId)&&(e=n.getPersistedContent(this.props.contentManagerId)),e){var o=e.editorCursorPosition,i=e.editorContent;o||(Object(d.g)().assertConditionTag(!1,"Cursor position promise should not be null on Web, defaulting to 0.",595981057),o=Promise.resolve(0)),Promise.all([i,o]).then(function(e){var o=r.g(e,2),i=o[0],a=o[1];i&&(n&&n.clearPersistedContent(t.props.contentManagerId),t.setContents(i,a))})}},e.prototype.setEditorRef=function(t){this.editorRef=t},e.prototype.removeAtFormat=function(t,e){this.myQuill.formatText(t,e,{optional:!1,atmention:!1})},e.prototype.getChunkBoundaryForDelete=function(t,e,n,o){var r=this.myQuill.getText(n.index,1),i=this.myQuill.getText(n.index-1,1),a=this.myQuill.getText(n.index,n.length),s=-1,c=-1,l=0===n.length,d=l&&" "===i,p=l&&" "===r||!this.myQuill.getFormat(n.index,1).atmention;if(""!==a&&n.index+n.length<=t+e.length||!p&&!d){if(""!==a&&a.indexOf(" ")>=0)return;return s=e.lastIndexOf(" ",n.index-t-1),c=e.indexOf(" ",n.index-t),{chunkStart:s<0?c<0?t:t+1:s+t,chunkEnd:c<0?t+e.length-1:s<0?c+t:c+t-1}}if(l){if(p)return o?(c=e.indexOf(" ",n.index-t+1),{chunkStart:n.index,chunkEnd:c<0?t+e.length-1:c+t}):(s=e.lastIndexOf(" ",n.index-t-1),c=e.indexOf(" ",n.index-t),{chunkStart:s<0?c<0?t:t+1:s+t,chunkEnd:s<0&&" "===r?n.index:n.index-1});if(d)return o?(c=e.indexOf(" ",n.index-t),{chunkStart:n.index-1,chunkEnd:c<0?t+e.length-1:c+t}):{chunkStart:(s=e.lastIndexOf(" ",n.index-t-2))<0?t+1:s+t+1,chunkEnd:n.index-1}}},e.prototype.deleteHandler=function(t){var e=window.getSelection(),n=e&&e.anchorNode?e.anchorNode.parentNode:null,o=e&&e.focusNode?e.focusNode.parentNode:null,r={startBlot:Et.find(n),endBlot:n===o?void 0:Et.find(o)},i=e&&e.anchorNode?Et.find(e.anchorNode.previousSibling):null;if(i&&"atmention"===i.statics.blotName&&e&&0===e.anchorOffset&&(r.startBlot=i),r.startBlot){if(r.endBlot)return"atmention"===r.startBlot.statics.blotName&&this.removeAtFormat(r.startBlot.offset(this.myQuill.scroll),r.startBlot.length()),"atmention"===r.endBlot.statics.blotName&&this.removeAtFormat(r.endBlot.offset(this.myQuill.scroll),r.endBlot.length()),!0;var a=r.startBlot.offset(this.myQuill.scroll),s=this.myQuill.getSelection(),c=this.myQuill.getText(a,r.startBlot.length());if("atmention"!==r.startBlot.statics.blotName&&0===s.length&&t&&this.myQuill.getFormat(s.index,1).atmention){var l=this.myQuill.getFormat(s.index+1).atmention.fullName;l&&this.removeAtFormat(s.index,l.length+1)}if("atmention"===r.startBlot.statics.blotName){if(s.index===a)return 0===s.length&&!t||(this.removeAtFormat(r.startBlot.offset(this.myQuill.scroll),r.startBlot.length()),!0);var d=this.getChunkBoundaryForDelete(a,c,s,t);if(d)return d.chunkStart>d.chunkEnd||(this.myQuill.deleteText(d.chunkStart,d.chunkEnd-d.chunkStart+1),!1);this.removeAtFormat(a,r.startBlot.length())}}return!0},e.prototype.tabKeyHandler=function(){return!1},e.prototype.initializeQuill=function(){var t={keyboard:{bindings:this.keyboardBindings}};this.myQuill=Ut(this.props,t,this.onTextChangedHandler)},e.prototype.onKeyDownHandler=function(t){this.props.onKeyDown&&this.props.onKeyDown(t)},e.prototype.onKeyPressHandler=function(t){},e.prototype.enterNewline=function(t){var e=this;if(!this.myQuill)return Object(d.g)().assertConditionTag(!1,"this.myQuill should always be defined if in keyboard handler",595981058),!1;var n=function(){return e.myQuill.insertText(e.myQuill.getSelection().index,"\n"),!1},o=window.getSelection(),r=o&&o.anchorNode?o.anchorNode.parentNode:null,i=Et.find(r);if(i&&"atmention"===i.statics.blotName){var a=i.offset(this.myQuill.scroll),s=this.myQuill.getSelection();return s.index===a||s.index===a+i.length()?n():(this.removeAtFormat(i.offset(this.myQuill.scroll),i.length()),n())}return!t||n()},e.prototype.handleCommitKeys=function(){this.props.onCommitRequested&&!this.isEditorEmpty()&&this.props.onCommitRequested()},e.prototype.handleEscapeKeys=function(){this.props.onEscapeRequested&&this.props.onEscapeRequested()},e.prototype.onFocusHandler=function(t){if(this.editorRef){var e=document.activeElement;this.editorRef.contains(e)&&this.editorRef!==e||this.focus(),this.props.onFocus&&this.props.onFocus(),t.stopPropagation()}},e.prototype.onBlurHandler=function(t){if(this.props.displayMode===A.Editing&&this.props.onBlur&&!Rt.pasteOperationInProgress&&t.relatedTarget!==this.editorRef&&t.target!==this.editorRef){var e=this.isEditorEmpty();t.relatedTarget&&e?this.props.onBlur(!e,t.relatedTarget.id):this.props.onBlur(!e,void 0)}},e.prototype.onClickHandler=function(t){c.j()&&this.editorRef&&this.editorRef.focus()},e.prototype.getEditorClass=function(){var t=gt(c.g(),this.props.useReplyBoxStyling,this.props.isHeightBounded);return this.props.displayMode===A.ReadOnly?this.props.showFullContent?t.EditorContainerFullContent:t.EditorContainerTruncated:this.props.displayMode===A.Disabled?this.props.placeholder?t.EditorPlaceholder:t.EditorDisabled:this.props.displayMode===A.Editing?t.EditorContainerEditing:t.EditorContainerFullContent},e.prototype.isEditorEmpty=function(){return!(!this.myQuill||!this.myQuill.editor.isBlank())},e.prototype.setContents=function(t,e){if(this.myQuill){var n=_t(t),o=JSON.parse(n);if(this.myQuill.setContents(o),c.h()){if(this.props.displayMode===A.Editing){var r=void 0!==e?e:this.myQuill.getLength();this.myQuill.setSelection(r,0,"api")}}else e&&this.myQuill.setSelection(e,0,"api")}},e.prototype.getContentsAsync=function(){var t=this;return new Promise(function(e,n){if(t.myQuill){var o=t.myQuill.getContents();e(function(t){var e=xt.c?Object(d.g)().createActivityObject("GetOfficeDeltaFromQuill",Object(d.h)(0),d.a.None):void 0;Nt.a.setStartMarker(jt.c.Quill2OfficeStart);var n={},o=JSON.parse(t).ops.map(function(t){if(void 0!==t.insert){var n={};return n.insert=t.insert,t.attributes&&(t.attributes.optional&&("string"==typeof t.attributes.optional?n.optional=JSON.parse(t.attributes.optional):n.optional=t.attributes.optional),t.attributes.atmention&&(n.attributes={},"string"==typeof t.attributes.atmention?n.attributes.atmention=JSON.parse(t.attributes.atmention):n.attributes.atmention=t.attributes.atmention)),n}e&&e.failTag(595981192,-2130957544);var o=Nt.a.getDurationMeasure(jt.c.Quill2OfficeStart,jt.c.Quill2OfficeEnd,jt.c.Quill2OfficeTimer);Nt.a.updatePerfStruct(jt.b.Quill2Office,o),Object(d.g)().assertConditionTag(!1,"Translation Error: op in quill delta is not insert",d.f.reserveTag(595981013))}),r=Nt.a.getDurationMeasure(jt.c.Quill2OfficeStart,jt.c.Quill2OfficeEnd,jt.c.Quill2OfficeTimer);return Nt.a.updatePerfStruct(jt.b.Quill2Office,r),o.length?(n.ops=o,e&&e.successTag(595981193),JSON.stringify(n)):(e&&e.failTag(595981194,-2130957544),Object(d.g)().assertConditionTag(!1,"Translation Error: Quill Delta should never have an empty operation",d.f.reserveTag(595981014)),JSON.stringify(new St))}(JSON.stringify(o)))}else n(new M.a(_.h,-2130957550))})},e.prototype.getCursorPositionAsync=function(){var t=this;return new Promise(function(e,n){var o=t.myQuill?t.myQuill.getSelection():void 0;e(o?o.index:void 0)})},e.prototype.clear=function(){this.myQuill&&this.myQuill.setText("")},e.prototype.blur=function(){this.myQuill&&this.myQuill.blur()},e.prototype.focus=function(){this.myQuill&&this.myQuill.focus()},e.prototype.setSelection=function(t,e){this.myQuill&&this.myQuill.setSelection(t,e)},e.prototype.getDisplayMode=function(){return this.props.displayMode},e.prototype.renderAdditionalEditorContent=function(){},e.prototype.renderTruncationOverlay=function(t){if(void 0!==this.props.showFullContent&&!this.props.showFullContent&&this.props.displayMode!==A.Editing&&c.g())return i.createElement("div",{id:Object(Ct.N)(t),className:gt(!0).EditorTruncationOverlay,tabIndex:-1,onFocus:c.o()?this.onFocusHandler:void 0})},e.prototype.render=function(){var t=this.getEditorClass(),e=gt(c.g());return i.createElement("div",{className:t},i.createElement("div",{"aria-label":this.props.accessibilityLabel,role:"textbox","aria-readonly":this.props.displayMode!==A.Editing,tabIndex:-1,ref:this.setEditorRef,className:e.InnerEditorDisableFocusOutline,id:Object(Ct.z)(this.props.id),onKeyDown:this.onKeyDownHandler,onKeyPress:this.onKeyPressHandler,onFocus:this.onFocusHandler,onBlur:this.onBlurHandler,onClick:this.onClickHandler}),this.renderAdditionalEditorContent(),this.renderTruncationOverlay(this.props.id))},e.contextTypes=bt.a,e}(i.PureComponent),Yt=n(156);var Qt=function(t){function e(e){var n=t.call(this,e)||this;return n.onGetCandidates=n.onGetCandidates.bind(n),n.onGetMoreResults=n.onGetMoreResults.bind(n),n.onGetPicture=n.onGetPicture.bind(n),n.onBasicMentionRef=n.onBasicMentionRef.bind(n),n.state={},Object(Yt.a)().then(function(t){n.setState({PeoplePicker:t})}),n}return r.d(e,t),e.prototype.getContacts=function(t,e,n){var o=Object(d.g)().createActivityObject("OnGetCandidatesEvent",Object(d.h)(1),d.a.None);return o.addDataField(d.c.NumberOfCandidatesRequested,e,d.d.SystemMetadata),o.addDataField(d.c.FilterLength,t.length,d.d.SystemMetadata),o.addDataField(d.c.SearchGraph,n,d.d.SystemMetadata),this.props.peoplePickerProps.onGetUserContacts(t,e,n).then(function(t){return o.addDataField(d.c.NumberOfCandidatesReceived,t.length,d.d.SystemMetadata),o.successTag(595981211),t},function(t){return o.failTag(595981212,-2130957538),Promise.reject(t)})},e.prototype.onGetCandidates=function(t,e){return this.getContacts(t,e,!1)},e.prototype.onGetMoreResults=function(t,e){return this.getContacts(t,e,!0)},e.prototype.onBasicMentionRef=function(t){this.basicMentions=t},e.prototype.onMentionsTextChanged=function(t,e){this.basicMentions&&this.basicMentions.setInputText(t,e)},e.prototype.onMentionsKeyDownHandler=function(t){this.basicMentions&&this.basicMentions.onKeyDown(t)},e.prototype.onGetPicture=function(){return""},e.prototype.render=function(){return Object(d.g)().assertConditionTag(void 0!==this.props.peoplePickerProps.pickerLocalizationDetails.searchDirectory,"Expected ILocalizationProps, not LPP string props",595932128),this.state.PeoplePicker?i.createElement(this.state.PeoplePicker.BasicMentions,{ref:this.onBasicMentionRef,onReplaceText:this.props.replaceText,target:this.props.target?"#"+this.props.target:"",maxMenuHeight:400,onGetMoreResults:this.onGetMoreResults,onGetPicture:this.onGetPicture,automationID:Ct.w(this.props.target),onShow:this.props.onShow,onDismiss:this.props.onDismiss,debugMode:!1,localizationProps:this.props.peoplePickerProps.pickerLocalizationDetails,onGetCandidates:this.onGetCandidates,clientTelemetry:Object(d.g)(),preventDismissOnScroll:this.props.peoplePickerProps.preventDismissOnScroll}):null},e}(i.PureComponent),Jt=n(345),Xt=It.import("delta"),Zt=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.startIndexOfMention=0,o.mentionableKeyboardBindings=r.a({},o.keyboardBindings,{enter:{key:13,handler:function(){return o.enterNewline(!1)}}}),o.exitAtMentionMode=o.exitAtMentionMode.bind(o),o.insertMentionText=o.insertMentionText.bind(o),o.onKeyDownHandler=o.onKeyDownHandler.bind(o),o.onKeyPressHandler=o.onKeyPressHandler.bind(o),o.onTextChangedHandler=o.onTextChangedHandler.bind(o),o.onMentionHostRef=o.onMentionHostRef.bind(o),o.enterAtMentionMode=o.enterAtMentionMode.bind(o),o.onShowHandler=o.onShowHandler.bind(o),o.enterNewline=o.enterNewline.bind(o),o.state={inAtMentionMode:!1},o}return r.d(e,t),e.prototype.enterNewline=function(e){return!this.state.inAtMentionMode&&t.prototype.enterNewline.call(this,e)},e.prototype.handleEscapeKeys=function(){this.state.inAtMentionMode||t.prototype.handleEscapeKeys.call(this)},e.prototype.componentDidUpdate=function(e,n){n.inAtMentionMode&&!this.state.inAtMentionMode&&this.AtMentionRef&&this.AtMentionRef.onMentionsTextChanged("",!0),t.prototype.componentDidUpdate.call(this,e,n)},e.prototype.onMentionHostRef=function(t){this.AtMentionRef=t},e.prototype.updateCurrentMentions=function(t,e){var n=Gt(e),o=Gt(e.compose(t));Object(l.a)(n,o)||this.props.onCurrentMentionsUpdated(o)},e.prototype.onTextChangedHandler=function(e,n,o){if(this.state.inAtMentionMode&&this.AtMentionRef){var r=this.getMentionText();this.AtMentionRef.onMentionsTextChanged(r,!1)}t.prototype.onTextChangedHandler.call(this,e,n,o),this.props.displayMode===A.Editing&&c.a()&&(function(t){var e=!1;return t.forEach(function(t){e||(e=t.insert&&t.attributes&&t.attributes.atmention)}),e}(e)||qt(e)||function(t){var e=!1;return t.forEach(function(t){e||(e=!!t.retain&&!!t.attributes&&null===t.attributes.atmention)}),e}(e))&&this.updateCurrentMentions(e,n)},e.prototype.initializeQuill=function(){var t={keyboard:{bindings:this.mentionableKeyboardBindings}};this.myQuill=Ut(this.props,t,this.onTextChangedHandler)},e.prototype.onKeyPressHandler=function(t){var e=this.myQuill.getSelection();if(e){if(String.fromCharCode(t.which)!==Dt.a)return;var n=this.myQuill.getText(e.index-1,1),o=/\s/.test(n),r=/\n/.test(n),i=""===n;(0===e.index||o||r||i)&&(this.enterAtMentionMode(!1),this.startIndexOfMention=e.index)}},e.prototype.onKeyDownHandler=function(e){var n=this.myQuill.getSelection();if(n)if(Object(D.c)(e.key)===D.a.Backspace&&this.state.inAtMentionMode){var o=n.index;(o>0&&this.startIndexOfMention===o-1||this.startIndexOfMention===o)&&this.exitAtMentionMode()}else if(Object(D.c)(e.key)===D.a.Delete&&this.state.inAtMentionMode){n.index===this.startIndexOfMention&&this.exitAtMentionMode()}this.AtMentionRef&&this.AtMentionRef.onMentionsKeyDownHandler(e),t.prototype.onKeyDownHandler.call(this,e)},e.prototype.getMentionText=function(){var t=0;this.myQuill.getSelection()&&(t=this.myQuill.getSelection().index),t<this.startIndexOfMention&&xt.e("selection moved before @ when inAtMentionMode: "+this.state.inAtMentionMode+"\n      selectionIndex "+t+" startIndexOfMention "+this.startIndexOfMention);var e=1;return e=t>this.startIndexOfMention?t-this.startIndexOfMention:t===this.startIndexOfMention?1:this.myQuill.getLength(),this.myQuill.getText(this.startIndexOfMention,e)},e.prototype.exitAtMentionMode=function(){this.setState({inAtMentionMode:!1}),this.updateAriaAttributes(!1)},e.prototype.enterAtMentionMode=function(t){this.setState({inAtMentionMode:!0}),t&&this.updateAriaAttributes(!0)},e.prototype.onShowHandler=function(){this.enterAtMentionMode(!0)},e.prototype.updateAriaAttributes=function(t){if(this.editorRef){var e=document.getElementById(this.props.id);e?e.hasAttribute("aria-controls")&&!t?e.removeAttribute("aria-controls"):t&&(e.setAttribute("aria-controls",Ct.w(this.props.id)),c.v()&&e.parentElement&&e.parentElement.focus()):Object(d.g)().assertConditionTag(!e,"Trying to use Quill div when not mounted in DOM",595981011)}},e.prototype.insertMentionText=function(t,e,n){this.exitAtMentionMode(),this.props.onMentionCreated(n);var o=n.DisplayName,r=n.Email,i=Jt.b.Resolved,a=(new Xt).retain(this.startIndexOfMention).delete(t).insert("@"+e,{atmention:JSON.stringify(Object(Jt.d)(o,r,i))});c.c()&&a.insert(" "),this.myQuill.updateContents(a,"api");var s=c.c()?2:1,l=this.startIndexOfMention+e.length+s;this.myQuill.setSelection(l,0)},e.prototype.renderAdditionalEditorContent=function(){return this.props.displayMode===A.Editing?i.createElement(Qt,{ref:this.onMentionHostRef,replaceText:this.insertMentionText,target:this.props.id,onShow:this.onShowHandler,onDismiss:this.exitAtMentionMode,peoplePickerProps:this.props.peoplePickerProps}):void 0},e}(Wt),$t=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.getId=o.getId.bind(o),o}return r.d(e,t),e.prototype.componentWillUnmount=function(){!this.props.onSaveDraft||this.props.displayMode!==g.a.Draft&&this.props.displayMode!==g.a.Reply||this.props.onSaveDraft(this)},e.prototype.getId=function(){return this.props.id},e}(i.PureComponent),te=Object(I.b)(function(){return{commandBar:Object(B.a)({height:32,display:"flex",overflow:"hidden",flexDirection:"row",flexShrink:0,flexWrap:"nowrap",justifyContent:"center",alignContent:"center",alignItems:"center",margin:0,border:0,backgroundColor:"#F8F8F8",selectors:{":focus":{outline:"none"}}}),separatorLine:Object(B.a)({height:32,width:"1px",backgroundColor:"#EAEAEA"})}}),ee=Object(I.b)(function(){return{commandBar:Object(B.a)({height:32,display:"flex",overflow:"hidden",flexDirection:"row",flexShrink:0,flexWrap:"nowrap",justifyContent:"flex-end",alignContent:"flex-end",alignItems:"flex-end",margin:0,border:0,backgroundColor:"#FFFFFF",selectors:{":focus":{outline:"none"}}}),separatorLine:Object(B.a)({height:32,width:"1px",backgroundColor:"#FFFFFF"})}}),ne=Object(I.b)(function(){return{root:{backgroundColor:"transparent",margin:0,border:"1px solid transparent",cursor:"pointer",padding:"0px",height:32,flexGrow:1,color:"#333333",fontSize:"12px",fontFamily:"inherit",lineHeight:"18px",selectors:{".ms-Fabric--isFocusVisible &:focus::after":U.l}},rootHovered:Object(B.a)({color:"#000000",backgroundColor:"transparent"},U.k),rootChecked:{backgroundColor:"transparent"},rootPressed:{backgroundColor:"transparent"},rootFocused:Object(B.a)({color:"#000000",outline:"none",border:"1px dotted"},U.j),label:{fontSize:"12px",fontFamily:"inherit",lineHeight:"18px",fontWeight:"normal"}}}),oe=Object(I.b)(function(){return{root:{background:"#FFFFFF",maxHeight:"24px",width:"37px",margin:7,marginLeft:0,padding:0,borderRadius:U.d,border:"1px solid ",borderColor:F.a.GRAY_C,position:"relative",selectors:{".ms-Fabric--isFocusVisible &:focus::after":U.l,".ms-Button-flexContainer":{position:"relative"}}},rootPressed:{color:F.a.GRAY_J},rootHovered:Object(B.a)({color:F.a.GRAY_J},U.k),rootFocused:Object(B.a)({color:F.a.GRAY_H,outline:"none",border:"1px dotted"},U.j),iconDisabled:{color:F.a.GRAY_C},icon:{color:F.a.GRAY_F,width:"16px",margin:1},iconPressed:{color:F.a.GRAY_J},iconHovered:{color:F.a.GRAY_J}}}),re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(){var t=c.g()?oe():ne(),e={id:this.props.id,disabled:this.props.disabled,onClick:this.props.onClick,ariaLabel:this.props.accessibilityLabel,tabIndex:this.props.isTabbable?0:-1};return c.g()?(Object(d.g)().assertConditionTag(!!this.props.iconName,"commandbutton icon should be defined in Fluent",595730902),i.createElement(O.a,r.a({},e,{title:this.props.text,styles:t,iconProps:{iconName:this.props.iconName,style:{width:12,height:14,marginLeft:"12px",marginRight:"12px"}}}),this.props.text)):i.createElement(T.a,r.a({},e,{styles:t}),this.props.text)},e}(i.PureComponent),ie=function(t){function e(e){var n=t.call(this,e)||this;return n.styles=void 0,n.styles=c.g()?ee():te(),n}return r.d(e,t),e.prototype.generateContentToRender=function(t,e,n){for(var o=t.map(function(t,o){return i.createElement(re,r.a({isTabbable:e,disabled:n,key:o},t))}),a=2*o.length-1,s=[],c=0,l=0;l<a;++l)l%2==0?(s.push(o[c]),++c):s.push(i.createElement("div",{key:"separator"+l,className:this.styles.separatorLine}));return s},e.prototype.render=function(){return i.createElement("div",{tabIndex:-1,className:this.styles.commandBar},this.generateContentToRender(this.props.actions,this.props.isTabbable,this.props.disableActions))},e}(i.PureComponent),ae=n(681),se=Object(I.b)(function(){return{iconContextMenuAnchor:{menuIconDisabled:{color:F.a.GRAY_C},menuIcon:{color:F.a.GRAY_F,margin:0,width:"16px"},menuIconPressed:{color:F.a.GRAY_J},menuIconHovered:Object(B.a)({color:F.a.GRAY_J},U.k),rootPressed:{color:F.a.GRAY_J},rootHovered:Object(B.a)({color:U.b.BUTTON_HOVER},U.k),rootFocused:Object(B.a)({color:F.a.GRAY_H,outline:"none",border:"1px solid",borderColor:F.a.FLUENT_GRAY},U.j),root:{height:"10px",width:"20px",border:"1px solid transparent",padding:0,margin:0,color:F.a.GRAY_E,selectors:{".ms-Fabric--isFocusVisible &:focus::after":U.l,".ms-Button-flexContainer":{position:"relative"}}}},contextMenu:Object(B.a)({minWidth:30,maxWidth:172,paddingTop:"6px",paddingBottom:"6px",margin:0,overflow:"hidden",selectors:{".ms-FocusZone.ms-ContextualMenu.is-open":Object(B.a)({display:"flex",alignContent:"flex-end",alignItems:"flex-end",justifyContent:"flex-end",minWidth:30})}}),calloutStyle:{root:{borderColor:F.a.COMMENTS_GRAY,boxShadow:U.a.LEVEL2}}}}),ce=n(518);function le(t){var e=se();return i.createElement(O.a,{id:t.id,title:t.title,ariaLabel:t.ariaLabel,styles:e.iconContextMenuAnchor,onMenuClick:t.onMenuClick,menuProps:{ariaLabel:t.ariaLabel,className:e.contextMenu,directionalHint:S.DirectionalHint.bottomRightEdge,gapSpace:2,isBeakVisible:!1,shouldFocusOnMount:!1,calloutProps:{preventDismissOnScroll:!1,styles:e.calloutStyle,finalHeight:1},items:t.menuItems},menuIconProps:{iconName:Object(ce.a)(7),style:{width:16}},tabIndex:t.tabIndex})}var de=n(640),pe={color:F.a.GRAY_H2,fontWeight:"600",alignSelf:"baseline",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",marginLeft:"3px",userSelect:"text"},ue=Object(B.a)(pe,{fontFamily:"inherit",fontSize:"12px",lineHeight:"15px",maxWidth:"176px",paddingRight:"1px",paddingLeft:"0px",paddingBottom:"1px",flex:"4 1 176px"}),fe=Object(B.a)(pe,{fontFamily:U.g+", "+U.h+", "+U.i+", Arial, Verdana, sans-serif",marginBottom:"1px",fontSize:"14px",lineHeight:"18px",flex:"4 1 auto"}),he=Object(I.b)(function(){return{author:Object(B.a)(ue,{color:F.a.GRAY_H2}),authorResolvedPost:Object(B.a)(ue,{color:F.a.GRAY_E}),header:Object(B.a)({display:"flex",direction:"inherit",overflow:"hidden",flexDirection:"row",flexWrap:"nowrap"})}}),me=Object(I.b)(function(){return{author:Object(B.a)(fe,{color:F.a.GRAY_H2}),authorResolvedPost:Object(B.a)(fe,{color:F.a.GRAY_E}),header:Object(B.a)({display:"flex",direction:"inherit",overflow:"hidden",flexDirection:"row",flexWrap:"nowrap"})}});var ye=Object(I.b)(function(t,e){return Object(d.g)().assertConditionTag(!!t.localizationAPI,"LocalizationAPI must be present when rendering context menu",595710280),{id:Ct.C({id:t.parentId,renderContextType:e}),title:t.localizationAPI?t.localizationAPI.getString(123):"",ariaLabel:t.localizationAPI?t.localizationAPI.getString(123):"",onMenuClick:ge(t),menuItems:t.menuItems,tabIndex:t.isTabbable?0:-1}},5),ge=Object(I.b)(function(t){return function(e){t.trySelectPost(),e&&Object(D.c)(e.key)===D.a.ArrowDown&&e.preventDefault()}});function be(t){var e=c.g()?me():he(),n=t.resolved?e.authorResolvedPost:e.author;return i.createElement("div",{className:e.header},i.createElement("div",{className:n},t.author),c.g()?function(t){return t.contextMenuProps&&0!==t.contextMenuProps.menuItems.length?i.createElement(le,r.a({},ye(t.contextMenuProps,t.renderContextType))):null}(t):void 0)}var ve=n(15),Ce=n(544);function xe(t){var e=c.g(),n=e?{text:t.author,coinSize:20,initialsColor:t.resolved?F.a.FLUENT_RESOLVED:t.authorColor||ve.a.purple,hidePersonaDetails:!0}:{text:t.author,size:ve.c.extraExtraSmall,initialsColor:t.resolved?ve.a.black:t.authorColor||ve.a.purple,hidePersonaDetails:!0},o=e?q():V();return i.createElement("div",{className:t.isParent&&e?o.personaRootContainer:o.personaContainer,style:t.opacity?{opacity:t.opacity}:void 0},i.createElement(Ce.a,r.a({},n,{className:t.resolved?o.personaResolved:o.persona})))}var Te=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.styles=void 0,o.cancelDraftButtonKeyDownHandler=o.cancelDraftButtonKeyDownHandler.bind(o),o.cancelDraftButtonClickHandler=o.cancelDraftButtonClickHandler.bind(o),o.styles=Object(ae.b)(),o}return r.d(e,t),e.prototype.cancelDraftButtonClickHandler=function(t){this.props.onCancelDraft(),t.stopPropagation()},e.prototype.cancelDraftButtonKeyDownHandler=function(t){Object(D.c)(t.key)!==D.a.Enter&&Object(D.c)(t.key)!==D.a.Escape||(this.props.onCancelDraft(),c.n()&&(t.stopPropagation(),t.preventDefault()))},e.prototype.renderDraftCancelButton=function(){return i.createElement("div",{className:this.styles.cancelDraft},i.createElement(O.a,{id:Ct.p({id:this.props.id,renderContextType:this.context.renderContextType}),styles:this.styles.iconCancelDraft,disabled:!1,onClick:this.cancelDraftButtonClickHandler,onKeyDown:this.cancelDraftButtonKeyDownHandler,iconProps:{iconName:"CancelGlyph"},title:this.props.localizationAPI.getString(15),ariaLabel:this.props.localizationAPI.getString(46)}))},e.prototype.renderRootPersona=function(){if(0===this.props.rootAuthorOpacity)return null;var t={author:this.props.authorName,resolved:this.props.isResolvedCard,isParent:!0,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL,opacity:this.props.rootAuthorOpacity};return i.createElement(xe,r.a({},t))},e.prototype.renderRootAuthor=function(){if(0===this.props.rootAuthorOpacity)return null;var t={author:this.props.authorName,resolved:this.props.isResolvedCard,renderContextType:this.context.renderContextType};return i.createElement("div",{className:this.styles.headerAuthorContainer,style:{opacity:this.props.rootAuthorOpacity}},i.createElement(be,r.a({},t)))},e.prototype.render=function(){var t=this,e=[];this.props.isDraftCard?e.push(this.renderDraftCancelButton()):(this.props.anchorText&&e.push(i.createElement("div",{id:Ct.b({id:this.props.id,renderContextType:this.context.renderContextType}),className:this.styles.anchor},this.props.anchorText)),this.props.contextMenuProps&&e.push(i.createElement(le,r.a({},this.props.contextMenuProps))));var n=i.Children.map(e,function(e){return i.createElement("div",{className:t.styles.headerItem},e)}),o=1===this.props.rootAuthorOpacity?void 0:{boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, "+.13*(1-this.props.rootAuthorOpacity)+")"};return i.createElement("div",{className:this.styles.headerContainer,style:o},this.renderRootPersona(),this.renderRootAuthor(),n.length?i.createElement("div",{className:this.styles.headerRightCorner},n):void 0)},e.contextTypes=r.a({},de.a),e}(i.PureComponent),Oe=n(636),Se=n(682),Ee=n(304),Pe=n(519),we=function(t){function e(e){var n=t.call(this,e)||this;return n.onClick=n.onClick.bind(n),n}return r.d(e,t),e.prototype.onClick=function(){this.props.onHeaderButtonPressed&&this.props.onHeaderButtonPressed(this.props.id)},e.prototype.render=function(){if(!c.a())return null;if(Object(d.g)().assertConditionTag(1===this.props.assignees.length,"There should be exactly one assignee",595726795),0===this.props.assignees.length)return null;var t=!!this.props.assignees[0].IsCurrentUser,e=Object(Ee.l)(this.props.assignees[0],this.props.localizationAPI),n=Object(Se.c)(this.props.disabled),o=Ct.j({id:this.props.id,renderContextType:this.props.renderContextType});return i.createElement("div",{className:n.taskHeaderContainer,id:Ct.k({id:this.props.id,renderContextType:this.props.renderContextType})},i.createElement(Oe.a,{id:o,componentRef:this.props.taskHeaderCheckboxRef,styles:100!==this.props.completion?t?n.taskHeaderAssignedToYouCheckbox:n.taskHeaderCheckbox:t?n.taskHeaderCompletedAssignedToYouCheckbox:n.taskHeaderCompletedCheckbox,label:e,checked:100===this.props.completion,"data-item-id":this.props.id,onChange:this.onClick,checkmarkIconProps:Pe.b.CHECKMARKICON,disabled:this.props.disabled}))},e}(i.PureComponent),Ie={marginTop:"8px",zIndex:20,width:"32px",maxHeight:"30px",selectors:{"& .ms-Spinner-circle":{borderColor:H.a,borderTopColor:H.b}}},ke=Object(I.b)(function(t){return{commitBar:Object(B.a)({marginBottom:"5px",maxHeight:"30px",display:"flex",flexDirection:"row",flexWrap:"nowrap",overflow:"hidden",justifyContent:"flex-end"}),commitButton:{root:Object(B.a)({background:Object(k.a)().primary,maxHeight:"24px",minWidth:"37px",margin:1,padding:0,borderRadius:U.d,border:"1px solid",color:Object(k.a)().primary,position:"relative",selectors:{".ms-Fabric--isFocusVisible &:focus::after":U.l,".ms-Button-flexContainer":{position:"relative"}}},t&&{transform:"scaleX(-1)"}),rootPressed:{background:Object(k.a)().shade20},rootHovered:Object(B.a)({background:Object(k.a)().shade10},U.k),rootFocused:Object(B.a)({background:Object(k.a)().shade10,color:F.a.GRAY_H,outline:"none",border:"1px dotted"},U.j),rootDisabled:{background:F.a.GRAY_C,color:F.a.GRAY_C},iconDisabled:{color:F.a.GRAY_C},icon:{color:F.a.WHITE,width:"16px",margin:1},iconPressed:{color:F.a.GRAY_J},iconHovered:{color:F.a.GRAY_J}},cancelButton:{root:{background:"#ffffff",maxHeight:"24px",minWidth:"37px",margin:1,marginRight:0,marginLeft:4,padding:0,color:F.a.GRAY_E,borderRadius:U.d,border:"1px solid",borderColor:"#B3B0AD",selectors:{".ms-Fabric--isFocusVisible &:focus::after":U.l,".ms-Button-flexContainer":{position:"relative"}}},rootFocused:Object(B.a)({background:F.a.GRAY_C,color:F.a.GRAY_H,outline:"none",border:"1px dotted"},U.j),rootPressed:{color:F.a.GRAY_J},rootHovered:Object(B.a)({color:F.a.GRAY_J},U.k),iconDisabled:{color:F.a.GRAY_C},icon:{color:F.a.GRAY_F,width:12,height:12,margin:2,marginTop:0,padding:0,border:0,lineHeight:12},iconPressed:{color:F.a.GRAY_J},iconHovered:{color:F.a.GRAY_J}},cancelIcon:{width:16},commitIcon:{width:16,color:"white"}}}),Re=function(t){function e(e){var n=t.call(this,e)||this;return n.state={showLoadingUI:!1},n}return r.d(e,t),e.prototype.setTimer=function(){var t=this;this.timeoutId||(this.timeoutId=setTimeout(function(){t.setState({showLoadingUI:!0}),t.timeoutId=void 0},this.props.delay))},e.prototype.clearTimer=function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)},e.prototype.componentDidMount=function(){this.props.isLoading&&this.setTimer()},e.prototype.componentWillUnmount=function(){this.clearTimer()},e.prototype.componentDidUpdate=function(t){!t.isLoading&&this.props.isLoading?this.setTimer():t.isLoading&&!this.props.isLoading&&(this.clearTimer(),this.setState({showLoadingUI:!1}))},e.prototype.render=function(){return this.state.showLoadingUI?this.props.loadingUI:i.Children.only(this.props.children)},e}(i.Component),Ae=function(t){function e(e){var n=t.call(this,e)||this;return n.generateCommitButton=Object(I.b)(n.generateCommitButton,5),n.state={},c.a()&&Object(Yt.a)().then(function(t){n.setState({taskAssigner:t.TaskAssigner})}),n}return r.d(e,t),e.prototype.render=function(){var t=ke(Object(C.a)());return i.createElement("div",{className:t.commitBar},this.props.taskAssigner&&this.state.taskAssigner?i.createElement(this.state.taskAssigner,r.a({ref:this.props.taskAssignerRef},this.props.taskAssigner)):void 0,this.generateCommitButton(this.props.commit,t.commitButton,t.commitIcon),this.props.cancel?this.generateCommitButton(this.props.cancel,t.cancelButton,t.cancelIcon):void 0)},e.prototype.generateCommitButton=function(t,e,n){var o={id:t.id,disabled:t.disabled,onClick:t.onClick,onKeyDown:t.onKeyDown,ariaLabel:t.accessibilityLabel,title:t.text,tabIndex:t.isTabbable?void 0:-1,iconProps:{iconName:t.iconName,style:n},styles:e};return t.showDelayedSpinner?i.createElement(Re,{delay:U.f,isLoading:!0,loadingUI:i.createElement(P.a,{size:w.a.small,className:Ie})},i.createElement(O.a,r.a({},o))):i.createElement(O.a,r.a({},o))},e}(i.PureComponent),De=Object(I.b)(function(){return{root:{margin:"3px",padding:0,paddingLeft:"7px",paddingRight:"7px",border:"1px transparent",color:F.a.GRAY_E,backgroundColor:"transparent",cursor:"pointer",height:"unset",boxSizing:"border-box",textAlign:"left",minWidth:"30px",maxWidth:166,width:"95%"},rootHovered:U.k,rootFocused:U.j,textContainer:{flexGrow:0,flexShrink:0},flexContainer:{justifyContent:"flex-start"},label:{fontSize:"12px",fontWeight:"600",textAlign:"left",fontFamily:"inherit",lineHeight:"20px",maxWidth:122,margin:0,marginLeft:"5px",marginRight:"10px",padding:0,border:0}}});function je(t){var e=De();return i.createElement(T.a,{componentRef:t.data?Ne:void 0,id:t.id,iconProps:{iconName:t.iconName,style:{width:12,height:12,marginTop:"-4px"}},key:t.key,role:"menuitem",ariaLabel:""+t.name,styles:e,"data-is-focusable":!0,onKeyDown:t.onKeyDown,onClick:t.onClick},t.name)}function Ne(t){t&&t.focus()}var Me=Object(I.b)(function(){return{root:{margin:"12px",marginBottom:"6px",marginTop:"6px",padding:0,border:"1px solid transparent",color:F.a.GRAY_E,backgroundColor:"transparent",cursor:"pointer",maxHeight:"15px",boxSizing:"border-box",minWidth:"30px",selectors:{".ms-Fabric--isFocusVisible &:focus::after":U.l}},textContainer:{flexGrow:0,flexShrink:0},flexContainer:{justifyContent:"flex-end"},label:{fontSize:"11px",fontWeight:"600",textAlign:"right",fontFamily:"inherit",lineHeight:"15px",margin:0,padding:0,border:0},rootHovered:Object(B.a)({color:"#333333",backgroundColor:"transparent"},U.k),rootPressed:{color:"#333333",backgroundColor:"transparent"},rootChecked:{color:"#333333",backgroundColor:"transparent"},rootFocused:Object(B.a)({color:"#333333",padding:0,border:"1px dotted black",outline:"1px dotted transparent"},U.j)}}),_e={display:"flex",overflow:"hidden",marginBottom:"5px",flexDirection:"row",flexShrink:0,color:"#A80000",fontSize:"11px",outline:"none",wordBreak:"break-word"},Be=Object(I.b)(function(){return{card:Object(B.a)(_e,{maxWidth:L.f,marginLeft:"9px",marginRight:"9px",alignSelf:"center"}),post:Object(B.a)(_e,{maxWidth:W,marginRight:8})}}),Le=Object(I.b)(function(){return{card:Object(B.a)(_e,{marginLeft:L.e+11,marginRight:L.e+11}),post:Object(B.a)(_e,{marginLeft:"3px",marginRight:"3px"})}});function Fe(t){if(!c.s()||void 0===t.draftViewState||!t.draftViewState.warningInstanceKey)return null;var e=c.g()?Le():Be(),n=Ee.i(t.localizationAPI),o=t.type===R.Card?e.card:e.post;return i.createElement("div",{"aria-label":n,className:o},n)}var He=n(316),Ue=5,ze=function(t){function e(e,n){var o=t.call(this,e,n)||this;o.taskAssingerRef=i.createRef(),o.rootTabIndexValue=-1,o.preventNextDomFocus=!1,o.contextMenuProps=Object(I.b)(function(t,e,n,r){return{id:Ct.d({id:t,renderContextType:e}),title:o.props.localizationAPI.getString(45),ariaLabel:o.props.localizationAPI.getString(45),onMenuClick:o.onContextMenuInteractionHandler,menuItems:n,tabIndex:r}},Ue),o.fetchReplyButton=Object(I.b)(function(t,e,n,r){switch(t){case g.a.Reply:case g.a.ReplyPreCommitPending:return{button:{id:Ct.J({id:e,renderContextType:n}),iconName:Object(ce.a)(2),isTabbable:!0,disabled:r,onClick:o.sendReplyButtonClickHandler,onKeyDown:o.sendCommentButtonKeyDownHandler,text:o.props.localizationAPI.getString(48),accessibilityLabel:o.props.localizationAPI.getString(49)}};case g.a.ReplyPostCommitPending:return{button:{disabled:!0,iconName:Object(ce.a)(2),text:o.props.localizationAPI.getString(48),accessibilityLabel:o.props.localizationAPI.getString(49),showDelayedSpinner:!0}};case g.a.Draft:case g.a.DraftPreCommitPending:return{button:{id:Ct.J({id:e,renderContextType:n}),iconName:Object(ce.a)(2),isTabbable:!0,disabled:o.state.isSendButtonDisabled,onClick:o.sendReplyButtonClickHandler,onKeyDown:o.sendCommentButtonKeyDownHandler,text:o.props.localizationAPI.getString(48),accessibilityLabel:o.props.localizationAPI.getString(83)}};default:return{button:void 0}}}),o.fetchCancelButton=Object(I.b)(function(t,e,n){switch(t){case g.a.Reply:case g.a.ReplyPreCommitPending:return{button:{id:Ct.H({id:e,renderContextType:n}),iconName:Object(ce.a)(1),isTabbable:!0,disabled:!1,onClick:o.cancelReplyButtonClickHandler,onKeyDown:o.cancelReplyButtonKeyDownHandler,text:o.props.localizationAPI.getString(15),accessibilityLabel:o.props.localizationAPI.getString(47)}};case g.a.ReplyPostCommitPending:return{button:{disabled:!0,iconName:Object(ce.a)(1),text:o.props.localizationAPI.getString(15),accessibilityLabel:o.props.localizationAPI.getString(47)}};default:return{button:void 0}}}),o.getNewTaskAssignees=Object(I.b)(function(t,e){return e?Object(l.e)(t,e.assignees):t}),o.renderPosts=o.renderPosts.bind(o),o.expandButtonHandler=o.expandButtonHandler.bind(o),o.onPost=o.onPost.bind(o),o.onCancel=o.onCancel.bind(o),o.onEditorClick=o.onEditorClick.bind(o),o.onTextChanged=o.onTextChanged.bind(o),o.disableSendButton=o.disableSendButton.bind(o),o.renderContextMenuItem=o.renderContextMenuItem.bind(o),o.cardKeyDownHandler=o.cardKeyDownHandler.bind(o),o.cardClickHandler=o.cardClickHandler.bind(o),o.renderReplyBoxButton=o.renderReplyBoxButton.bind(o),o.renderDraftCancelButton_deprecated=o.renderDraftCancelButton_deprecated.bind(o),o.replyBoxKeyDownHandler_deprecated=o.replyBoxKeyDownHandler_deprecated.bind(o),o.replyBoxKeyDownHandler=o.replyBoxKeyDownHandler.bind(o),o.cancelReplyThenFocus=o.cancelReplyThenFocus.bind(o),o.cancelReplyButtonKeyDownHandler=o.cancelReplyButtonKeyDownHandler.bind(o),o.cancelDraftButtonKeyDownHandler_deprecated=o.cancelDraftButtonKeyDownHandler_deprecated.bind(o),o.sendCommentButtonKeyDownHandler=o.sendCommentButtonKeyDownHandler.bind(o),o.cancelReplyButtonClickHandler=o.cancelReplyButtonClickHandler.bind(o),o.cancelDraftButtonClickHandler_deprecated=o.cancelDraftButtonClickHandler_deprecated.bind(o),o.sendReplyButtonClickHandler=o.sendReplyButtonClickHandler.bind(o),o.expandButtonClickHandler=o.expandButtonClickHandler.bind(o),o.expandButtonKeyDownHandler=o.expandButtonKeyDownHandler.bind(o),o.renderableItemListScrollHandler=o.renderableItemListScrollHandler.bind(o),o.clearDraft=o.clearDraft.bind(o),o.onCardMouseEnter=o.onCardMouseEnter.bind(o),o.onCardMouseLeave=o.onCardMouseLeave.bind(o),o.setCardRef=o.setCardRef.bind(o),o.setReplyBoxRef=o.setReplyBoxRef.bind(o),o.setTaskHeaderCheckboxRef=o.setTaskHeaderCheckboxRef.bind(o),o.onContextMenuInteractionHandler=o.onContextMenuInteractionHandler.bind(o),o.shouldEditorPersistOnUnmount=o.shouldEditorPersistOnUnmount.bind(o),o.editorFocusHandler=o.editorFocusHandler.bind(o),o.editorBlurHandler=o.editorBlurHandler.bind(o),o.editorComponentRef=o.editorComponentRef.bind(o),o.onContextMenuItemMounted=o.onContextMenuItemMounted.bind(o),o.onEditorCommitRequested=o.onEditorCommitRequested.bind(o),o.onEditorEscapeRequested=o.onEditorEscapeRequested.bind(o),o.getContentsAsync=o.getContentsAsync.bind(o),o.getCursorPositionAsync=o.getCursorPositionAsync.bind(o),o.draftHasContent=o.draftHasContent.bind(o),o.renderCommentCardTaskHeader=o.renderCommentCardTaskHeader.bind(o),o.onTaskAssigneeUpdated=o.onTaskAssigneeUpdated.bind(o);var r=o.getMaxHeight();return o.styles=c.g()?Object(L.i)({id:o.props.id,renderContextType:o.context.renderContextType},Object(k.a)().primary,!!o.props.taskHeaderProps,o.props.renderRootPostHeaderOnCard,r):Object(L.h)(Object(C.a)(),{id:o.props.id,renderContextType:o.context.renderContextType},r),o.state={autoDiscardOnCancel:!1,isSendButtonDisabled:!0,menuItems:[],rootAuthorOpacity:1},o.setTabIndex(e),o}return r.d(e,t),e.prototype.getCommentEditorCallbackProps=function(){return{componentRef:this.editorComponentRef,onTextChange:this.onTextChanged,onBlur:this.editorBlurHandler,shouldPersistContentOnUnmount:this.shouldEditorPersistOnUnmount(),onFocus:this.editorFocusHandler}},e.prototype.setCardRef=function(t){this.cardRef=t},e.prototype.setReplyBoxRef=function(t){this.replyBoxRef=t},e.prototype.setTaskHeaderCheckboxRef=function(){this.taskHeaderCheckboxRef=document.getElementById(Ct.j({id:this.props.id,renderContextType:this.context.renderContextType})),this.taskHeaderCheckboxRef&&this.setTabIndex(this.props)},e.prototype.setTabIndex=function(t){t.selected||t.isTabbable?(this.rootTabIndexValue=0,this.taskHeaderCheckboxRef&&(this.taskHeaderCheckboxRef.tabIndex=0)):(this.rootTabIndexValue=-1,this.taskHeaderCheckboxRef&&(this.taskHeaderCheckboxRef.tabIndex=-1))},e.prototype.getInnerElementsTabIndex=function(){return this.props.displayMode===g.a.CardPostCommitPending?-1:this.rootTabIndexValue},e.prototype.getRootTabIndex=function(){return this.rootTabIndexValue},e.prototype.getMaxHeight=function(){return this.props.maximumDimensions&&this.props.maximumDimensions.height?Math.max(this.props.maximumDimensions.height,L.b):void 0},e.prototype.onCardMouseEnter=function(){this.props.onCardHighlight(this)},e.prototype.onCardMouseLeave=function(){this.props.onCardHighlight(void 0)},e.prototype.shouldEditorPersistOnUnmount=function(){return this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending||this.props.displayMode===g.a.Reply||this.props.displayMode===g.a.ReplyPreCommitPending||this.props.displayMode===g.a.Loading},e.prototype.UNSAFE_componentWillMount=function(){this.props.displayMode===g.a.Resolved?this.setState({menuItems:this.generateCommandBarActionItems(this.props.menuItems)}):this.setState({menuItems:this.generateContextMenuItems(this.props.menuItems)})},e.prototype.componentDidMount=function(){He.a.cardDidMount({canFocusIfNonCardIsFocused:!0,ignoreSelectionChangeUnlessContainsSelectionChanges:!1,focusDraftBoxAfterReply:!1,canFocusIfCloseIsFocused:!0,canFocusWhileReplyIsPending:!1,canFocusOnAutoDiscard:!1,ignoreSelectionChangeIfReplySessionRequestPending:!1,shouldFocusCardIfUnselected:!0},this.props,this,this.context),!this.textEditorRef||this.props.displayMode!==g.a.Draft&&this.props.displayMode!==g.a.DraftPreCommitPending||this.textEditorRef.setSelection(0,0),this.lastElementRef_deprecated=c.e()?void 0:document.getElementById(Ct.f({id:this.props.id,renderContextType:this.context.renderContextType}))},e.prototype.UNSAFE_componentWillReceiveProps=function(t){this.props.menuItems!==t.menuItems&&(t.displayMode===g.a.Resolved?this.setState({menuItems:this.generateCommandBarActionItems(t.menuItems)}):this.setState({menuItems:this.generateContextMenuItems(t.menuItems)}))},e.prototype.componentWillUpdate=function(t,e){this.setTabIndex(t)},e.prototype.componentDidUpdate=function(t,e){var n=this.props.displayMode===g.a.Reply||this.props.displayMode===g.a.ReplyPreCommitPending||this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending;this.props.draftViewState&&!n&&Object(d.g)().assertConditionTag(!1,"CardDisplayMode inconsistent with draft warning state",595858956),He.a.cardPropsUpdated({canFocusIfNonCardIsFocused:!0,ignoreSelectionChangeUnlessContainsSelectionChanges:!1,focusDraftBoxAfterReply:!1,canFocusIfCloseIsFocused:!0,canFocusWhileReplyIsPending:!1,canFocusOnAutoDiscard:this.state.autoDiscardOnCancel,ignoreSelectionChangeIfReplySessionRequestPending:!1,shouldFocusCardIfUnselected:!0},t,this.props,this,void 0,this.context),this.setState({autoDiscardOnCancel:!1}),this.props.displayMode!==t.displayMode&&this.props.displayMode!==g.a.Reply&&this.props.displayMode!==g.a.ReplyPreCommitPending&&this.props.displayMode!==g.a.CardPostCommitPending&&this.props.displayMode!==g.a.ReplyPostCommitPending&&this.props.displayMode!==g.a.Draft&&this.props.displayMode!==g.a.DraftPreCommitPending&&this.clearDraft(),this.lastElementRef_deprecated=c.e()?void 0:document.getElementById(Ct.f({id:this.props.id,renderContextType:this.context.renderContextType}))},e.prototype.focus=function(){c.l()?this.props.displayMode!==g.a.ReplySessionRequestPending&&this.cardRef&&this.cardRef.focus():this.preventNextDomFocus?this.preventNextDomFocus=!1:this.cardRef&&this.cardRef.focus()},e.prototype.blur=function(){this.cardRef&&this.cardRef.blur()},e.prototype.getContentsAsync=function(){return this.textEditorRef.getContentsAsync()},e.prototype.getCursorPositionAsync=function(){return this.textEditorRef.getCursorPositionAsync()},e.prototype.draftHasContent=function(){return!this.textEditorRef.isEditorEmpty()},e.prototype.cardKeyDownHandler=function(t){switch(Object(D.c)(t.key)){case D.a.Tab:if(this.props.selected||this.props.hasSelectedChild){if(this.isActiveDraft()){var e=document.getElementById(Ct.J({id:this.props.id,renderContextType:this.context.renderContextType})),n=document.getElementById(Ct.p({id:this.props.id,renderContextType:this.context.renderContextType}));if(this.props.renderRootPostHeaderOnCard){var o=void 0;t.target===e?o=t.shiftKey?this.textEditorRef:n:t.target===n&&(o=t.shiftKey&&!this.textEditorRef.isEditorEmpty()?e:this.textEditorRef),o&&(o.focus(),t.preventDefault())}else t.target===n&&this.textEditorRef&&(t.shiftKey&&!this.textEditorRef.isEditorEmpty()?(e&&e.focus(),t.preventDefault()):(!t.shiftKey||t.shiftKey&&this.textEditorRef.isEditorEmpty())&&(this.textEditorRef.focus(),t.preventDefault()))}else t.target===this.lastElementRef_deprecated&&!t.shiftKey&&this.props.onFocusNextTabStop_deprecated?this.props.onFocusNextTabStop_deprecated()&&t.preventDefault():t.target===this.cardRef&&t.shiftKey&&this.props.onFocusPreviousTabStop_deprecated&&this.props.onFocusPreviousTabStop_deprecated()&&t.preventDefault();t.stopPropagation()}break;case D.a.Escape:this.props.hasSelectedChild&&this.props.onCardSelectExpand(this),t.stopPropagation(),t.preventDefault()}},e.prototype.shouldClickTargetExpandCard=function(t){var e=t.target,n=document.getElementById(Ct.k({id:this.props.id,renderContextType:this.context.renderContextType}));if(n&&n.contains(e))return!1;var o=document.getElementById(Ct.L({id:this.props.id,renderContextType:this.context.renderContextType}));return!o||!o.contains(e)},e.prototype.cardClickHandler=function(t){this.props.hasSelectedChild||this.shouldClickTargetExpandCard(t)&&(this.props.onCardSelectExpand(this),t.stopPropagation())},e.prototype.contextMenuClickHandler=function(t,e){t.onClick(this.props.id,!!this.props.taskHeaderProps),e&&e.stopPropagation()},e.prototype.expandButtonClickHandler=function(t){this.expandButtonHandler(),t.stopPropagation()},e.prototype.expandButtonKeyDownHandler=function(t){Object(D.c)(t.key)===D.a.Enter&&(this.expandButtonHandler(),t.stopPropagation())},e.prototype.renderableItemListScrollHandler=function(t){var e=t.target;if(e.id===Ct.G({id:this.props.id,renderContextType:this.context.renderContextType})){var n=e.scrollTop;this.setState({rootAuthorOpacity:n>L.d?0:(L.d-n)/L.d})}},e.prototype.onTextChanged=function(){this.setState({isSendButtonDisabled:this.disableSendButton()})},e.prototype.expandButtonHandler=function(){c.o()&&this.focus(),this.props.onCardSelectExpand(this)},e.prototype.onPost=function(){this.props.onPost(this)},e.prototype.onCancel=function(){this.props.onCancel(this)},e.prototype.onTaskAssigneeUpdated=function(t){this.props.onSelectedTaskAssigneeUpdated(t)},e.prototype.onEditorClick=function(t){c.l()?this.props.displayMode===g.a.Normal&&this.props.onEditorFocus(this):this.props.displayMode!==g.a.Normal&&this.props.displayMode!==g.a.ReplySessionRequestPending||(this.preventNextDomFocus=!this.props.selected,this.props.onEditorFocus(this)),t.stopPropagation()},e.prototype.disableSendButton=function(){return!!this.textEditorRef&&this.textEditorRef.isEditorEmpty()},e.prototype.renderCardSideBar=function(){if(!this.props.restrictActionControls||this.props.highlightCard||this.props.selected||this.props.hasSelectedChild){var t=Ct.i({id:this.props.id,renderContextType:this.context.renderContextType});return i.createElement("div",{id:t,className:this.styles.cardSideBar,tabIndex:-1,"aria-hidden":"true"})}},e.prototype.generateCommandBarActionItems=function(t){var e=this,n=[];return t&&t.length>0&&(n=t.map(function(n,o){return{id:c.e()||o!==t.length-1?Ct.c({id:e.props.id,renderContextType:e.context.renderContextType},n.text):Ct.f({id:e.props.id,renderContextType:e.context.renderContextType}),text:n.text,accessibilityLabel:""+n.text,onClick:e.contextMenuClickHandler.bind(e,n),iconName:n.iconName}})),n},e.prototype.renderResolvedCommandBar=function(){if(this.props.menuItems&&this.props.menuItems.length>0&&this.state.menuItems.length>0){var t=[];return j(this.state.menuItems)?t=this.state.menuItems:Object(d.g)().assertConditionTag(!j(this.state.menuItems),"Card in Resolved display mode and menuItems is not of type CommentButtonProps",595981059),i.createElement(ie,{isTabbable:this.props.isTabbable,disableActions:this.props.restrictActionControls,actions:t})}return null},e.prototype.onContextMenuItemMounted=function(t){t&&t.focus()},e.prototype.onContextMenuItemKeyDownHandler=function(t,e,n){if(Object(D.c)(n.key)===D.a.ArrowDown&&0===e){var o=t.key||t.text||"MissingKey",r=document.getElementById(Ct.o({id:this.props.id,renderContextType:this.context.renderContextType},o));if(n.target===r&&this.props.menuItems&&this.props.menuItems.length>1){var i=this.props.menuItems[1].key||this.props.menuItems[1].text,a=document.getElementById(Ct.o({id:this.props.id,renderContextType:this.context.renderContextType},i));a&&(a.focus(),n.preventDefault(),n.stopPropagation())}}else Object(D.c)(n.key)===D.a.Tab&&(n.preventDefault(),n.stopPropagation())},e.prototype.onContextMenuItemKeyDownHandler_deprecated=function(t,e){if(Object(D.c)(e.key)===D.a.ArrowDown&&t.data){var n=t.key||t.text||"MissingKey",o=document.getElementById(Ct.o({id:this.props.id,renderContextType:this.context.renderContextType},n));if(e.target===o&&this.props.menuItems&&this.props.menuItems.length>1){var r=this.props.menuItems[1].key||this.props.menuItems[1].text,i=document.getElementById(Ct.o({id:this.props.id,renderContextType:this.context.renderContextType},r));i&&(i.focus(),e.preventDefault(),e.stopPropagation())}}else Object(D.c)(e.key)===D.a.Tab&&(e.preventDefault(),e.stopPropagation())},e.prototype.renderContextMenuItem=function(t){if(c.g())return i.createElement(je,r.a({},t));var e=Me();return i.createElement(T.a,{componentRef:t.data?this.onContextMenuItemMounted:void 0,id:Ct.o({id:this.props.id,renderContextType:this.context.renderContextType},t.key),key:t.key,role:"menuitem",ariaLabel:""+t.name,styles:e,"data-is-focusable":!0,onKeyDown:this.onContextMenuItemKeyDownHandler_deprecated.bind(this,t),onClick:t.onClick},t.name)},e.prototype.onContextMenuInteractionHandler=function(t){t&&Object(D.c)(t.key)===D.a.ArrowDown&&t.preventDefault()},e.prototype.generateContextMenuItems=function(t){var e=this,n=[];return t&&t.length>0&&(n=t.map(function(t,n){return{id:Ct.o({id:e.props.id,renderContextType:e.context.renderContextType},t.key||t.text),key:t.key||t.text,iconName:t.iconName,name:t.text,data:0===n,className:e.styles.menuItem,onClick:e.contextMenuClickHandler.bind(e,t),onKeyDown:e.onContextMenuItemKeyDownHandler.bind(e,t,n),onRender:e.renderContextMenuItem}})),n},e.prototype.getContextMenuItems=function(){if(!(!this.props.menuItems||0===this.props.menuItems.length||0===this.state.menuItems.length||this.props.restrictActionControls||this.props.displayMode===g.a.Resolved||this.props.displayMode===g.a.ReadOnly||this.props.renderRootPostHeaderOnCard&&this.props.displayMode===g.a.CardPostCommitPending)){var t=[];return j(this.state.menuItems)?Object(d.g)().assertConditionTag(this.props.displayMode===g.a.CardPostCommitPending,"Card not in Pending display mode and menuItems is not of type IContextualMenuItem",595981060):t=this.state.menuItems,t}},e.prototype.renderContextMenu_deprecated=function(){var t=this.getContextMenuItems();return t?c.g()?i.createElement(le,r.a({},this.contextMenuProps(this.props.id,this.context.renderContextType,t,this.getInnerElementsTabIndex()))):i.createElement(O.a,{id:Ct.d({id:this.props.id,renderContextType:this.context.renderContextType}),title:this.props.localizationAPI.getString(45),ariaLabel:this.props.localizationAPI.getString(45),styles:this.styles.iconContextMenuAnchor,onMenuClick:this.onContextMenuInteractionHandler,menuProps:{ariaLabel:this.props.localizationAPI.getString(45),className:this.styles.contextMenu,directionalHint:S.DirectionalHint.bottomRightEdge,gapSpace:2,isBeakVisible:!1,shouldFocusOnMount:!1,calloutProps:{preventDismissOnScroll:!1,styles:L.g,finalHeight:1},items:t},menuIconProps:{iconName:"HintBarEllipses_16",style:{width:16}},tabIndex:this.getInnerElementsTabIndex()}):null},e.prototype.getDraftWarningProps=function(){return{localizationAPI:this.props.localizationAPI,draftViewState:this.props.draftViewState,renderContextType:this.context.renderContextType,type:R.Card}},e.prototype.renderCardHeader=function(){var t=this;if(this.props.renderRootPostHeaderOnCard){var e=this.getContextMenuItems(),n={id:this.props.id,authorName:this.props.authorName,authorIdentity:this.props.authorIdentity,authorEmail:this.props.authorEmail,appAuthorId:this.props.appAuthorId,authorContextId:this.props.authorContextId,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL,anchorText:this.props.anchorText,contextMenuProps:e?this.contextMenuProps(this.props.id,this.context.renderContextType,e,this.getInnerElementsTabIndex()):void 0,isResolvedCard:this.props.displayMode===g.a.Resolved,isDraftCard:this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending,localizationAPI:this.props.localizationAPI,onCancelDraft:this.onCancel,rootAuthorOpacity:this.state.rootAuthorOpacity};return i.createElement(Te,r.a({},n))}var o=[];this.props.anchorText&&o.push(i.createElement("div",{id:Ct.b({id:this.props.id,renderContextType:this.context.renderContextType}),className:this.styles.anchor_deprecated},this.props.anchorText)),o.push(this.renderContextMenu_deprecated());var a=i.Children.map(o,function(e){return i.createElement("div",{className:t.styles.headerItem_deprecated},e)});if(a.length)return i.createElement("div",{className:this.styles.headerContainer_deprecated},a)},e.prototype.renderPosts=function(){var t,e,n=this.props.children,o=0;n&&(o=n.constructor===Array?n.length:1),o>1?(t=n[0],e=n[o-1]):1===o&&(t=n);var r=[],a=0;if(this.props.children&&o>2)for(var s=1;s<o-1;++s)r.push(this.props.children[s]),++a,r.push(i.createElement("div",{key:"divider"+a,className:this.styles.dividerLine}));return o>2&&this.props.cardCollapsedState===y.a.Collapsed?i.createElement("div",{id:Ct.G({id:this.props.id,renderContextType:this.context.renderContextType}),onClick:this.expandButtonClickHandler,className:this.styles.renderableItemList,role:"group","aria-expanded":!1,tabIndex:-1,onKeyDown:this.expandButtonKeyDownHandler,onScroll:this.renderableItemListScrollHandler},t,i.createElement("div",{key:"dividerRoot",className:this.styles.dividerLine}),i.createElement(T.a,{"aria-label":Ee.m(this.props.localizationAPI,o),styles:this.props.restrictActionControls?this.styles.overflowTextContainerRestrictFocus:this.styles.overflowTextContainerDefault,tabIndex:this.getInnerElementsTabIndex(),onClick:this.expandButtonClickHandler,onKeyDown:this.expandButtonKeyDownHandler,id:Ct.O({id:this.props.id,renderContextType:this.context.renderContextType}),text:Ee.m(this.props.localizationAPI,o)}),i.createElement("div",{key:"dividerOverflow",className:this.styles.dividerLine}),e,i.createElement("div",{key:"dividerLast",className:this.styles.dividerLine})):o>2&&this.props.cardCollapsedState===y.a.Expanded?i.createElement("div",{id:Ct.G({id:this.props.id,renderContextType:this.context.renderContextType}),className:this.styles.renderableItemList,role:"group","aria-expanded":!0,tabIndex:-1,onScroll:this.renderableItemListScrollHandler},t,i.createElement("div",{key:"dividerRoot",className:this.styles.dividerLine}),r,e,i.createElement("div",{key:"dividerLast",className:this.styles.dividerLine})):i.createElement("div",{id:Ct.G({id:this.props.id,renderContextType:this.context.renderContextType}),className:this.styles.renderableItemList,role:"group",onScroll:this.renderableItemListScrollHandler},t,i.createElement("div",{key:"dividerRoot",className:this.styles.dividerLine}),e,void 0!==e?i.createElement("div",{key:"dividerLast",className:this.styles.dividerLine}):void 0)},e.prototype.clearDraft=function(){this.textEditorRef&&this.textEditorRef.clear()},e.prototype.replyBoxKeyDownHandler_deprecated=function(t){if(Object(D.c)(t.key)===D.a.Enter||32===t.which)this.props.displayMode!==g.a.Normal&&this.props.displayMode!==g.a.ReplySessionRequestPending||this.props.onEditorFocus(this),t.target===this.replyBoxRef&&t.preventDefault(),t.stopPropagation();else if(Object(D.c)(t.key)===D.a.Tab)if(this.props.displayMode===g.a.Reply||this.props.displayMode===g.a.ReplyPreCommitPending){var e=document.getElementById(Ct.J({id:this.props.id,renderContextType:this.context.renderContextType})),n=document.getElementById(Ct.H({id:this.props.id,renderContextType:this.context.renderContextType}));t.target===n&&!t.shiftKey&&this.textEditorRef?(this.textEditorRef.focus(),t.preventDefault(),t.stopPropagation()):t.target!==e&&t.target!==n&&(t.shiftKey||!t.shiftKey&&this.textEditorRef.isEditorEmpty()?n&&n.focus():e&&e.focus(),t.preventDefault(),t.stopPropagation())}else if(this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending){e=document.getElementById(Ct.J({id:this.props.id,renderContextType:this.context.renderContextType})),n=document.getElementById(Ct.p({id:this.props.id,renderContextType:this.context.renderContextType}));t.target===e?t.shiftKey||(n&&n.focus(),t.preventDefault()):t.target!==n&&t.target!==e&&(t.shiftKey||!t.shiftKey&&this.textEditorRef.isEditorEmpty())?(n&&n.focus(),t.preventDefault()):t.target===n&&t.shiftKey&&this.textEditorRef.isEditorEmpty()?(this.textEditorRef.focus(),t.preventDefault()):(e&&e.focus(),t.preventDefault()),t.stopPropagation()}},e.prototype.replyBoxKeyDownHandler=function(t){if(Object(D.c)(t.key)===D.a.Enter||32===t.which)this.props.displayMode!==g.a.Normal&&this.props.displayMode!==g.a.ReplySessionRequestPending||this.props.onEditorFocus(this),t.target===this.replyBoxRef&&t.preventDefault(),t.stopPropagation();else if(Object(D.c)(t.key)===D.a.Tab){var e=this.isActiveReply();if(this.isActiveDraft()||e){var n=document.getElementById(Ct.J({id:this.props.id,renderContextType:this.context.renderContextType})),o=e?document.getElementById(Ct.H({id:this.props.id,renderContextType:this.context.renderContextType})):document.getElementById(Ct.p({id:this.props.id,renderContextType:this.context.renderContextType})),r=document.getElementById(Ct.K({id:this.props.id,renderContextType:this.context.renderContextType}));t.shiftKey||!t.shiftKey&&this.textEditorRef.isEditorEmpty()?o&&o.focus():c.a()&&r?r.focus():n&&n.focus(),t.preventDefault(),t.stopPropagation()}}},e.prototype.sendCommentButtonKeyDownHandler=function(t){Object(D.c)(t.key)===D.a.Enter?this.onPost():Object(D.c)(t.key)===D.a.Escape&&this.cancelReplyThenFocus()},e.prototype.cancelReplyButtonKeyDownHandler=function(t){Object(D.c)(t.key)!==D.a.Enter&&Object(D.c)(t.key)!==D.a.Escape||this.cancelReplyThenFocus(),Object(D.c)(t.key)===D.a.Tab&&!t.shiftKey&&c.g()&&this.textEditorRef&&(this.textEditorRef.focus(),t.preventDefault(),t.stopPropagation())},e.prototype.cancelDraftButtonKeyDownHandler_deprecated=function(t){Object(D.c)(t.key)!==D.a.Enter&&Object(D.c)(t.key)!==D.a.Escape||(this.onCancel(),c.n()&&(t.stopPropagation(),t.preventDefault()))},e.prototype.sendReplyButtonClickHandler=function(t){this.onPost(),t.stopPropagation()},e.prototype.cancelReplyButtonClickHandler=function(t){this.cancelReplyThenFocus(),t.stopPropagation()},e.prototype.cancelDraftButtonClickHandler_deprecated=function(t){this.onCancel(),t.stopPropagation()},e.prototype.cancelReplyThenFocus=function(){this.onCancel();var t=document.getElementById(Ct.h({id:this.props.id,renderContextType:this.context.renderContextType},!1));t&&t.focus()},e.prototype.onEditorCommitRequested=function(){this.onPost()},e.prototype.onEditorEscapeRequested=function(){this.cancelReplyThenFocus()},e.prototype.editorFocusHandler=function(){this.props.displayMode!==g.a.Draft&&this.props.displayMode!==g.a.Reply&&this.props.displayMode!==g.a.DraftPreCommitPending&&this.props.displayMode!==g.a.ReplyPreCommitPending&&this.props.onEditorFocus(this)},e.prototype.editorBlurHandler=function(t,e){c.y()&&e&&Ct.H({id:this.props.id,renderContextType:this.context.renderContextType})===e&&this.setState({autoDiscardOnCancel:!0}),this.props.onEditorBlur(this)},e.prototype.editorComponentRef=function(t){this.textEditorRef=t},e.prototype.renderCommentEditor=function(t){var e=Ee.b(this.props.displayMode,this.props.localizationAPI),n=r.a({id:Ct.e({id:this.props.id,renderContextType:this.context.renderContextType}),contentManagerId:Ct.m(this.props.id),accessibilityLabel:e},this.getCommentEditorCallbackProps(),{displayMode:A.Disabled,useReplyBoxStyling:!0,isHeightBounded:!!this.getMaxHeight(),placeholder:Ee.d(this.props.localizationAPI,this.props.supportsAtMentions,this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending,this.props.cardRelativeDraftingState)});return t||(n=r.a({},n,{displayMode:A.Editing,onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.onEditorEscapeRequested,initialDraftContent:this.props.draftViewState?this.props.draftViewState.initialDraftContent:void 0})),this.props.supportsAtMentions&&this.props.mentionEditorProps?i.createElement(Zt,r.a({},n,this.props.mentionEditorProps)):i.createElement(Wt,n)},e.prototype.renderDraftCancelButton_deprecated=function(){return i.createElement("div",{className:this.styles.cancelDraft_deprecated},i.createElement(O.a,{id:Ct.p({id:this.props.id,renderContextType:this.context.renderContextType}),styles:this.styles.iconCancelDraft_deprecated,disabled:!1,onClick:this.cancelDraftButtonClickHandler_deprecated,onKeyDown:this.cancelDraftButtonKeyDownHandler_deprecated,iconProps:{iconName:"CancelGlyph"},title:this.props.localizationAPI.getString(15),ariaLabel:this.props.localizationAPI.getString(46)}))},e.prototype.renderReplyCommitPendingButton=function(){return i.createElement("div",{className:this.styles.replyBoxButtons},i.createElement(Re,{delay:U.f,isLoading:!0,loadingUI:i.createElement(P.a,{size:w.a.small,className:this.styles.replySpinnerContainer})},i.createElement(O.a,{disabled:!0,styles:this.styles.iconSend,iconProps:{iconName:c.g()?"Send2_Fluent":"Send2_16",style:{width:16}},title:this.props.localizationAPI.getString(48),ariaLabel:this.props.localizationAPI.getString(49)})),i.createElement("div",{className:this.styles.separatorLine}),i.createElement(O.a,{disabled:!0,styles:this.styles.iconCancelReply,iconProps:{iconName:"CancelGlyph"},title:this.props.localizationAPI.getString(15),ariaLabel:this.props.localizationAPI.getString(47)}))},e.prototype.renderNormalCardReplyBoxButton=function(){return i.createElement("div",{className:this.styles.replyBoxButtons},i.createElement(O.a,{id:Ct.J({id:this.props.id,renderContextType:this.context.renderContextType}),styles:this.styles.iconSend,tabIndex:0,disabled:this.state.isSendButtonDisabled,onClick:this.sendReplyButtonClickHandler,onKeyDown:this.sendCommentButtonKeyDownHandler,iconProps:{iconName:"Send2_16",style:{width:16}},title:this.props.localizationAPI.getString(48),ariaLabel:this.props.localizationAPI.getString(49)}),i.createElement("div",{className:this.styles.separatorLine}),i.createElement(O.a,{id:Ct.H({id:this.props.id,renderContextType:this.context.renderContextType}),disabled:!1,styles:this.styles.iconCancelReply,tabIndex:0,onClick:this.cancelReplyButtonClickHandler,onKeyDown:this.cancelReplyButtonKeyDownHandler,iconProps:{iconName:"CancelGlyph"},title:this.props.localizationAPI.getString(15),ariaLabel:this.props.localizationAPI.getString(47)}))},e.prototype.renderDraftCardReplyBoxButton=function(){return i.createElement("div",{className:this.styles.draftBoxButtons},i.createElement(O.a,{id:Ct.J({id:this.props.id,renderContextType:this.context.renderContextType}),styles:this.styles.iconSend,disabled:this.state.isSendButtonDisabled,onClick:this.sendReplyButtonClickHandler,onKeyDown:this.sendCommentButtonKeyDownHandler,iconProps:{iconName:"Send2_16",style:{width:16}},title:this.props.localizationAPI.getString(48),ariaLabel:this.props.localizationAPI.getString(83)}))},e.prototype.renderReplyBoxButton=function(){if(c.g()){var t=this.fetchReplyButton(this.props.displayMode,this.props.id,this.context.renderContextType,this.state.isSendButtonDisabled).button,e=this.fetchCancelButton(this.props.displayMode,this.props.id,this.context.renderContextType).button;if(!t)return;return this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending?i.createElement(Ae,{taskAssigner:this.getTaskAssignerProps(),taskAssignerRef:this.taskAssingerRef,commit:t}):i.createElement(Ae,{taskAssigner:this.getTaskAssignerProps(),taskAssignerRef:this.taskAssingerRef,commit:t,cancel:e})}switch(this.props.displayMode){case g.a.Draft:case g.a.DraftPreCommitPending:return this.renderDraftCardReplyBoxButton();case g.a.Reply:case g.a.ReplyPreCommitPending:return this.renderNormalCardReplyBoxButton();case g.a.ReplyPostCommitPending:return this.renderReplyCommitPendingButton();default:return}},e.prototype.renderReplyBox=function(){var t=this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending,e=this.props.displayMode===g.a.Reply||this.props.displayMode===g.a.ReplyPreCommitPending,n=this.props.displayMode===g.a.ReplyPostCommitPending||this.props.displayMode===g.a.CardPostCommitPending,o=e||t||n,r=!e&&!t;return i.createElement("div",{className:this.styles.replyBoxContainer,style:{position:"relative"},tabIndex:-1},i.createElement("div",{id:Ct.g({id:this.props.id,renderContextType:this.context.renderContextType}),ref:this.setReplyBoxRef,"aria-describedby":Ct.I({id:this.props.id,renderContextType:this.context.renderContextType}),role:o?"group":"button","aria-label":Ee.d(this.props.localizationAPI,this.props.supportsAtMentions,t,this.props.cardRelativeDraftingState),className:this.props.restrictActionControls?this.styles.replyBoxRestrictFocus:this.styles.replyBoxDefault,onClick:this.onEditorClick,onKeyDown:c.g()?this.replyBoxKeyDownHandler:this.replyBoxKeyDownHandler_deprecated,tabIndex:this.props.displayMode===g.a.ReplyPostCommitPending?-1:this.getInnerElementsTabIndex()},this.renderCommentEditor(r),o&&!c.g()?this.renderReplyBoxButton():void 0,i.createElement("div",{className:this.styles.cardOverlay,style:this.props.displayMode===g.a.ReplyPostCommitPending?{display:"inline"}:{display:"none"}})),o&&c.g()?i.createElement("div",null," ",this.renderReplyBoxButton()," "):void 0,i.createElement("div",{id:Ct.I({id:this.props.id,renderContextType:this.context.renderContextType}),style:{display:"none"},tabIndex:-1},this.props.localizationAPI.getString(55)))},e.prototype.getTaskAssignerProps=function(){if(c.a()){var t=this.props.displayMode===g.a.Draft,e=this.props.displayMode===g.a.Reply&&this.props.taskHeaderProps;if((t||e)&&this.props.draftViewState&&this.props.draftViewState.currentMentionees&&this.props.draftViewState.currentMentionees.length>0){var n=t?Ee.j(this.props.localizationAPI):Ee.k(this.props.localizationAPI),o=this.getNewTaskAssignees(this.props.draftViewState.currentMentionees,this.props.taskHeaderProps),r=this.props.localizationAPI.getString(128);if(o.length>0)return{renderContextType:this.context.renderContextType,id:this.props.id,label:n,assignees:o,selectedAssignee:this.props.draftViewState.selectedTaskAssignee,onSelectedTaskAssigneeUpdated:this.onTaskAssigneeUpdated,pickerAriaLabel:r}}}},e.prototype.renderCommentCardTaskHeader=function(){if(this.props.taskHeaderProps)return i.createElement(we,r.a({},this.props.taskHeaderProps,{disabled:this.props.restrictActionControls,taskHeaderCheckboxRef:this.setTaskHeaderCheckboxRef}))},e.prototype.shouldDisableFocusTrapZone=function(){return!this.isActiveReply()&&!this.isActiveDraft()},e.prototype.isActiveReply=function(){return this.props.displayMode===g.a.Reply||this.props.displayMode===g.a.ReplyPreCommitPending},e.prototype.isActiveDraft=function(){return this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending},e.prototype.renderCard=function(){var t=this.styles.cardContainer,e=this.styles.cardInnerContainer,n=this.styles.cardBody;this.props.selected||this.props.hasSelectedChild?t=this.styles.cardContainerSelect:this.props.highlightCard&&(t=this.styles.cardContainerHover);var o={id:Ct.h({id:this.props.id,renderContextType:this.context.renderContextType},this.props.isNewThread),role:"treeitem",className:t,tabIndex:this.getRootTabIndex(),onKeyDown:this.cardKeyDownHandler,ref:this.setCardRef},a={"aria-label":this.props.accessibilityLabel,"aria-expanded":this.props.cardCollapsedState===y.a.Expanded,"aria-selected":this.props.selected||this.props.hasSelectedChild,"aria-level":1,"aria-owns":Ct.G({id:this.props.id,renderContextType:this.context.renderContextType})},s=c.g();return this.props.displayMode===g.a.Loading?i.createElement("div",r.a({"aria-label":this.props.accessibilityLabel},o),i.createElement("div",{className:this.styles.cardPlaceholder},i.createElement("div",{className:this.styles.cardOverlay},i.createElement(x.a,{delay:U.f},i.createElement(P.a,{className:this.styles.cardSpinner,size:w.a.large}))))):this.props.displayMode===g.a.Draft||this.props.displayMode===g.a.DraftPreCommitPending?i.createElement("div",r.a({onClick:this.cardClickHandler},o,a),this.renderCommentCardTaskHeader(),this.props.renderRootPostHeaderOnCard?this.renderCardHeader():void 0,i.createElement("div",{className:e},i.createElement("div",{className:n,tabIndex:-1},s?this.renderCardSideBar():void 0,this.renderPosts(),this.renderReplyBox(),i.createElement(Fe,r.a({},this.getDraftWarningProps())),s?void 0:this.renderCardSideBar()),this.props.renderRootPostHeaderOnCard?void 0:this.renderDraftCancelButton_deprecated())):this.props.displayMode===g.a.Resolved?i.createElement("div",r.a({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},o,a),this.renderCommentCardTaskHeader(),this.props.renderRootPostHeaderOnCard?this.renderCardHeader():void 0,i.createElement("div",{className:e},i.createElement("div",{className:n,tabIndex:-1},s?this.renderCardSideBar():void 0,this.renderPosts(),this.renderResolvedCommandBar(),s?void 0:this.renderCardSideBar()),this.props.renderRootPostHeaderOnCard?void 0:this.renderCardHeader())):this.props.displayMode===g.a.ReadOnly?i.createElement("div",r.a({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},o,a),this.renderCommentCardTaskHeader(),this.props.renderRootPostHeaderOnCard?this.renderCardHeader():void 0,i.createElement("div",{className:e},i.createElement("div",{className:n,tabIndex:-1},s?this.renderCardSideBar():void 0,this.renderPosts(),s?void 0:this.renderCardSideBar()),this.props.renderRootPostHeaderOnCard?void 0:this.renderCardHeader())):this.props.displayMode===g.a.CardPostCommitPending?i.createElement("div",r.a({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},o,a),this.renderCommentCardTaskHeader(),this.props.renderRootPostHeaderOnCard?this.renderCardHeader():void 0,i.createElement("div",{className:e},i.createElement("div",{className:this.styles.cardBody,tabIndex:-1},s?this.renderCardSideBar():void 0,this.renderPosts(),this.renderReplyBox(),s?void 0:this.renderCardSideBar(),i.createElement("div",{className:this.styles.cardOverlay},i.createElement(x.a,{delay:U.f},i.createElement(P.a,{className:this.styles.cardSpinner,size:w.a.large})))),this.props.renderRootPostHeaderOnCard?void 0:this.renderCardHeader())):i.createElement("div",r.a({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},o,a),this.renderCommentCardTaskHeader(),this.props.renderRootPostHeaderOnCard?this.renderCardHeader():void 0,i.createElement("div",{className:e},i.createElement("div",{className:n,tabIndex:-1},s?this.renderCardSideBar():void 0,this.renderPosts(),this.renderReplyBox(),i.createElement(Fe,r.a({},this.getDraftWarningProps())),s?void 0:this.renderCardSideBar()),this.props.renderRootPostHeaderOnCard?void 0:this.renderCardHeader()))},e.prototype.render=function(){return c.J()?i.createElement(E.a,{className:this.styles.commentCardFocusTrapZone,disabled:this.shouldDisableFocusTrapZone(),disableFirstFocus:!0,forceFocusInsideTrap:!1,ignoreExternalFocusing:!0,isClickableOutsideFocusTrap:!0},this.renderCard()):this.renderCard()},e.contextTypes=r.a({},de.a),e}($t),Ve=n(289),qe=n(314),Ke=Object(I.b)(function(){return{root:{maxHeight:"12px",marginLeft:"6px",padding:0,color:F.a.GRAY_E,fontSize:"11px",fontWeight:"600",fontFamily:"inherit",lineHeight:1.4,border:"1px solid transparent",selectors:{".ms-Fabric--isFocusVisible &:focus::after":U.l}},rootHovered:Object(B.a)({color:"#333333"},U.k),rootFocused:Object(B.a)({color:"#333333",outline:"none",border:"1px dotted"},U.j)}}),Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(){var t=this,e=Ke(),n={id:this.props.id,disabled:this.props.disabled,onClick:function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick()},ariaLabel:this.props.accessibilityLabel,tabIndex:this.props.isTabbable?void 0:-1};return i.createElement(qe.a,r.a({},n,{styles:e}),this.props.text)},e}(i.PureComponent),We=function(t){function e(e){var n=t.call(this,e)||this;return n.state={content:[]},n}return r.d(e,t),e.prototype.UNSAFE_componentWillMount=function(){this.setState({content:this.generateRenderedContent(this.props.actions)})},e.prototype.UNSAFE_componentWillReceiveProps=function(t){t.actions!==this.props.actions&&this.setState({content:this.generateRenderedContent(t.actions)})},e.prototype.generateRenderedContent=function(t){return t.map(function(t,e){return i.createElement(Ge,r.a({key:e},t))})},e.prototype.render=function(){return this.props.isVisible?i.createElement("div",null,this.state.content):i.createElement("div",{tabIndex:-1})},e}(i.PureComponent),Ye=function(t){function e(e,n){return t.call(this,e,n)||this}return r.d(e,t),e.prototype.componentWillUnmount=function(){this.props.onSaveDraft&&this.props.postDisplayMode===v.a.Editing&&this.props.onSaveDraft(this)},e.prototype.setContents=function(t){this.textEditorRef&&this.textEditorRef.setContents(t)},e.prototype.getContentsAsync=function(){return this.textEditorRef?this.textEditorRef.getContentsAsync():Promise.resolve("")},e.prototype.getCursorPositionAsync=function(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():Promise.resolve(void 0)},e.prototype.getId=function(){return this.props.id},e.prototype.getActionBarItemsAsButtonProps=function(t){var e=this,n=[];return t.actionBarItems.forEach(function(o,r){n.push({id:Object(Ct.a)({id:t.id,renderContextType:e.context.renderContextType},r),iconName:o.iconName,text:o.text,accessibilityLabel:o.accessibilityLabel,onClick:function(){o.onClick(e)},isTabbable:t.selected})}),n},e.contextTypes=r.a({},bt.a,de.a),e}(i.PureComponent),Qe=n(301),Je=n(135),Xe=Object(I.b)(function(){return{container:Object(B.a)({display:"flex",direction:"inherit",overflow:"hidden",flexDirection:"row",flexWrap:"nowrap",margin:0,border:0,position:"relative"}),body:Object(B.a)({fontFamily:"inherit",color:F.a.TASK_BLACK,fontWeight:"normal",fontSize:"12px",lineHeight:"16px",marginLeft:"3px",userSelect:"text",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),icon:Object(B.a)({color:F.a.TASK_BLACK,fontSize:"12px",lineHeight:"16px",marginRight:"3px"})}});function Ze(t){if(!c.a())return null;var e=function(t){switch(t){case Je.a.Assign:case Je.a.Reassign:return"Forward";case Je.a.Complete:return"CheckMark";case Je.a.Reopen:return"Undo";case Je.a.Schedule:return"Edit";case Je.a.Delete:return"Cancel";default:return}}(t.icon),n=Xe();return i.createElement("div",null,i.createElement("div",{className:n.container},e&&i.createElement(Qe.a,{iconName:e,className:n.icon}),i.createElement("div",{className:n.body},t.description)))}var $e=Object(I.b)(function(){return{itemFocusBar:Object(B.a)({position:"absolute",left:2,top:0,right:0,bottom:0,width:1,backgroundColor:"transparent",display:"none",outline:"none"})}});function tn(t){var e=$e();return i.createElement("div",{id:t.id,className:[e.itemFocusBar,t.id].join(" "),tabIndex:-1,"aria-hidden":"true"})}var en=Object(I.b)(function(){return{body:Object(B.a)({fontFamily:"inherit",color:F.a.GRAY_E,fontWeight:"normal",fontSize:"11px",lineHeight:18,marginLeft:"3px",userSelect:"text"})}});function nn(t){var e=en();return i.createElement("div",{className:e.body,id:t.id},t.timestamp)}var on=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.tabIndexValue=-1,o.state={hover:!1,actionBarItems:[],menuItems:[]},o.setTabIndex(e),o.postFocusHandler=o.postFocusHandler.bind(o),o.postClickHandler=o.postClickHandler.bind(o),o.renderCommentEditor=o.renderCommentEditor.bind(o),o.commitHandler=o.commitHandler.bind(o),o.commentEditorKeyDownHandler=o.commentEditorKeyDownHandler.bind(o),o.cancelHandler=o.cancelHandler.bind(o),o.editorComponentRef=o.editorComponentRef.bind(o),o.postEditingKeyDownHandler=o.postEditingKeyDownHandler.bind(o),o.shouldEditorPersistOnUnmount=o.shouldEditorPersistOnUnmount.bind(o),o.onMouseLeavePost=o.onMouseLeavePost.bind(o),o.onMouseOverPost=o.onMouseOverPost.bind(o),o.setPostRef=o.setPostRef.bind(o),o.onEditorCommitRequested=o.onEditorCommitRequested.bind(o),o.onEditorEscapeRequested=o.onEditorEscapeRequested.bind(o),o.renderContextMenuItem=o.renderContextMenuItem.bind(o),o.onContextMenuInteractionHandler=o.onContextMenuInteractionHandler.bind(o),o.trySelectPost=o.trySelectPost.bind(o),o.styles=c.g()?nt(!!o.props.hidePostHeader):et(),o.defaultEditorProps=o.getDefaultEditorProps(),o}return r.d(e,t),e.prototype.getDefaultEditorProps=function(){var t=Ee.h(this.props.postDisplayMode,this.props.localizationAPI);return r.a({id:Ct.A({id:this.props.id,renderContextType:this.context.renderContextType}),contentManagerId:Ct.n(this.props.id),localizedEllipsis:this.props.localizationAPI.getString(44),componentRef:this.editorComponentRef},this.props.mentionableEditorProps,{accessibilityLabel:t,displayMode:A.ReadOnly,showFullContent:this.props.showFullComment,defaultValue:this.props.commentBody,shouldPersistContentOnUnmount:this.shouldEditorPersistOnUnmount()})},e.prototype.editorComponentRef=function(t){this.textEditorRef=t},e.prototype.onMouseOverPost=function(){this.props.collapsed||this.setState({hover:!0})},e.prototype.onMouseLeavePost=function(){this.props.collapsed||this.setState({hover:!1})},e.prototype.setTabIndex=function(t){t.selected||t.isTabbable?this.tabIndexValue=0:this.tabIndexValue=-1},e.prototype.getTabIndex=function(){return this.tabIndexValue},e.prototype.shouldEditorPersistOnUnmount=function(){return this.props.postDisplayMode===v.a.Editing||this.props.postDisplayMode===v.a.EditPreCommitPending},e.prototype.UNSAFE_componentWillMount=function(){this.setState({actionBarItems:this.getActionBarItemsAsButtonProps(this.props),menuItems:this.getActionBarItemsAsContextMenuProps(this.props)})},e.prototype.contextMenuItemClickHandler=function(t,e){t.onClick(this),e&&e.stopPropagation()},e.prototype.renderContextMenuItem=function(t){return i.createElement(je,r.a({},t))},e.prototype.getActionBarItemsAsContextMenuProps=function(t){var e=this,n=[],o=t.actionBarItems;return o&&o.length>0&&(n=o.map(function(n,o){return{id:Ct.a({id:t.id,renderContextType:e.context.renderContextType},o),key:n.text,iconName:n.iconName,name:n.text,data:0===o,onClick:e.contextMenuItemClickHandler.bind(e,n),onKeyDown:e.onContextMenuItemKeyDownHandler.bind(e),onRender:e.renderContextMenuItem}})),n},e.prototype.onContextMenuInteractionHandler=function(t){this.trySelectPost(),t&&Object(D.c)(t.key)===D.a.ArrowDown&&t.preventDefault()},e.prototype.onContextMenuItemKeyDownHandler=function(t){if(Object(D.c)(t.key)===D.a.ArrowDown){var e=document.getElementById(Ct.a({id:this.props.id,renderContextType:this.context.renderContextType},0));if(t.target===e&&this.props.actionBarItems&&this.props.actionBarItems.length>1){var n=document.getElementById(Ct.a({id:this.props.id,renderContextType:this.context.renderContextType},1));n&&(n.focus(),t.preventDefault(),t.stopPropagation())}}else Object(D.c)(t.key)===D.a.Tab&&(t.preventDefault(),t.stopPropagation())},e.prototype.componentDidMount=function(){this.props.selected&&this.postRef&&this.context.isFocusWithinPane()&&this.postRef.focus()},e.prototype.UNSAFE_componentWillReceiveProps=function(t){this.props.actionBarItems===t.actionBarItems&&this.props.selected===t.selected&&this.props.authorColor===t.authorColor&&this.props.authorImageURL===t.authorImageURL||this.setState({actionBarItems:this.getActionBarItemsAsButtonProps(t),menuItems:this.getActionBarItemsAsContextMenuProps(t)})},e.prototype.componentWillUpdate=function(t,e){this.setTabIndex(t)},e.prototype.componentDidUpdate=function(t,e){var n=this.props.postDisplayMode===v.a.Editing||this.props.postDisplayMode===v.a.EditPreCommitPending;this.props.draftViewState&&!n&&Object(d.g)().assertConditionTag(!1,"PostDisplayMode inconsistent with draft warning state",595858832),this.textEditorRef&&(t.commentBody!==this.props.commentBody||this.props.showFullComment&&!t.showFullComment)&&this.textEditorRef.setContents(this.props.commentBody),He.a.postPropsUpdated({focusOnSelection:!0,focusAfterEditing:!1},t,this.props,this.postRef,this.context),Object(d.g)().assertConditionTag(void 0===this.props.draftViewState||this.props.postDisplayMode===v.a.Editing||this.props.postDisplayMode===v.a.EditPreCommitPending,"post has draft state and is not in editing mode",595891716)},e.prototype.postFocusHandler=function(t){var e=document.getElementById(Ct.D({id:this.props.id,renderContextType:this.context.renderContextType}));e&&t.target===e&&(this.props.postDisplayMode===v.a.New||this.props.postDisplayMode===v.a.LowFidelityWarning||this.props.selected||this.props.onSelect(this))},e.prototype.trySelectPost=function(){this.props.postDisplayMode===v.a.New||this.props.postDisplayMode===v.a.LowFidelityWarning||this.props.selected||this.props.onSelect(this)},e.prototype.postClickHandler=function(t){this.trySelectPost(),t.stopPropagation()},e.prototype.cancelHandler=function(){this.props.onCancel(this)},e.prototype.commitHandler=function(){this.props.onCommit(this)},e.prototype.setPostRef=function(t){this.postRef=t||void 0},e.prototype.getBodyStyle=function(){return this.props.parent&&c.g()?this.styles.bodyRoot:this.styles.body},e.prototype.renderActionBar=function(){var t=!this.props.restrictActionControls&&(this.state.hover||this.props.selected)&&this.props.postDisplayMode!==v.a.PendingEdit&&this.props.postDisplayMode!==v.a.PendingDraft,e=this.props.postDisplayMode===v.a.Editing||this.props.postDisplayMode===v.a.EditPreCommitPending;return c.g()&&e?i.createElement(Ae,{commit:this.state.actionBarItems[0],cancel:this.state.actionBarItems[1]}):i.createElement(We,{isVisible:t,actions:this.state.actionBarItems})},e.prototype.postEditingKeyDownHandler=function(t){if(Object(D.c)(t.key)===D.a.Tab){var e=document.getElementById(Ct.a({id:this.props.id,renderContextType:this.context.renderContextType},this.props.actionBarItems.length-1));t.target!==e||t.shiftKey||(this.textEditorRef&&this.textEditorRef.focus(),t.stopPropagation(),t.preventDefault())}},e.prototype.commentEditorKeyDownHandler=function(t){if(Object(D.c)(t.key)===D.a.Tab){var e=t.shiftKey?this.props.actionBarItems.length-1:0,n=document.getElementById(Ct.a({id:this.props.id,renderContextType:this.context.renderContextType},e));n&&n.focus(),t.stopPropagation()}},e.prototype.onEditorCommitRequested=function(){this.commitHandler()},e.prototype.onEditorEscapeRequested=function(){this.cancelHandler()},e.prototype.renderCommentEditor=function(t){var e=this.styles.editorRestContainer,n=void 0;if(this.props.postDisplayMode!==v.a.Editing&&this.props.postDisplayMode!==v.a.EditPreCommitPending||(e=this.styles.editorEditingContainer,n=i.createElement("div",{id:Ct.q({id:this.props.id,renderContextType:this.context.renderContextType}),style:{display:"none"}},this.props.localizationAPI.getString(56))),this.props.supportsAtMentions&&this.props.mentionableEditorProps){var o=r.a({},t,this.props.mentionableEditorProps);return i.createElement("div",{className:e,"aria-describedby":n&&Ct.q({id:this.props.id,renderContextType:this.context.renderContextType})},i.createElement(Zt,r.a({onKeyDown:this.commentEditorKeyDownHandler},o)),n)}return i.createElement("div",{className:e,"aria-describedby":n&&Ct.q({id:this.props.id,renderContextType:this.context.renderContextType})},i.createElement(Wt,r.a({onKeyDown:this.commentEditorKeyDownHandler},t)),n)},e.prototype.renderTimestamp=function(){if(!this.props.hideTimestamp)return i.createElement(nn,r.a({},this.getRenderableItemTimestampProps()))},e.prototype.renderHeader=function(){return this.props.hidePostHeader?null:i.createElement(be,r.a({},this.getRenderableItemHeaderProps()))},e.prototype.renderPersona=function(){return this.props.hidePostHeader?null:i.createElement(xe,r.a({},this.getRenderableItemPersonaProps()))},e.prototype.renderFocusBar=function(){if(!this.props.restrictActionControls)return c.x()?i.createElement(tn,r.a({},this.getRenderFocusBarProps())):i.createElement("div",{id:Ct.B(),className:[this.styles.postFocusBar,Ct.B()].join(" "),tabIndex:-1,"aria-hidden":"true"})},e.prototype.renderHistoryItemContent=function(){return this.props.taskHistoryProps&&!this.props.collapsed?i.createElement(Ze,r.a({},this.getHistoryItemContentFullProps(this.props.taskHistoryProps))):null},e.prototype.getRootDivProps=function(){var t=void 0;return t=this.props.postDisplayMode===v.a.New?this.styles.containerNew:this.props.postDisplayMode===v.a.Editing||this.props.postDisplayMode===v.a.EditPreCommitPending?this.props.parent?this.styles.containerParentEditing:this.styles.containerReplyEditing:this.props.parent?this.styles.containerParent:this.styles.containerReply,{className:Object(Ve.a)(t),ref:this.setPostRef,tabIndex:this.getTabIndex(),onFocus:this.postFocusHandler,onClick:this.postClickHandler,id:Ct.D({id:this.props.id,renderContextType:this.context.renderContextType})}},e.prototype.getDraftWarningProps=function(){return{localizationAPI:this.props.localizationAPI,draftViewState:this.props.draftViewState,renderContextType:this.context.renderContextType,type:R.Post}},e.prototype.getRenderableItemPersonaProps=function(){return{author:this.props.authorName,resolved:this.props.postDisplayMode===v.a.Resolved,isParent:!!this.props.parent,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL}},e.prototype.getRenderableItemTimestampProps=function(){return{timestamp:this.props.timestamp,id:Ct.E({id:this.props.id,renderContextType:this.context.renderContextType})}},e.prototype.getRenderableItemHeaderProps=function(){var t=this.props.parent||this.props.restrictActionControls&&!this.props.parent||this.props.postDisplayMode!==v.a.Normal||!(this.state.hover||this.props.selected);return{author:this.props.authorName,resolved:this.props.postDisplayMode===v.a.Resolved,renderContextType:this.context.renderContextType,contextMenuProps:t?void 0:{menuItems:this.state.menuItems,isTabbable:this.props.selected||this.props.isTabbable,parentId:this.props.id,trySelectPost:this.trySelectPost,localizationAPI:this.props.localizationAPI}}},e.prototype.getHistoryItemContentFullProps=function(t){return r.a({},t,{renderContextType:this.context.renderContextType})},e.prototype.getRenderFocusBarProps=function(){return{id:Ct.B()}},e.prototype.renderReadOnlyState=function(){var t=r.a({},this.defaultEditorProps,{displayMode:A.Disabled,showFullContent:this.props.showFullComment,defaultValue:this.props.commentBody});return i.createElement("div",r.a({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":t.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),this.renderFocusBar(),this.renderPersona(),i.createElement("div",{className:this.getBodyStyle()},i.createElement("div",null," ",this.renderHeader()," "),this.renderHistoryItemContent(),this.renderCommentEditor(t),this.renderTimestamp()))},e.prototype.renderNewState=function(){return i.createElement("div",r.a({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),this.renderFocusBar(),this.renderPersona(),i.createElement("div",{className:this.getBodyStyle()},i.createElement("div",null,this.renderHeader())))},e.prototype.renderEditState=function(){var t=Ee.h(this.props.postDisplayMode,this.props.localizationAPI),e=r.a({},this.defaultEditorProps,{defaultValue:this.props.commentBody,displayMode:A.Editing,initialDraftContent:this.props.draftViewState?this.props.draftViewState.initialDraftContent:void 0,showFullContent:!0,onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.onEditorEscapeRequested,accessibilityLabel:t});return i.createElement("div",r.a({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":e.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),this.renderFocusBar(),this.renderPersona(),i.createElement("div",{className:this.props.parent&&c.g()?this.styles.bodyRoot:this.styles.body,onKeyDown:this.postEditingKeyDownHandler},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(e),i.createElement("div",{className:this.styles.actionbarEdit},this.renderActionBar()),i.createElement(Fe,r.a({},this.getDraftWarningProps()))))},e.prototype.renderLowFidelityWarningState=function(){return i.createElement("div",r.a({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":Ct.v({id:this.props.id,renderContextType:this.context.renderContextType}),"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),this.renderFocusBar(),this.renderPersona(),i.createElement("div",{className:this.getBodyStyle()},this.renderHeader(),this.renderHistoryItemContent(),i.createElement("div",{id:Ct.v({id:this.props.id,renderContextType:this.context.renderContextType}),className:this.styles.lowFidelityWarning},this.props.lowFidelityWarningString),i.createElement("div",{className:this.styles.actionbarEdit},this.renderActionBar())))},e.prototype.renderResolvedState=function(){var t=r.a({},this.defaultEditorProps,{displayMode:A.Disabled,showFullContent:this.props.showFullComment,defaultValue:this.props.commentBody});return i.createElement("div",r.a({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":t.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),this.renderFocusBar(),this.renderPersona(),i.createElement("div",{className:this.getBodyStyle()},i.createElement("div",null," ",this.renderHeader()," "),this.renderHistoryItemContent(),this.renderCommentEditor(t),this.renderTimestamp()))},e.prototype.renderNormalState=function(){var t=r.a({},this.defaultEditorProps,{displayMode:A.ReadOnly,showFullContent:this.props.showFullComment,defaultValue:this.props.commentBody}),e=this.props.parent?this.styles.actionbarRoot:this.styles.actionbarNormal;return this.props.collapsed&&(e=this.styles.actionbarCollapsed),i.createElement("div",r.a({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":t.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps(),{onMouseOver:this.onMouseOverPost,onMouseLeave:this.onMouseLeavePost}),this.renderFocusBar(),this.renderPersona(),i.createElement("div",{className:this.getBodyStyle()},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(t),this.renderTimestamp(),c.g()?void 0:i.createElement("div",{className:e},this.renderActionBar())))},e.prototype.renderPendingEditState=function(){var t=this,e={id:Ct.A({id:this.props.id,renderContextType:this.context.renderContextType}),contentManagerId:Ct.n(this.props.id),localizedEllipsis:this.props.localizationAPI.getString(44),componentRef:function(e){return t.textEditorRef=e},displayMode:A.ReadOnly,showFullContent:this.props.showFullComment,defaultValue:this.props.commentBody,accessibilityLabel:this.props.localizationAPI.getString(88)};return i.createElement("div",r.a({style:{position:"relative"}},this.getRootDivProps()),this.renderFocusBar(),this.renderPersona(),i.createElement("div",{className:this.getBodyStyle()},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(e),this.renderTimestamp(),i.createElement("div",{className:this.props.parent?this.styles.actionbarRoot:this.styles.actionbarNormal},c.g()?void 0:this.renderActionBar())),i.createElement("div",{className:this.styles.postOverlay},i.createElement(x.a,{delay:U.f},i.createElement(P.a,{className:this.styles.postSpinner,size:w.a.large}))))},e.prototype.render=function(){switch(this.props.postDisplayMode){case v.a.LowFidelityWarning:return this.renderLowFidelityWarningState();case v.a.New:return this.renderNewState();case v.a.Editing:case v.a.EditPreCommitPending:return this.renderEditState();case v.a.Resolved:return this.renderResolvedState();case v.a.ReadOnly:return this.renderReadOnlyState();case v.a.Normal:case v.a.PendingDraft:return this.renderNormalState();case v.a.PendingEdit:return this.renderPendingEditState();default:throw new M.a(_.o,-2130957558)}},e}(Ye),rn=n(646),an=n(95),sn=Object(I.b)(function(){return{body:Object(B.a)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,marginTop:"8px",position:"relative",overflow:"visible",marginRight:8}),container:Object(B.a)({display:"flex",direction:"inherit",overflow:"hidden",flexGrow:1,flexDirection:"row",flexWrap:"nowrap",flexShrink:0,margin:0,border:0,position:"relative",selectors:{":focus":{outline:"1px dotted transparent",selectors:{"#postFocusBar":{borderLeft:"2px solid",borderColor:F.a.FLUENT_GRAY,display:"inline"}}}}}),postFocusBar:Object(B.a)({position:"absolute",left:2,top:0,right:0,bottom:0,width:1,backgroundColor:"transparent",display:"none",outline:"none"})}}),cn=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.itemRef=i.createRef(),o.styles=sn(),o.historyItemClickHandler=o.historyItemClickHandler.bind(o),o.historyItemFocusHandler=o.historyItemFocusHandler.bind(o),o}return r.d(e,t),e.prototype.getRenderableItemPersonaProps=function(){return{author:this.props.author,resolved:this.props.resolved,isParent:!1,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL}},e.prototype.getRenderableItemHeaderProps=function(){return{author:this.props.author,resolved:this.props.resolved,renderContextType:this.context.renderContextType,contextMenuProps:{menuItems:[],isTabbable:!1,parentId:"",trySelectPost:function(){},localizationAPI:void 0}}},e.prototype.getRenderableItemTimestampProps=function(){return{timestamp:this.props.timestamp,id:Ct.E({id:this.props.id,renderContextType:this.context.renderContextType})}},e.prototype.getId=function(){return this.props.id},e.prototype.componentDidMount=function(){this.props.selected&&this.itemRef&&this.itemRef.current&&this.context.isFocusWithinPane()&&this.itemRef.current.focus()},e.prototype.componentDidUpdate=function(t){He.a.historyItemPropsUpdated(t,this.props,this.itemRef.current,this.context)},e.prototype.getRenderFocusBarProps=function(){return{id:Ct.B()}},e.prototype.getHistoryItemContentFullProps=function(){return{icon:this.props.icon,description:this.props.description,renderContextType:this.context.renderContextType}},e.prototype.historyItemFocusHandler=function(t){var e=document.getElementById(Ct.D({id:this.props.id,renderContextType:this.context.renderContextType}));e&&t.target===e&&(this.props.selected||this.props.onSelect(this))},e.prototype.historyItemClickHandler=function(t){this.props.selected||this.props.onSelect(this),t.stopPropagation()},e.prototype.getRootDivProps=function(){return{className:Object(Ve.a)(this.styles.container),ref:this.itemRef,tabIndex:-1,onFocus:this.historyItemFocusHandler,onClick:this.historyItemClickHandler,id:Ct.D({id:this.props.id,renderContextType:this.context.renderContextType})}},e.prototype.render=function(){return i.createElement("div",r.a({role:"treeitem","aria-level":2,"aria-selected":this.props.selected},this.getRootDivProps()),i.createElement(tn,r.a({},this.getRenderFocusBarProps())),i.createElement(xe,r.a({},this.getRenderableItemPersonaProps())),i.createElement("div",{className:this.styles.body},i.createElement(be,r.a({},this.getRenderableItemHeaderProps())),i.createElement(Ze,r.a({},this.getHistoryItemContentFullProps())),i.createElement(nn,r.a({},this.getRenderableItemTimestampProps()))))},e.contextTypes=de.a,e}(i.PureComponent);function ln(t,e){switch(e){case g.a.Draft:return t.getStringOrUndefined(28);case g.a.Normal:return t.getStringOrUndefined(27);case g.a.ReadOnly:return t.getStringOrUndefined(30);case g.a.Resolved:return t.getStringOrUndefined(29);default:return}}function dn(t,e,n,o,r,i,a,s){switch(o){case v.a.Normal:return t.formatString(21,e,n);case v.a.Editing:case v.a.EditPreCommitPending:return t.formatString(23,e,n);case v.a.New:return t.getStringOrUndefined(24);case v.a.ReadOnly:return t.formatString(25,e,n);case v.a.Resolved:return t.formatString(22,e,n);case v.a.LowFidelityWarning:return t.getStringOrUndefined(26);default:return}}var pn=n(385),un=n(94),fn=n(659);function hn(t,e,n,o,r,i){for(var a=[],s=!i&&void 0!==o&&(void 0===o.newComment.parentId||""===o.newComment.parentId)&&o.index>=0,c=un.b(t).length,l=o&&o.index===c?c:-1,p=0;p<t.length;p+=1){var f=t[p],h=Object(an.a)(f)?f:void 0;if(h&&void 0!==e[h.commentModel.commentId])if(e[h.commentModel.commentId].pending===u.a.Delete&&r)for(;!(p+1>=t.length||""===un.e(t[p+1]));)++p;else{a.push([h]),s&&-1===l&&o&&p===o.index&&(l=a.length-1);for(var y=p+1;y<t.length;y+=1){var g=t[y];if(Object(an.a)(g)){if(un.e(g)!==h.commentModel.commentId)break;n[un.d(g)].pending!==m.a.Delete&&a[a.length-1].push(g)}else a[a.length-1].push(g);++p}}else{var b=h?h.commentModel.commentId:"",v=h?h.commentModel.parentId:"";for(Object(d.g)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: "+t.length+" | cardViewStateLength: "+Object.keys(e).length+" | postViewStateLength:  "+Object.keys(n).length+" | isLieThread: "+s+" | CommentId: "+b+" | ParentId: "+v,595981017);!(p+1>=t.length||""===un.e(t[p+1]));)++p}}if(-1!==l&&s&&o){var C=Object(pn.a)(o);a.splice(l,0,[{commentModel:C}])}return a}function mn(t,e){return!e||e.selectedCardId!==t||Object(f.c)(e.focusDetails)&&!e.focusDetails.expanded?y.a.Collapsed:y.a.Expanded}function yn(t,e){return!!e&&e.selectedCardId===t&&Object(f.c)(e.focusDetails)}function gn(t,e){return!!e&&e.selectedCardId===t&&!Object(f.c)(e.focusDetails)}function bn(t,e){return!!e&&!Object(f.c)(e.focusDetails)&&e.focusDetails.selectedPostId===t}function vn(t,e,n,o){switch(t){case rn.a.AllCardsTabbable:return!0;case rn.a.ExpandedCardOrFirstCardTabbable:if(o){var r=yn(e,o),i=gn(e,o),a=mn(e,o);return r||a===y.a.Expanded&&i}return n;case rn.a.ExpandedCardTabbable:return!!o&&(a=mn(e,o))===y.a.Expanded;case rn.a.SelectedCardTabbable:return!!o&&o.selectedCardId===e}}function Cn(t,e,n,o,r){if(o===v.a.PendingEdit||o===v.a.PendingDraft)return bn(e,r);switch(t){case rn.b.AllPostsTabbable:return!0;case rn.b.ExpandedCardPostsTabbable:return(a=mn(n||e,r))===y.a.Expanded;case rn.b.ExpandedCardRootPostTabbable:var i=bn(e,r),a=mn(n||e,r),s=yn(n||e,r);return o!==v.a.New&&(i||s&&a===y.a.Expanded&&!n);case rn.b.SelectedPostTabbable:return bn(e,r)}}function xn(t,e,n,o,s,l,p,u,h,y,g,b,C,x,T,O,S,E,P,w,I){var k=!1;h&&!Object(f.c)(h.focusDetails)&&(k=h.focusDetails.selectedPostId===t.commentId);var R=function(t,e,n,o,r,i,s){if(e.pending!==m.a.None)return Object(d.g)().assertConditionTag(e.pending!==m.a.Delete,"Post with PostPendingType.Delete should not attempt to be rendered. Falling back to PendingEdit display mode.",595981018),i?v.a.PendingDraft:v.a.PendingEdit;if(r){if(i)return v.a.New;if(n&&!Object(f.c)(n.focusDetails)&&n.focusDetails.selectedPostId===t.commentId&&Object(f.g)(n))return n.focusDetails.editingSession===f.a.CommitPending?v.a.EditPreCommitPending:v.a.Editing}if(n&&!Object(f.c)(n.focusDetails)&&n.focusDetails.selectedPostId===t.commentId&&Object(f.h)(n.focusDetails))return v.a.LowFidelityWarning;if(o)return v.a.Resolved;if(t.commentFlags&a.a.ReadOnly||s)return v.a.ReadOnly;return v.a.Normal}(t,e,h,u,E,g,b),A=e.displayDate||"",D=e.draftId?O[e.draftId]:void 0,j="",N="";return c.u()&&x&&(j=x.authorColor,N=x.authorImageURL),i.createElement(on,r.a({},n,{postDisplayMode:R,id:t.commentId,authorName:t.authorName,authorIdentity:t.authorIdentity,authorColor:j,authorImageURL:N,authorEmail:t.authorEmail,appAuthorId:t.appAuthorId,authorContextId:t.authorContextId,timestamp:A,commentBody:t.commentBody,parent:""===t.parentId,lowFidelityWarningString:k?Ee.f(p,h):"",selected:k,isTabbable:Cn(C,t.commentId,t.parentId,R,h),supportsAtMentions:y},s,{localizationAPI:p,actionBarItems:fn.a(l,R,h?h.focusDetails.editingSession:f.a.None,""===t.parentId,t.commentFlags),accessibilityLabel:dn(p,t.authorName,A,R,t.parentId.length,0,t.commentBody),key:t.commentId,mentionableEditorProps:o,draftViewState:E&&void 0!==e.draftId?{draftId:e.draftId,initialDraftContent:D?D.savedContent:void 0,warningInstanceKey:e.warningInstanceKey}:void 0,taskHistoryProps:w,accessibilityPositionInSet:P.accessibilityPositionInSet,accessibilitySetSize:P.accessibilitySetSize,hidePostHeader:I&&""===t.parentId}))}function Tn(t,e,n,o,a,s){var d=Object(l.c)(e.records[0].user),u=e.records[0].user.UserId,h=Object(p.f)(e.records[0].time,void 0,t.getLocaleInfo().appLocale),m=un.c(e,t),y="",g="";c.u()&&o&&(y=o.authorColor,g=o.authorImageURL);var b=!1;return s&&!Object(f.c)(s.focusDetails)&&(b=s.focusDetails.selectedPostId===e.records[0].recordId),i.createElement(cn,r.a({},m,{onSelect:n.onSelect,id:e.records[0].recordId,key:e.records[0].recordId,author:d,authorIdentity:u,timestamp:h,selected:b,authorColor:y,authorImageURL:g,resolved:a}))}function On(t,e,n,o,s,d,p,m,y,v,C,x,T,O,S,E,P,w,I,k,R,A,D,j){var N=un.f(t),M=N.commentId,_=n[M],B=A===b.a.InChildPost,L=!!(N.commentFlags&a.a.Resolved),F=[],H=function(t,e,n,o,r,i){if(e.loadState===h.a.Placeholder||e.loadState===h.a.FirstLoad)return g.a.Loading;switch(e.pending){case u.a.Card:return g.a.CardPostCommitPending;case u.a.Editor:return g.a.ReplyPostCommitPending;case u.a.Delete:return g.a.CardPostCommitPending}if(i)return g.a.ReadOnly;if(r)return n&&n.focusDetails.editingSession===f.a.CommitPending?g.a.DraftPreCommitPending:g.a.Draft;if(o&&n&&n.selectedCardId===t.commentId&&Object(f.c)(n.focusDetails)){if(Object(f.g)(n))return n.focusDetails.editingSession===f.a.CommitPending?g.a.ReplyPreCommitPending:g.a.Reply;if(c.l()&&n.focusDetails.editingSession===f.a.SessionRequestPending)return g.a.ReplySessionRequestPending}if(t.commentFlags&a.a.ReadOnly)return g.a.ReadOnly;if(t.commentFlags&a.a.Resolved)return g.a.Resolved;return g.a.Normal}(N,_,O,!c.j()||A===b.a.InCard,P,w),U=(t.length,c.e());if((_.loadState===h.a.Loaded||_.loadState===h.a.NeedsReload||_.loadState===h.a.Loading)&&(!P||v))for(var z=0;z<t.length;z++){var V=t[z];if(Object(an.a)(V)){var q=V.commentModel.commentId,K=B&&O&&!Object(f.c)(O.focusDetails)&&O.focusDetails.selectedPostId===q;if(!S||!B||K){var G=Object(an.b)(V)?un.c(V.historyItem,C):void 0;F.push(xn(V.commentModel,o[q],s,d,y(q,M),x,C,L,O,E,P,w,I.postTabbingMode,k?k[V.commentModel.authorName]:void 0,0,R,(_.pending,u.a.Editor),!c.j()||B||P,{accessibilitySetSize:t.length,accessibilityPositionInSet:z+1},G,U))}}else c.a()&&F.push(Tn(C,V.historyItem,s,k?k[Object(l.c)(V.historyItem.records[0].user)]:void 0,L,O))}return function(t,e,n,o,a,s,l,d,p,u,h,m,y,g,v,C,x,T,O){var S=n.draftId?m[n.draftId]:void 0,E=!c.j()||g===b.a.InCard;return i.createElement(ze,r.a({},o,{cardCollapsedState:mn(t.commentId,p),selected:yn(t.commentId,p),hasSelectedChild:gn(t.commentId,p),displayMode:y,id:t.commentId,supportsAtMentions:u,isTabbable:vn(h,t.commentId,d,p)},s,{localizationAPI:l,accessibilityLabel:ln(l,y),anchorText:t.anchorHintText,authorName:t.authorName,authorIdentity:t.authorIdentity,authorColor:x?x.authorColor:"",authorImageURL:x?x.authorImageURL:"",authorEmail:t.authorEmail,appAuthorId:t.appAuthorId,authorContextId:t.authorContextId,renderRootPostHeaderOnCard:C,discardRequested:!(!p||!p.focusDetails||p.focusDetails.editingSession!==f.a.DiscardPending),cardRelativeDraftingState:g,draftViewState:E&&void 0!==n.draftId?{draftId:n.draftId,initialDraftContent:S?S.savedContent:void 0,warningInstanceKey:n.warningInstanceKey,currentMentionees:n.currentMentionees,selectedTaskAssignee:n.selectedTaskAssignee}:void 0,key:t.commentId,taskHeaderProps:e,isNewThread:O,accessibilityPositionInSet:v.accessibilityPositionInSet,accessibilitySetSize:v.accessibilitySetSize,maximumDimensions:T}),a)}(N,e,_,p,F,m,C,T,O,E,I.cardTabbingMode,R,H,A,D,U,U&&k&&c.u()?k[N.authorName]:void 0,j,P)}function Sn(t,e){if(!c.j())return!1;var n=Object(p.z)(t);return void 0!==n&&n.renderContextType!==e&&n.commentDraft.sessionConfiguration.sessionType===s.a}function En(t,e,n,o,r,i,a){if(c.a()){return{id:t,title:e.title,assignees:e.assignees,completion:r?100:e.completion,onHeaderButtonPressed:a,localizationAPI:n,renderContextType:o,disabled:i}}}n.d(e,"a",function(){return hn}),n.d(e,"b",function(){return mn}),n.d(e,"e",function(){return yn}),n.d(e,"c",function(){return gn}),n.d(e,"g",function(){return On}),n.d(e,"f",function(){return Sn}),n.d(e,"d",function(){return En})},656:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n(18),r=n(336);function i(t,e){return function(n){var i=Object(r.a)(t,e);return n(i),i.payload.completion||Promise.reject(new o.a("requestDisplayConfiguration was not provided a completion from middleware.",-2130957557))}}},657:function(t,e,n){"use strict";n.d(e,"t",function(){return v}),n.d(e,"u",function(){return C}),n.d(e,"s",function(){return x}),n.d(e,"v",function(){return T}),n.d(e,"r",function(){return O}),n.d(e,"a",function(){return S}),n.d(e,"k",function(){return E}),n.d(e,"j",function(){return P}),n.d(e,"g",function(){return w}),n.d(e,"e",function(){return I}),n.d(e,"f",function(){return k}),n.d(e,"d",function(){return R}),n.d(e,"b",function(){return A}),n.d(e,"h",function(){return D}),n.d(e,"i",function(){return j}),n.d(e,"c",function(){return N}),n.d(e,"l",function(){return M}),n.d(e,"n",function(){return _}),n.d(e,"m",function(){return B}),n.d(e,"o",function(){return L}),n.d(e,"p",function(){return F}),n.d(e,"q",function(){return H});var o=n(329),r=n(139),i=n(186),a=(n(49),n(13)),s=n(175),c=n(187),l=n(3),d=n(144),p=n(32),u=n(16),f=n(74),h=n(306),m=n(19),y=n(95),g=n(94);function b(t,e,n,o){var i=!t.parentId,s=!!(t.commentFlags&r.a.LowFidelity);if(!n)return a.g()&&s&&i;var c=s||i&&o===u.a.LowFidelityWarningOnDelete&&e.some(function(e){return Object(y.a)(e)&&e.commentModel.parentId===t.commentId&&!!(e.commentModel.commentFlags&r.a.LowFidelity)}),l=Object(u.c)(n.focusDetails)?n.selectedCardId:n.focusDetails.selectedPostId;return!(!c||l===t.commentId&&n.focusDetails.editingSession===o)}function v(t,e,n,o,r,i,a,c){var d=g.a(n,e);d?b(d,n,o,u.a.LowFidelityWarningOnDelete)?i.showLowFidelityWarning({renderContextType:r,telemetryVisitor:c,trackback:l.f.reserveTag(595869921)},e,u.a.LowFidelityWarningOnDelete):(a&&a.appendLiveRegionUpdate(Object(s.a)().getString(65)),i.requestDeleteComment({renderContextType:r,telemetryVisitor:c,trackback:t},e)):Object(l.g)().assertConditionTag(!1,"Comment not found",595869920)}function C(t,e,n,o,r,i,a){var s=g.a(n,e);s?b(s,n,o,u.a.LowFidelityWarningOnEdit)?i.showLowFidelityWarning({renderContextType:r,telemetryVisitor:a,trackback:l.f.reserveTag(595869923)},e,u.a.LowFidelityWarningOnEdit):i.requestEditCommentSession({renderContextType:r,telemetryVisitor:a,trackback:t},e):Object(l.g)().assertConditionTag(!1,"Comment not found",595869922)}function x(t,e,n,o,r,i,a,c,d,p){if(!Object(u.d)(o)){var f=g.a(n,e);f?(d&&d.appendLiveRegionUpdate(Object(s.a)().getString(67)),c.commitCommentAndFocus({renderContextType:a.renderContextType,telemetryVisitor:p,trackback:t},function(){return r},{commentId:e,type:"EDIT",previousCommentBody:f.commentBody},i,a)):Object(l.g)().assertConditionTag(!1,"Comment not found in model",595869952)}}function T(t,e,n,o,i,a,s){var c=g.g(e);if(!o||o.selectedCardId!==c||Object(u.c)(o.focusDetails)&&!o.focusDetails.expanded)a.selectCommentCardExpand({renderContextType:i,telemetryVisitor:s,trackback:t},c,p.a.SharedComments);else{var d=c?g.a(n,c):void 0;if(!d)return void Object(l.g)().assertConditionTag(!1,"No root comment found, something is wrong in the tree?",595869953);void 0!==d.commentFlags&&d.commentFlags&r.a.Resolved||a.selectCommentPost({renderContextType:i,telemetryVisitor:s,trackback:t},c,g.d(e),p.a.SharedComments)}}function O(t,e,n,o,r,a,c,d,u,f,h){var m=g.a(o,e);r&&m?(f&&f.appendLiveRegionUpdate(Object(s.a)().getString(66)),u.discardDraftAsync({renderContextType:d,telemetryVisitor:h,trackback:t},p.a.SharedComments,a,c).then(function(t){t===i.a.Handled&&m&&n&&n(m.commentBody)})):Object(l.g)().assertConditionTag(!1,"Cannot find comment post to cancel '"+e+"'",595981075)}function S(t,e,n,o,r){o.requestReplyCommentSession({renderContextType:n,telemetryVisitor:r,trackback:t},e.getId())}function E(t,e,n,o,r){o.selectCommentCardExpand({renderContextType:n,telemetryVisitor:r,trackback:t},e.getId(),p.a.SharedComments)}function P(t,e,n,o,r){o.selectCommentCardCollapse({renderContextType:n,telemetryVisitor:r,trackback:t},e.getId(),p.a.SharedComments)}function w(t,e,n,o,r){void 0!==e?o.highlightComment({renderContextType:n,telemetryVisitor:r,trackback:t},e.getId()):o.clearCommentHighlight({renderContextType:n,telemetryVisitor:r,trackback:t})}function I(t,e,n,o,r,i,a){if(o===m.a.HalfPane){if(void 0===n)return Object(l.g)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",595869955);r&&r.selectedCardId===e&&r.selectedCardId===f.a&&Object(u.g)(r)&&i.requestDisplayConfiguration({renderContextType:o,telemetryVisitor:a,trackback:t},{displayMode:d.a.Variable,desiredHeight:n})}}function k(t,e,n,o,r){a.t()||e.draftHasContent()||e.getId()===f.a||o.discardDraftAsync({renderContextType:n,telemetryVisitor:r,trackback:t},p.a.SharedComments,!1)}function R(t,e,n,r,i,c,l,d,h,m,y,g){var b;e&&i&&n&&(b=i(n,r));var v=!1;if(a.B)if(a.r()&&n){var C=m?m.draftId:void 0;v=!!C&&!!y[C]&&y[C].commentDraft.sessionConfiguration.sessionType===o.REPLY_COMMENT_SESSION_TYPE}else v=!!n&&n.selectedCardId!==f.a;else v=!!n&&Object(u.c)(n.focusDetails)&&Object(u.i)(n.focusDetails);d&&d.appendLiveRegionUpdate(v?Object(s.a)().getString(64):Object(s.a)().getString(103)),l.discardDraftAsync({renderContextType:c,telemetryVisitor:g,trackback:t},p.a.SharedComments,h,b)}function A(t,e,n,o,r,i,c,l,d,p){if(!Object(u.d)(n)){var f=void 0;a.a()&&p&&(f={Task:{type:"Task",assignee:p}}),a.B&&l&&l.appendLiveRegionUpdate(Object(s.a)().getString(67)),c.commitCommentAndFocus({trackback:t,telemetryVisitor:d,renderContextType:i.renderContextType},e.getContentsAsync,r,o,i,f)}}function D(t,e,n,o,r,i,a){r&&r.appendLiveRegionUpdate(Object(s.a)().getString(125)),o.requestReopenThread({renderContextType:n,telemetryVisitor:i,trackback:t},e,a)}function j(t,e,n,o,r,i,a){r&&r.appendLiveRegionUpdate(Object(s.a)().getString(124)),o.requestResolveThread({renderContextType:n,telemetryVisitor:i,trackback:t},e,a)}function N(t,e,n,o,r,a,c,l,d){n===m.a.HalfPane&&o&&r?o(h.a.DeleteThread,r,function(){return i.a.Canceled}):(c&&c.appendLiveRegionUpdate(Object(s.a)().getString(63)),n===m.a.DiscreteIntegrated||n===m.a.DiscreteIsolated?setTimeout(function(){a.requestDeleteThread({renderContextType:n,telemetryVisitor:l,trackback:t},e,d)},100):a.requestDeleteThread({renderContextType:n,telemetryVisitor:l,trackback:t},e,d))}function M(t,e,n,o,r,i,a){100!==n.completion?j(t,e,o,r,i,a,!0):D(t,e,o,r,i,a,!0)}function _(t,e,n,o,r){var i=Object(l.g)().createActivityObject("CheckUserAccess",r,l.a.None),a=Object(c.b)(n);o.checkUserAccess(a).then(function(t){i.addDataField(l.c.UserCanWrite,t.UserCanWrite,l.d.SystemMetadata),i.successTag(e)},function(e){i.failTag(t,-2130957562)})}function B(t,e,n,o){return o.getUserContacts(t,e,n)}function L(t,e,n,o,r,i){if(a.r()){var s=o[e.getId()],c=s?s.draftId:void 0;c?r.saveDraft({renderContextType:n,telemetryVisitor:i,trackback:t},c,{editorContent:e.getContentsAsync(),editorCursorPosition:e.getCursorPositionAsync()}):Object(l.g)().assertConditionTag(void 0===s,"onSaveDraft called while viewState exists without a draft",595869956)}}function F(t,e,n,o,r){o.updateCurrentMentionees({renderContextType:n,telemetryVisitor:r,trackback:t},e)}function H(t,e,n,o,r){n.updateSelectedTaskAssignee({renderContextType:e,telemetryVisitor:o,trackback:t},r)}},658:function(t,e,n){"use strict";var o,r,i;n.d(e,"c",function(){return o}),n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i}),function(t){t.ComputeTruncationTimer="CTT",t.ComputeTruncationStart="CTS",t.ComputeTruncationEnd="CTE",t.Quill2OfficeTimer="Q2OT",t.Quill2OfficeStart="Q2OS",t.Quill2OfficeEnd="Q2OE",t.Office2QuillTimer="O2QT",t.Office2QuillStart="O2QS",t.Office2QuillEnd="O2QE",t.MapState2PropsTimer="MSPT",t.MapState2PropsStart="MSPS",t.MapState2PropsEnd="MSPE"}(o||(o={})),function(t){t.ComputeTruncationTime="ComputeTruncationTime",t.QuillToOfficeTime="QuillToOfficeTime",t.OfficeToQuillTime="OfficeToQuillTime",t.MapStateToProps="MapStateToProps",t.NoMeasure="NoMeasure"}(r||(r={})),function(t){t[t.ComputeTruncation=0]="ComputeTruncation",t[t.Office2Quill=1]="Office2Quill",t[t.Quill2Office=2]="Quill2Office",t[t.MapState2Props=3]="MapState2Props",t[t.NoMeasure=4]="NoMeasure"}(i||(i={}))},659:function(t,e,n){"use strict";n.d(e,"a",function(){return d}),n.d(e,"c",function(){return p}),n.d(e,"b",function(){return u}),n.d(e,"d",function(){return f});var o=n(139),r=n(13),i=n(3),a=n(16),s=n(126),c=n(102),l=n(518);function d(t,e,n,r,i){return e===c.a.LowFidelityWarning&&n===a.a.LowFidelityWarningOnEdit?t.lowFidelityEdit:e===c.a.LowFidelityWarning&&n===a.a.LowFidelityWarningOnDelete?t.lowFidelityDelete:e===c.a.ReadOnly||e===c.a.Resolved?t.empty:i&o.a.EditRestricted?r?t.empty:t.editRestrictedReply:e===c.a.Editing||e===c.a.EditPreCommitPending?t.editing:r?t.normalRoot:t.normalReply}function p(t,e,n,a,s){var c=(e.commentFlags&o.a.Resolved)>0;return c&&n?t.resolved:n?r.g()&&(e.commentFlags&o.a.EditRestricted||a)?s?t.normalResolveSupportedEditRestrictedWithTask:t.normalResolveSupportedEditRestricted:s?t.normalResolveSupportedWithTask:t.normalResolveSupported:c&&!n?(Object(i.g)().assertConditionTag(!n&&c,"Card cannot be resolved when resolved is not supported",595981189),r.g()&&e.commentFlags&o.a.EditRestricted?t.normalResolveNotSupportedEditRestricted:t.normalResolveNotSupported):r.g()&&e.commentFlags&o.a.EditRestricted?t.normalResolveNotSupportedEditRestricted:t.normalResolveNotSupported}function u(t,e,n){var o={text:t.getString(5),iconName:Object(l.a)(3),onClick:e.onDeleteThread,isDestructive:!0},i={text:t.getString(3),iconName:Object(l.a)(5),onClick:e.onResolveThread},a=r.a()?{text:t.getString(126),iconName:Object(l.a)(5),onClick:e.onResolveThread}:void 0,c={text:t.getString(4),iconName:Object(l.a)(4),onClick:e.onReopenThread},d={text:t.getString(15),onClick:function(){},isCancelItem:!0},p={text:t.getString(120),onClick:e.onEditRootPost,iconName:Object(l.a)(6),accessibilityLabel:t.getStringOrUndefined(40)},u=r.g()?{normalResolveSupported:[p,o,i],normalResolveSupportedWithTask:a?[p,o,a]:[],normalResolveNotSupported:[p,o],normalResolveSupportedEditRestricted:[o,i],normalResolveSupportedEditRestrictedWithTask:a?[o,a]:[],normalResolveNotSupportedEditRestricted:[o],resolved:[c,o]}:{normalResolveSupported:[o,i],normalResolveNotSupported:[o],resolved:[c,o],normalResolveSupportedEditRestricted:[],normalResolveNotSupportedEditRestricted:[],normalResolveSupportedWithTask:[],normalResolveSupportedEditRestrictedWithTask:[]};return n===s.a.iOS&&(u.normalResolveNotSupported.push(d),u.normalResolveSupported.push(d)),u}function f(t,e,n){var o={text:r.g()?t.getString(121):t.getString(2),onClick:e.onDelete,iconName:Object(l.a)(3),accessibilityLabel:t.getStringOrUndefined(41),isDestructive:!0},i={text:t.getString(15),onClick:e.onCancel,accessibilityLabel:t.getStringOrUndefined(43),isCancelItem:!0},a={text:r.g()?t.getString(120):t.getString(1),onClick:e.onEdit,iconName:Object(l.a)(6),accessibilityLabel:t.getStringOrUndefined(40)},c={text:t.getString(37),onClick:e.onEdit,accessibilityLabel:t.getStringOrUndefined(42)},d={text:t.getString(15),iconName:Object(l.a)(1),onClick:e.onCancel,accessibilityLabel:t.getStringOrUndefined(39),isCancelItem:!0},p={text:t.getString(15),onClick:function(){},accessibilityLabel:t.getString(15),isCancelItem:!0},u={lowFidelityDelete:[o,i],lowFidelityEdit:[c,d],editing:[{text:t.getString(14),iconName:Object(l.a)(2),onClick:e.onCommit,accessibilityLabel:t.getStringOrUndefined(38)},d],normalReply:[a,o],normalRoot:[a],editRestrictedReply:[o],empty:[]};return n===s.a.iOS&&(u.normalReply.push(p),u.normalRoot.push(p),u.editRestrictedReply.push(p)),u}},660:function(t,e,n){"use strict";n.d(e,"g",function(){return i}),n.d(e,"a",function(){return a}),n.d(e,"h",function(){return s}),n.d(e,"b",function(){return c}),n.d(e,"f",function(){return l}),n.d(e,"c",function(){return d}),n.d(e,"i",function(){return p}),n.d(e,"d",function(){return u}),n.d(e,"e",function(){return f}),n.d(e,"k",function(){return h}),n.d(e,"j",function(){return y});var o=n(63),r=n(94),i=function(t){return t.contextState.isReadOnly},a=function(t){return t.atMentionState},s=function(t){return t.personaIconPropertiesMap},c=function(t){return t.cardViewState},l=function(t){return t.highlightedCommentId},d=function(t){return t.commentData},p=function(t){return t.postViewState},u=function(t){return t.createdCommentLie},f=function(t){return t.drafts},h=function(){return Object(o.a)(d,r.h)},m=function(t){return t.taskState.tasks},y=function(){return Object(o.a)([d,m],r.i)}},678:function(t,e,n){"use strict";n.d(e,"a",function(){return b});var o=n(20),r=n(83),i=n(56),a=n(13),s=n(3),c=n(47),l=n(345),d=n(79),p=n(18),u=n(88),f=n(234),h=n(17),m=n(16),y=n(331),g=n(334);function b(t,e,n,u,f,b){return function(C,x){var T=Object(s.g)().createActivityObject("CommitComment",t.telemetryVisitor,s.a.None),O=i.a[f.type],S=x(),E=S.drafts,P=Object(h.y)(E);if(a.r()&&(void 0===P||P.sessionConfiguration.sessionType!==f.type))return T.failTag(595912539,-2130957522),Promise.resolve({shareFailed:!1});var w="";switch(f.type){case r.b:w=f.commentId;break;case r.d:w=f.parentId;break;case r.a:P&&(w=P.sessionConfiguration.draftId||"")}return T.addDataField(s.c.SessionType,O,s.d.SystemMetadata),T.addDataField(s.c.AssociatedCommentId,w,s.d.SystemMetadata),T.addDataField(s.c.AtMentionsEnabled,n,s.d.SystemMetadata),T.addDataField(s.c.Trackback,t.trackback,s.d.SystemMetadata),T.addDataField(s.c.RenderContextType,t.renderContextType,s.d.SystemMetadata),Object(m.d)(S.focusedComment)?Promise.resolve({shareFailed:!1}):(C(Object(y.a)(o.h(t,s.f.reserveTag(595953733)))),u().then(function(r){if(!n)return v(C,f,r,T,s.f.reserveTag(595981133),s.f.reserveTag(595973336),t,b),Promise.resolve({shareFailed:!1});var i=Object(c.c)(r);return T.addDataField(s.c.NumberOfMentionsAdded,i.length,s.d.SystemMetadata),T.addDataField(s.c.CommentBodyLength,Object(l.c)(r),s.d.SystemMetadata),i.length?e.grantUsersAccess(i).then(function(e){var n=function(t){return t.OperationResult}(e),i=function(t){return!!t.Details&&t.Details.Canceled}(e);return T.addDataField(s.c.AllUsersGrantedAccess,n,s.d.SystemMetadata),T.addDataField(s.c.ShareDialogCanceled,i,s.d.SystemMetadata),i?(d.e("Share dialog was canceled by user"),T.successTag(595981135),C(Object(g.a)(o.h(t,s.f.reserveTag(595953734)))),Promise.resolve({shareFailed:!0})):n?(v(C,f,r,T,s.f.reserveTag(595981137),s.f.reserveTag(595973338),t,b),Promise.resolve({shareFailed:!1})):(d.e("Not all users have been granted access - going back to initial state"),T.successTag(595981136),C(Object(g.a)(o.h(t,s.f.reserveTag(595953735)))),Promise.resolve({shareFailed:!0}))},function(e){return T.failTag(595981138,-2130957561),d.e("Grant Users Access has failed",e),C(Object(g.a)(o.h(t,s.f.reserveTag(595953736)))),Promise.resolve({shareFailed:!0})}):(v(C,f,r,T,s.f.reserveTag(595981134),s.f.reserveTag(595973337),t,b),Promise.resolve({shareFailed:!1}))},function(){return T.failTag(595981139,-2130957539),C(Object(g.a)(o.h(t,s.f.reserveTag(595953737)))),Promise.reject(new p.a("getCommentBody failed",-2130957539))}))}}function v(t,e,n,r,i,c,l,d){var h=function(t,e,n,r,i){try{var c=void 0;switch(e.type){case"CREATE":c=o.w(o.h(r,s.f.reserveTag(595953738)),n),a.r()?t(o.m(o.h(r,s.f.reserveTag(595912011)),{sessionType:e.type,data:c.payload,metadataUpdates:i})):t(c);break;case"EDIT":c=o.u(o.h(r,s.f.reserveTag(595953739)),e.commentId,n),a.r()?t(o.m(o.h(r,s.f.reserveTag(595912012)),{sessionType:e.type,data:c.payload})):t(c);break;case"REPLY":c=o.v(o.h(r,s.f.reserveTag(595953740)),n,e.parentId),a.r()?t(o.m(o.h(r,s.f.reserveTag(595912013)),{sessionType:e.type,data:c.payload,metadataUpdates:i})):t(c);break;default:return Object(s.g)().assertConditionTag(!1,"Unexpected session type '"+e.type+"'",595981010),t(Object(g.a)(o.h(r,s.f.reserveTag(595953741)))),-2130957532}}catch(e){if(!Object(p.b)(e)&&!Object(f.a)(e))throw e;return t(Object(g.a)(o.h(r,s.f.reserveTag(595953742)))),Object(u.a)(e)}return}(t,e,n,l,d);h?r.failTag(c,h):r.successTag(i)}},679:function(t,e,n){"use strict";n.d(e,"a",function(){return m});var o=n(20),r=n(83),i=n(186),a=n(13),s=n(3),c=n(17),l=n(16),d=n(11),p=n(32),u=n(337),f=n(333);function h(t,e,n,i){if(!a.r())return function(t,e,n,r){if(t.focusedComment)return Object(l.c)(t.focusedComment.focusDetails)?t.createdCommentLie&&t.createdCommentLie.newComment.commentId===t.focusedComment.selectedCardId?{cancelAction:o.e(Object(d.a)(n,s.f.reserveTag(595953681)),r,e),sessionType:"CREATE"}:t.createdCommentLie?(Object(s.g)().assertConditionTag(!1,"Focused comment selected card id does not align with createCommentLie id",595981008),-2130957551):{cancelAction:o.g(Object(d.a)(n,s.f.reserveTag(595953681)),t.focusedComment.selectedCardId,r,e),sessionType:"REPLY"}:{cancelAction:o.f(Object(d.a)(n,s.f.reserveTag(595953683)),t.focusedComment.focusDetails.selectedPostId,r,e),sessionType:"EDIT"};return-2130957522}(t,e,n,i);var p=c.y(t.drafts);if(!p)return t.focusedComment&&Object(l.f)(t.focusedComment.focusDetails)&&Object(l.h)(t.focusedComment.focusDetails)?{cancelAction:o.f(Object(d.a)(n,s.f.reserveTag(595736266)),t.focusedComment.focusDetails.selectedPostId,i,e),sessionType:r.b}:-2130957522;var u=p.sessionConfiguration.sessionType;switch(p.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:o.e(Object(d.a)(n,s.f.reserveTag(595736264)),i,e),sessionType:u};case"REPLY":return{cancelAction:o.g(Object(d.a)(n,s.f.reserveTag(595736265)),p.sessionConfiguration.threadId,i,e),sessionType:u};case"EDIT":return{cancelAction:o.f(Object(d.a)(n,s.f.reserveTag(595736266)),p.sessionConfiguration.commentId,i,e),sessionType:u};default:return Object(s.g)().assertConditionTag(!1,"Unexpected draft type",595736267),-2130957551}}function m(t,e,n,o){return function(r,c){var m=c(),y=Object(s.g)().createActivityObject("DiscardDraftAsync",t.telemetryVisitor,s.a.None),g=Object(l.d)(m.focusedComment);y.addDataField(s.c.Trackback,t.trackback,s.d.SystemMetadata),y.addDataField(s.c.RenderContextType,t.renderContextType,s.d.SystemMetadata),y.addDataField(s.c.CommitPendingAttemptedCancel,g,s.d.SystemMetadata),y.addDataField(s.c.ActionSource,e,s.d.SystemMetadata);var b=e===p.a.SharedComments;a.i()&&(b=!0);var v=h(m,n,t,b);if("number"==typeof v)return y.failTag(s.f.reserveTag(595736268),v),Promise.resolve(i.a.Handled);var C=v.sessionType,x=v.cancelAction;return y.addDataField(s.c.ActiveSessionType,C,s.d.SystemMetadata),g||!m.focusedComment||m.focusedComment.focusDetails.editingSession!==l.a.Active&&m.focusedComment.focusDetails.editingSession!==l.a.LowFidelityWarningOnEdit&&m.focusedComment.focusDetails.editingSession!==l.a.LowFidelityWarningOnDelete?(y.addDataField(s.c.DiscardUnnecessary,!0,s.d.SystemMetadata),y.successTag(595981131),Promise.resolve(i.a.Unhandled)):(y.addDataField(s.c.DiscardUnnecessary,!1,s.d.SystemMetadata),r(Object(u.a)(Object(d.a)(t,s.f.reserveTag(595952457)))),y.addDataField(s.c.DiscardDialogShown,!!o,s.d.SystemMetadata),o?o(function(){return r(x),y.addDataField(s.c.CancelledByUser,!1,s.d.SystemMetadata),y.successTag(595981004),i.a.Handled},function(){return y.addDataField(s.c.CancelledByUser,!0,s.d.SystemMetadata),y.successTag(595981129),r(Object(f.a)(Object(d.a)(t,s.f.reserveTag(595952458)))),i.a.Canceled}):(r(x),y.successTag(595981006),Promise.resolve(i.a.Handled)))}}},680:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(108);function r(t,e){return t===o.a.Enabled}},681:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return c});var o=n(136),r=n(26),i=n(82),a=n(515),s=28,c=Object(r.b)(function(){return{headerContainer:Object(o.a)({flexDirection:"row",position:"relative",display:"flex",height:s}),headerAuthorContainer:Object(o.a)({marginTop:"8px",marginLeft:"14px",position:"relative",overflow:"hidden"}),headerRightCorner:Object(o.a)({marginLeft:"auto",marginRight:0,display:"flex",justifyContent:"flex-end",padding:"8px",boxSizing:"border-box",flexShrink:0}),headerItem:Object(o.a)({marginLeft:"5px"}),cancelDraft:Object(o.a)({marginLeft:"auto",marginRight:"0px",marginTop:"4px",width:"16px"}),iconCancelDraft:{rootHovered:Object(o.a)({color:i.a.GRAY_J},a.k),rootPressed:{color:i.a.GRAY_J},rootExpanded:{color:i.a.GRAY_J},rootFocused:Object(o.a)({color:i.a.GRAY_H,outline:"none",border:"1px dotted"},a.j),root:{height:"16px",marginTop:"-6px",width:"16px",padding:0,color:i.a.GRAY_E,border:"1px solid transparent",selectors:{".ms-Fabric--isFocusVisible &:focus::after":a.l,".ms-Button-flexContainer":{position:"relative"}}},icon:{width:12,height:12,margin:2,padding:0,border:0,lineHeight:12}},anchor:Object(o.a)({color:"#333333",fontWeight:"normal",fontFamily:"inherit",fontSize:"11px",lineHeight:"15px",minWidth:"12px",position:"relative",zIndex:20})}})},682:function(t,e,n){"use strict";n.d(e,"a",function(){return l}),n.d(e,"b",function(){return d}),n.d(e,"c",function(){return f});var o=n(136),r=n(267),i=n(26),a=n(201),s=n(82),c=n(519),l=30,d=1,p=Object(r.a)({root:Object(o.a)(c.a.ROOT,{margin:"8px 9px 8px 9px",maxHeight:14}),label:Object(o.a)(c.a.LABEL,{maxHeight:14}),checkbox:Object(o.a)(c.a.CHECKBOX,{height:"14px",width:"14px",borderRadius:"50%"}),checkmark:c.a.CHECKMARK,text:c.a.TEXT,input:c.a.INPUT}),u=Object(r.a)({root:{margin:"8px 9px 8px 9px",maxHeight:14},label:Object(o.a)(c.a.LABEL,{maxHeight:14}),checkmark:{color:s.a.GRAY_C},checkbox:{height:"14px",width:"14px",borderRadius:"50%",backgroundColor:s.a.WHITE,color:s.a.TASK_SEPARATOR},text:c.a.TEXT}),f=Object(i.b)(function(t){var e=Object(r.a)(p,{text:{color:Object(a.a)().primary,background:Object(a.a)().tint50,borderLeft:"3px solid",borderRight:"3px solid",borderColor:"transparent",borderRadius:"2px"}});return{taskHeaderContainer:Object(o.a)({borderBottomStyle:"solid",borderBottomWidth:d,borderColor:s.a.TASK_SEPARATOR,flexShrink:0,height:l}),taskHeaderCheckbox:t?u:p,taskHeaderCompletedCheckbox:Object(r.a)(t?u:p,{text:{textDecoration:"line-through"}}),taskHeaderAssignedToYouCheckbox:e,taskHeaderCompletedAssignedToYouCheckbox:Object(r.a)(e,{text:{textDecoration:"line-through"}})}})},683:function(t,e,n){"use strict";n.d(e,"b",function(){return u}),n.d(e,"g",function(){return f}),n.d(e,"e",function(){return m}),n.d(e,"a",function(){return y}),n.d(e,"c",function(){return g}),n.d(e,"j",function(){return b}),n.d(e,"k",function(){return v}),n.d(e,"f",function(){return T}),n.d(e,"d",function(){return O}),n.d(e,"m",function(){return S}),n.d(e,"l",function(){return P}),n.d(e,"i",function(){return I}),n.d(e,"h",function(){return k});var o=n(33),r=n(63),i=n(19),a=n(684),s=n(294),c=n(94),l=n(660),d=function(t,e){return e.resource.id},p=function(t,e){return e.componentTree.renderContextType},u=function(){return Object(r.a)([d,l.b],function(t,e){return e[t]})},f=function(){return Object(r.a)([d,l.f],function(t,e){return e===t})},h=function(t){return t.focusedComment},m=function(){return Object(r.a)([d,h],function(t,e){return e&&e.selectedCardId===t?e:void 0})},y=function(){return Object(r.a)([d,p,h,l.e],function(t,e,n,o){return Object(a.a)(t,e,n,o)})},g=function(){return Object(r.a)([d,l.e],function(t,e){return e[t]})},b=function(t){return Object(r.a)([d,l.c,l.d,t],function(t,e,n,o){return Object(s.b)(t,e,n,o)})},v=function(t){return Object(r.a)([t,l.i],function(t,e){return t.thread.reduce(function(t,n){return t[n.commentId]=e[n.commentId],t},{})})},C=function(t){return t.commentData[0]?t.commentData[0].commentId:void 0},x=function(t){return t.commentData.length},T=function(t){return Object(r.a)([d,C,x,t],function(t,e,n,o){return n?t===e:!!o.draftThreadWithSavedContent})},O=function(t){return Object(r.a)([t,h,p],function(t,e,n){return Object(s.a)(t,e,n)})},S=function(t){return Object(r.a)([t],function(t){return t===o.a.Enabled})},E=function(t){return t.contentExtensions},P=function(){return Object(r.a)([d,p,E],function(t,e,n){var r;return e===i.a.DiscreteIntegrated?void 0!==(r=n[o.c.Integrated])&&r.enabled:e===i.a.DiscreteIsolated&&(void 0!==(r=n[o.c.Isolated])&&r.provider.getExtension(t).enabled)})},w=function(t){return t.taskState},I=function(){return Object(r.a)([d,w],function(t,e){return e.tasks[t]})},k=function(t,e){return Object(r.a)([t,e],function(t,e){return Object(c.h)(t.thread,e)})}},684:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(13),r=n(17),i=n(16),a=n(310);function s(t,e,n,s){if(n&&Object(i.g)(n)){if(n.selectedCardId===t){if(o.j()&&s){var c=Object(r.z)(s);if(c&&c.renderContextType!==e)return a.a.InOtherContextOfThisCard}return Object(i.c)(n.focusDetails)?a.a.InCard:a.a.InChildPost}return a.a.InOtherCard}}},687:function(t,e,n){"use strict";var o=n(1);var r,i,a=n(0),s=a.createContext(void 0);!function(t){t[t.Forward=0]="Forward",t[t.Reverse=1]="Reverse"}(r||(r={})),function(t){t[t.Unfocused=0]="Unfocused",t[t.FocusOn=1]="FocusOn",t[t.FocusWithin=2]="FocusWithin"}(i||(i={}));!function(){function t(e){this.def=e,this.childNodes=[],this.focus=jest.fn(),this.blur=jest.fn(),this.childNodes=e.childNodes.map(function(e){return new t(e)})}t.prototype.getId=function(){return this.def.id},t.prototype.getData=function(){},t.prototype.getFocusState=function(){return this.def.isFocused?i.FocusOn:this.childNodes.some(function(t){return t.getFocusState()!==i.Unfocused})?i.FocusWithin:i.Unfocused},t.prototype.getNextTabTarget=function(t,e){return function(t,e,n){var o=t.getFocusState();if(o!==i.FocusOn||n||e!==r.Reverse){if((o===i.Unfocused||n)&&e===r.Forward&&t.isTabbable())return t;var a=t.getChildNodes();e===r.Reverse&&a.reverse();for(var s=n?0:a.findIndex(function(t){return t.getFocusState()!==i.Unfocused}),c=s>=0?s:0;c<a.length;++c){var l=a[c].getNextTabTarget(e,n);if(l)return l}return e===r.Reverse&&t.isTabbable()?t:void 0}}(this,t,e)},t.prototype.isTabbable=function(){return this.def.isTabbable},t.prototype.getChildNodes=function(){return this.childNodes.slice()},t.prototype.addChildNode=function(){throw new Error("Method not implemented.")},t.prototype.getDescendantById=function(t){var e,n;try{for(var r=o.j(this.childNodes),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.getId()===t)return a;for(var s=a.getIterator(),c=void 0;!(c=s.next()).done;)if(c.value.getId()===t)return c.value}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.getIterator=function(){return t=this,function(){var e,n,r,i,a,s,c,l;return o.e(this,function(d){switch(d.label){case 0:return[4,t];case 1:d.sent(),d.label=2;case 2:d.trys.push([2,8,9,10]),e=o.j(t.getChildNodes()),n=e.next(),d.label=3;case 3:if(n.done)return[3,7];r=n.value,i=r.getIterator(),a=void 0,d.label=4;case 4:return(a=i.next()).done?[3,6]:[4,a.value];case 5:return d.sent(),[3,4];case 6:return n=e.next(),[3,3];case 7:return[3,10];case 8:return s=d.sent(),c={error:s},[3,10];case 9:try{n&&!n.done&&(l=e.return)&&l.call(e)}finally{if(c)throw c.error}return[7];case 10:return[2]}})}();var t}}();var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registrationToken=void 0,e.onFocusStateChange=function(t){e.registrationToken&&e.registrationToken.onFocusStateChange(t)},e}return o.d(e,t),e.prototype.componentDidMount=function(){var t=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,function(){return t.props.position}))},e.prototype.componentWillUnmount=function(){this.registrationToken&&this.registrationToken.unregister(),this.registrationToken=void 0},e.prototype.render=function(){return a.Children.only(this.props.children)},e}(a.PureComponent),l=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registrationHelperRef=a.createRef(),e.onFocusStateChange=function(t){e.registrationHelperRef.current&&e.registrationHelperRef.current.onFocusStateChange(t)},e}o.d(e,t),e.prototype.render=function(){var t=this;return a.createElement(s.Consumer,null,function(e){return a.createElement(c,{parentNode:e,node:t.props.node,ref:t.registrationHelperRef,position:t.props.position},t.props.children)})}}(a.PureComponent),n(139)),d=n(330),p=n(65),u=n(186),f=n(71),h=n(43),m=n(339),y=n(13),g=n(29),b=n(3),v=function(){function t(){this.hasValue=!1,this.callbacks=[]}return t.prototype.set=function(t){this.value=t,this.hasValue=!0,this.callbacks.forEach(function(e){return e(t)}),this.callbacks=[]},t.prototype.getValue=function(t){var e=this;if(this.hasValue)try{return Promise.resolve(t(this.value))}catch(t){return Promise.reject(t)}return new Promise(function(n,o){e.callbacks.push(function(e){try{n(t(e))}catch(t){o(t)}})})},t}(),C=n(127),x=n(309);var T,O=n(380),S=n(32),E=n(174),P=n(17),w=n(108),I=n(16),k=n(62),R=n(74),A=n(688),D=n(642),j=n(310);!function(t){t[t.NoDialog=0]="NoDialog",t[t.AbandonDraft=1]="AbandonDraft",t[t.ResumeDrafting=2]="ResumeDrafting"}(T||(T={}));var N=T,M=n(123),_=n(306),B=n(19),L=n(95),F=n(25),H=n(129),U=n(684),z=n(657),V=n(648),q=n(50),K=n(157),G=n(94),W=n(659);function Y(t){if(t.topVisibleThread&&t.componentTree.renderContextType!==B.a.HalfPane&&!t.focusedCommentInfo)return t.topVisibleThread.cardId}n.d(e,"b",function(){return Y});var Q=function(t){function e(e){var n,o,r,i,s,c,l,d,p=t.call(this,e)||this;p.liveRegionRef=a.createRef(),p.initialAtMentionCapability=new v,p.cardOnBeginReplyCallback=p.cardOnBeginReplyCallback.bind(p),p.cardOnCreate=p.cardOnCreate.bind(p),p.cardOnDelete=p.cardOnDelete.bind(p),p.cardOnHighlight=p.cardOnHighlight.bind(p),p.cardOnPostReply=p.cardOnPostReply.bind(p),p.cardOnReopenThread=p.cardOnReopenThread.bind(p),p.cardOnResolveThread=p.cardOnResolveThread.bind(p),p.cardOnSelectExpandCallback=p.cardOnSelectExpandCallback.bind(p),p.cardOnSaveDraft=p.cardOnSaveDraft.bind(p),p.closePane=p.closePane.bind(p),p.getCommentPostStyleOptions=p.getCommentPostStyleOptions.bind(p),p.onCardDraftCancel=p.onCardDraftCancel.bind(p),p.onCardReplyCancel=p.onCardReplyCancel.bind(p),p.onCommentUIAction=p.onCommentUIAction.bind(p),p.onGetUserContacts=p.onGetUserContacts.bind(p),p.onMentionCreated=p.onMentionCreated.bind(p),p.onPostCancel=p.onPostCancel.bind(p),p.onPostCommit=p.onPostCommit.bind(p),p.onPostDelete=p.onPostDelete.bind(p),p.onPostEdit=p.onPostEdit.bind(p),p.onRootPostEdit=p.onRootPostEdit.bind(p),p.onPostSaveDraft=p.onPostSaveDraft.bind(p),p.onRenderableItemSelect=p.onRenderableItemSelect.bind(p),p.onCurrentMentionsUpdated=p.onCurrentMentionsUpdated.bind(p),p.onSelectedTaskAssigneeUpdated=p.onSelectedTaskAssigneeUpdated.bind(p),p.renderCommentThread=p.renderCommentThread.bind(p),p.cardOnDraftingInputSizeChange=p.cardOnDraftingInputSizeChange.bind(p),p.cardOnEditorFocusLost=p.cardOnEditorFocusLost.bind(p),p.onGhostCommentClicked=p.onGhostCommentClicked.bind(p),p.cardOnFocusNextTabStop_deprecated=p.cardOnFocusNextTabStop_deprecated.bind(p),p.cardOnFocusPreviousTabStop_deprecated=p.cardOnFocusPreviousTabStop_deprecated.bind(p),p.getContentManagerRef=p.getContentManagerRef.bind(p),p.closePaneNoDialog=p.closePaneNoDialog.bind(p),p.onLowFidelityWarningCancel=p.onLowFidelityWarningCancel.bind(p),p.onLowFidelityWarningConfirm=p.onLowFidelityWarningConfirm.bind(p),p.onCommentInterruptableCommandTypeReceived=p.onCommentInterruptableCommandTypeReceived.bind(p),p.invokeModalDialog=p.invokeModalDialog.bind(p),p.deleteThreadConfirmCallback=p.deleteThreadConfirmCallback.bind(p),p.getOnWillDiscardCallback=p.getOnWillDiscardCallback.bind(p),p.onCardHeaderButtonPressed=p.onCardHeaderButtonPressed.bind(p),p.getCommentCardTaskHeaderProps=Object(x.a)(p.getCommentCardTaskHeaderProps.bind(p)),p.isReadyToRender=p.isReadyToRender.bind(p),p.commentPostCallbackProps={onDelete:p.onPostDelete,onEdit:p.onPostEdit,onCommit:p.onPostCommit,onCancel:p.onPostCancel,onSelect:p.onRenderableItemSelect,onSaveDraft:p.onPostSaveDraft},p.onLoadThreads=(n=p.reduceLoadThreadIds.bind(p),o=p.debounceLoadThreadIds.bind(p),r=Array,i=500,l=r(),d=function(){var t=o(l);t?(l=t,c=setTimeout(d,i)):(l=r(),c=void 0)},function(t){l=n(l,t),c||s||(c=setTimeout(d,0)),c||(c=setTimeout(d,s||i))}),p.postActionBarItems=W.d(p.props.localizationAPI,p.commentPostCallbackProps,Object(K.a)()),p.cardContextMenuItems=W.b(p.props.localizationAPI,{onReopenThread:p.cardOnReopenThread,onResolveThread:p.cardOnResolveThread,onDeleteThread:p.cardOnDelete,onEditRootPost:p.onRootPostEdit},Object(K.a)()),p.paneContainerKeyDownHandler=p.props.focusManager.paneContainerKeyDown(function(){return p.props.componentTree}),p.commentContentsKeyDownHandler=p.props.focusManager.commentContentsKeyDown(function(){return p.props.componentTree},y.a()?function(){return p.props.dataItems}:void 0);var u=Object(b.g)().createActivityObject("BaseCommentPaneConstruction",p.props.telemetryVisitor,b.a.None);return p.correlationId=Object(C.a)(),u.addDataField(b.c.PaneCorrelationId,p.correlationId,b.d.SystemMetadata),u.addDataField(b.c.SharedCommentsVersion,O.a,b.d.SystemMetadata),u.successTag(595906901),p}return o.d(e,t),e.prototype.onCommentUIAction=function(t){return t.actionType===p.a.BackKeyPressed?(Object(b.g)().assertConditionTag(Object(h.d)(t.actionBehavior),"This action type does not support toggled/enabled status",595918947),Object(h.d)(t.actionBehavior)&&this.onBackKeyPressed(),h.a.Success):h.a.NotHandled},e.prototype.onCommentInterruptableCommandTypeReceived=function(t,e){switch(t){case d.a.DiscardDraft:if(Object(m.a)(e)){var n=void 0;return e.isCancellable&&this.props.focusedCommentInfo&&(n=this.getOnWillDiscardCallback(this.props.focusedCommentInfo.focusedComment,this.getCancelModalDialogMode())),this.props.discardDraftAsync({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595883617)},S.a.Canvas,this.shouldClosePaneAfterDiscardDraft(),n)}return Object(b.g)().assertConditionTag(!1,"Wrong payload type for Discard Draft Command",595981063),Promise.resolve(u.a.Unhandled);default:return Object(b.g)().assertConditionTag(!1,"Unknown type of CommentInterruptableCommand",595981064),Promise.resolve(u.a.Unhandled)}},e.prototype.discardDraftAsync_deprecated=function(t,e,n,o){var r=this,i=void 0;if(this.props.focusedCommentInfo&&this.props.focusedCommentInfo.focusedComment&&e&&(!Object(I.c)(this.props.focusedCommentInfo.focusedComment.focusDetails)||this.shouldDisplayDiscardDialogBasedOnCardContent(this.props.focusedCommentInfo.focusedComment.selectedCardId))){var a=this.props.focusedCommentInfo.focusedComment,s=void 0!==o?o:this.getCancelModalDialogMode_deprecated(a,this.props.createdCommentLie);i=function(t,e){return r.invokeModalDialog(s,t,e)}}return this.props.discardDraftAsync({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595953798)},t,n,i)},e.prototype.getOnWillDiscardCallback=function(t,e){var n=this;if(t)return!Object(I.c)(t.focusDetails)||this.shouldDisplayDiscardDialogBasedOnCardContent(t.selectedCardId)?function(t,o){return n.invokeModalDialog(e,t,o)}:void 0},e.prototype.updateDraftRenderLocks=function(t){0!==Object.keys(this.props.draftState).length&&this.props.updateRenderLocksForAllDrafts({renderContextType:this.props.componentTree.renderContextType,trackback:b.f.reserveTag(595857630),telemetryVisitor:this.props.telemetryVisitor},t)},e.prototype.componentDidMount=function(){this.props.registerComponentUIActionListener(this.onCommentUIAction),this.props.registerComponentInterruptableCommandListener(this.onCommentInterruptableCommandTypeReceived),this.props.atMentionState.capability!==w.a.Unknown&&this.processAtMentionCapabilityState(),this.updateDraftRenderLocks(!0)},e.prototype.componentWillUnmount=function(){this.props.unregisterComponentUIActionListener(this.onCommentUIAction),this.props.unregisterComponentInterruptableCommandListener(this.onCommentInterruptableCommandTypeReceived),this.updateDraftRenderLocks(!1)},e.prototype.componentDidUpdate=function(t,e){var n,r;if(void 0!==t.cardViewStates[R.a]&&void 0===this.props.cardViewStates[R.a]&&this._contentManager&&this._contentManager.clearPersistedContent(Object(q.m)(R.a)),this.props.lastContextChangeIncrement!==t.lastContextChangeIncrement&&this.onContextChanged(),this.props.atMentionState.capability!==t.atMentionState.capability&&this.processAtMentionCapabilityState(),this.sendReadyToRenderNotification(t),this.props.draftState!==t.draftState)try{for(var i=o.j(Object.keys(this.props.draftState)),a=i.next();!a.done;a=i.next()){var s=a.value;if(void 0===t.draftState[s]||t.draftState[s].renderContextType!==this.props.draftState[s].renderContextType){this.updateDraftRenderLocks(!0);break}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.cardOnCreate=function(t){z.b(b.f.reserveTag(595869981),t,this.tryGetFocusedComment(),this.props.atMentionState.capability===w.a.Enabled,{type:"CREATE"},this.props.componentTree,this.props,this.getLiveRegion(),this.props.telemetryVisitor,this.props.cardViewStates[t.getId()]&&this.props.cardViewStates[t.getId()].selectedTaskAssignee)},e.prototype.cardOnPostReply=function(t){z.b(b.f.reserveTag(595869982),t,this.tryGetFocusedComment(),this.props.atMentionState.capability===w.a.Enabled,{type:"REPLY",parentId:t.getId()},this.props.componentTree,this.props,this.getLiveRegion(),this.props.telemetryVisitor,this.props.cardViewStates[t.getId()]&&this.props.cardViewStates[t.getId()].selectedTaskAssignee)},e.prototype.cardOnSelectExpandCallback=function(t){z.k(b.f.reserveTag(595869983),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnSelectCollapseCallback=function(t){z.j(b.f.reserveTag(595869984),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnBeginReplyCallback=function(t){y.t()&&this.discardEmptyDraftIfExists(),z.a(b.f.reserveTag(595869985),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnResolveThread=function(t,e){z.i(b.f.reserveTag(595869986),t,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor,e)},e.prototype.cardOnReopenThread=function(t,e){z.h(b.f.reserveTag(595869987),t,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor,e)},e.prototype.cardOnDelete=function(t,e){z.c(b.f.reserveTag(595870016),t,this.props.componentTree.renderContextType,this.invokeModalDialog,this.deleteThreadConfirmCallback,this.props,this.getLiveRegion(),this.props.telemetryVisitor,e)},e.prototype.cardOnDraftingInputSizeChange=function(t,e){z.e(b.f.reserveTag(595870017),t.getId(),e,this.props.componentTree.renderContextType,this.tryGetFocusedComment(),this.props,this.props.telemetryVisitor)},e.prototype.cardOnEditorFocusLost=function(t){z.f(b.f.reserveTag(595870018),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnSaveDraft=function(t){y.r()&&z.o(b.f.reserveTag(595870019),t,this.props.componentTree.renderContextType,this.props.cardViewStates,this.props,this.props.telemetryVisitor)},e.prototype.onCardReplyCancel=function(t){var e=this.props.componentTree.renderContextType===B.a.HalfPane&&t.draftHasContent(),n=this.tryGetFocusedComment();z.d(b.f.reserveTag(595870020),e,n,this.getCancelModalDialogMode(),this.getOnWillDiscardCallback,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),!1,n?this.props.cardViewStates[n.selectedCardId]:void 0,this.props.draftState,this.props.telemetryVisitor)},e.prototype.onCardDraftCancel=function(t){var e=this.props.componentTree.renderContextType===B.a.HalfPane&&t.draftHasContent(),n=this.tryGetFocusedComment();z.d(b.f.reserveTag(595870021),e,n,this.getCancelModalDialogMode(),this.getOnWillDiscardCallback,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.shouldClosePaneAfterDiscardDraft(),n?this.props.cardViewStates[n.selectedCardId]:void 0,this.props.draftState,this.props.telemetryVisitor)},e.prototype.onCardHeaderButtonPressed=function(t){if(y.a()){var e=this.props.taskState.tasks[t];e&&z.l(b.f.reserveTag(595726990),e.commentId,e.currentState,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor)}},e.prototype.onCardDraftingCancelInner_deprecated=function(t,e,n){this.isCommitPending_deprecated()||this.discardDraftAsync_deprecated(t,e,this.shouldClosePaneAfterDiscardDraft())},e.prototype.cardOnHighlight=function(t){z.g(b.f.reserveTag(595870022),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.onRootPostEdit=function(t){this.onPostEditInner(t)},e.prototype.onPostDelete=function(t){this.onPostDeleteInner(t.getId())},e.prototype.onPostEdit=function(t){this.onPostEditInner(t.getId())},e.prototype.onPostCommit=function(t){z.s(b.f.reserveTag(595870023),t.getId(),this.props.dataItems,this.tryGetFocusedComment(),t.getContentsAsync(),this.props.atMentionState.capability===w.a.Enabled,this.props.componentTree,this.props,this.getLiveRegion(),this.props.telemetryVisitor)},e.prototype.onPostCancel=function(t){var e=this.tryGetFocusedComment();z.r(b.f.reserveTag(595870024),t.getId(),t.setContents,this.props.dataItems,e,this.shouldClosePaneAfterDiscardDraft(),this.showDiscardDialogOnPostCancel()?this.getOnWillDiscardCallback(e,this.getCancelModalDialogMode()):void 0,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor)},e.prototype.onPostSaveDraft=function(t){y.r()&&z.o(b.f.reserveTag(595870025),t,this.props.componentTree.renderContextType,this.props.postViewStates,this.props,this.props.telemetryVisitor)},e.prototype.onRenderableItemSelect=function(t){y.t()&&this.discardEmptyDraftIfExists();var e=t.getId(),n=e===R.a?this.props.createdCommentLie&&{commentModel:this.props.createdCommentLie.newComment}:this.props.dataItems.find(function(t){return G.d(t)===e});n?z.v(b.f.reserveTag(595870027),n,this.props.dataItems,this.tryGetFocusedComment(),this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor):Object(b.g)().assertConditionTag(!1,"Selection coming from an unknown post?",595870026)},e.prototype.closePane=function(){var t=this;if(this.props.componentTree.renderContextType!==B.a.HalfPane&&this.props.focusedCommentInfo&&this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===I.a.Active&&!y.j()){this.props.discardDraftAsync({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595883650)},S.a.SharedComments,!0,this.getOnWillDiscardCallback(this.props.focusedCommentInfo.focusedComment,_.a.ClosePaneDraft)).then(function(e){e===u.a.Canceled?t.onCloseCanceled():e===u.a.Unhandled&&Object(b.g)().assertConditionTag(e!==u.a.Unhandled,"Unhandled request to discard on close pane",595981077)})}else this.closePaneNoDialog()},e.prototype.onCloseCanceled=function(){},e.prototype.renderCommentThread=function(t,e){var n=G.f(t);if(Object(g.a)().isFeatureEnabled("RenderDHCInPane"))return a.createElement(A.a,{commentAPI:this.props.commentAPI,componentTree:this.props.componentTree,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:{id:n.commentId},getDiscardDraftCallback:this.getOnWillDiscardCallback,telemetryVisitor:this.props.telemetryVisitor,accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize});var o=!(!this.props.createdCommentLie||n.commentId!==this.props.createdCommentLie.newComment.commentId),r=0===this.props.dataItems.length||G.f(this.props.dataItems).commentId===n.commentId,i=void 0!==this.props.focusedCommentInfo?this.props.focusedCommentInfo.focusedComment:void 0,s=this.getMentionableCommentEditorProps(this.props.atMentionState.capability,this.props.atMentionState.authToken),c=this.getCommentCardStyleOptions(n.commentId),d=n.commentId,p=!!(n.commentFlags&l.a.Resolved),u=this.props.taskState.tasks[d]?this.getCommentCardTaskHeaderProps(d,this.props.taskState.tasks[d].currentState,this.props.localizationAPI,this.props.componentTree.renderContextType,p,c.restrictActionControls):void 0;return V.g(t,u,this.props.cardViewStates,this.props.postViewStates,this.commentPostCallbackProps,s,this.getCommentCardCallbacksForParentThread(n,i,s,!!u),c,this.getCommentPostStyleOptions,this.props.componentTree.renderContextType===B.a.FullPane,this.props.localizationAPI,this.postActionBarItems,r,i,this.props.componentTree.renderContextType===B.a.HalfPane,!!s,o,this.props.readOnly,this.getKeyboardingOptions(),this.props.personaIconPropertiesMap,this.props.draftState,Object(U.a)(n.commentId,this.props.componentTree.renderContextType,i,this.props.draftState),e,void 0)},e.prototype.onMentionCreated=function(t){z.n(b.f.reserveTag(595870029),b.f.reserveTag(595870030),t,this.props,this.props.telemetryVisitor)},e.prototype.onCurrentMentionsUpdated=function(t){y.a()&&z.p(b.f.reserveTag(595724293),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.onSelectedTaskAssigneeUpdated=function(t){y.a()?z.q(b.f.reserveTag(595724293),this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor,t):Object(b.g)().assertConditionTag(!1,"Selected Task Assignee Updated action type is not supported",595687517)},e.prototype.reduceLoadThreadIds=function(t,e){var n=this,o=e.filter(function(t){return n.props.cardViewStates[t]&&(n.props.cardViewStates[t].loadState===k.a.Placeholder||n.props.cardViewStates[t].loadState===k.a.NeedsReload)});return o.length?(o.forEach(function(e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}),t.concat(o)):t},e.prototype.debounceLoadThreadIds=function(t){var e=t.splice(-20,20);if(e.length)return this.onRequestLoadThreads(e),t.length?t:void 0},e.prototype.shouldClosePaneAfterDiscardDraft=function(){return!(!this.props.focusedCommentInfo||this.props.focusedCommentInfo.focusedComment.selectedCardId!==R.a||this.props.componentTree.renderContextType!==B.a.HalfPane||void 0!==this.props.focusedThreadIdBeforeCommentSession)},e.prototype.discardEmptyDraftIfExists=function(){this.props.focusedCommentInfo&&this.props.focusedCommentInfo.focusedComment&&Object(I.c)(this.props.focusedCommentInfo.focusedComment.focusDetails)&&Object(I.g)(this.props.focusedCommentInfo.focusedComment)&&!this.doesDraftHaveContent(this.props.focusedCommentInfo.focusedComment.selectedCardId)&&this.props.discardDraftAsync({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595718223)},S.a.SharedComments,!1)},e.prototype.doesDraftHaveContent=function(t){var e,n,o,r=this.getComponentTree().getComponentById({componentType:F.b.Card,id:t,renderContextType:this.props.componentTree.renderContextType}),i=void 0;return(e=r)&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&(n=e)&&n.focus&&n.blur&&(i=r.getData()),Object(b.g)().assertConditionTag(void 0!==i,"Unable to get comment card from pane component tree",595952453),void 0===i||!(void 0!==(o=i)&&void 0!==o.getId&&void 0!==o.getContentsAsync&&void 0!==o.getCursorPositionAsync&&void 0!==o.draftHasContent)||i.draftHasContent()},e.prototype.shouldDisplayDiscardDialogBasedOnCardContent=function(t){return this.doesDraftHaveContent(t)},e.prototype.onBackKeyPressed=function(){if(this.props.focusedCommentInfo&&Object(I.g)(this.props.focusedCommentInfo.focusedComment)){var t=this.props.focusedCommentInfo.focusedComment;if(Object(I.c)(t.focusDetails)){if(y.i()){var e=this.shouldDisplayDiscardDialogBasedOnCardContent(t.selectedCardId);return void z.d(b.f.reserveTag(595870021),e,this.tryGetFocusedComment(),this.getCancelModalDialogMode(),this.getOnWillDiscardCallback,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.shouldClosePaneAfterDiscardDraft(),t?this.props.cardViewStates[t.selectedCardId]:void 0,this.props.draftState,this.props.telemetryVisitor)}t.selectedCardId===R.a?this.onBackKeyCancelCreateThread_deprecated(t.selectedCardId):this.onBackKeyCancelCardReply_deprecated(t.selectedCardId)}else{if(y.i())return void z.r(b.f.reserveTag(595870024),t.focusDetails.selectedPostId,void 0,this.props.dataItems,t,this.shouldClosePaneAfterDiscardDraft(),this.getOnWillDiscardCallback(t,this.getCancelModalDialogMode()),this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor);this.props.discardDraftAsync({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595953799)},S.a.SharedComments,!1,this.getOnWillDiscardCallback(this.props.focusedCommentInfo.focusedComment,this.getCancelModalDialogMode()))}}else this.props.componentTree.renderContextType===B.a.HalfPane&&this.closePane()},e.prototype.onPostDeleteInner=function(t){z.t(b.f.reserveTag(595870031),t,this.props.dataItems,this.tryGetFocusedComment(),this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor)},e.prototype.sendReadyToRenderNotification=function(t){this.props.initializationStatus===M.a.Initialized&&(this.props.componentTree.renderContextType===t.componentTree.renderContextType&&this.props.initializationStatus===t.initializationStatus||this.props.readyToRender({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595928259)}))},e.prototype.deleteThreadConfirmCallback=function(){return this.props.focusedCommentInfo?(this.props.requestDeleteThread({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595953811)},this.props.focusedCommentInfo.focusedComment.selectedCardId),u.a.Handled):(Object(b.g)().assertConditionTag(!1,"Focused Comment should not be undefined for DeleteThread",595981071),u.a.Unhandled)},e.prototype.isCommitPending_deprecated=function(){return!!this.props.focusedCommentInfo&&Object(I.d)(this.props.focusedCommentInfo.focusedComment)},e.prototype.onPostEditInner=function(t){z.u(b.f.reserveTag(595870032),t,this.props.dataItems,this.tryGetFocusedComment(),this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.processAtMentionCapabilityState=function(){Object(g.a)().isFeatureEnabled("LivePersonaPicker")||this.props.refreshAtMentionAuthToken(),y.G()&&this.props.atMentionState.capability!==w.a.Unknown&&this.initialAtMentionCapability.set(this.props.atMentionState.capability),this.onAtMentionCapabilityStateChange()},e.prototype.getResolveSupported=function(){return y.D()?this.props.capabilities.resolve:this.props.commentAPI.resolveSupported()},e.prototype.getUpdatedItemThreads=function(t){var e=V.f(this.props.draftState,this.props.componentTree.renderContextType),n=V.f(t.draftState,t.componentTree.renderContextType);return this.props.dataItems!==t.dataItems||this.props.createdCommentLie!==t.createdCommentLie||this.props.cardViewStates!==t.cardViewStates||this.props.postViewStates!==t.postViewStates||this.props.componentTree.renderContextType!==t.componentTree.renderContextType||this.props.personaIconPropertiesMap!==t.personaIconPropertiesMap||e!==n?V.a(t.dataItems,t.cardViewStates,t.postViewStates,t.createdCommentLie,t.componentTree.renderContextType!==B.a.HalfPane,n):this.state.allRenderableItemThreads},e.prototype.getInitialState=function(t){return{allRenderableItemThreads:V.a(t.dataItems,t.cardViewStates,t.postViewStates,t.createdCommentLie,t.componentTree.renderContextType!==B.a.HalfPane,V.f(t.draftState,t.componentTree.renderContextType)),atMentionState:void 0}},e.prototype.getCommentCardCallbacksForParentThread=function(t,e,n,o){var r=W.c(this.cardContextMenuItems,t,this.getResolveSupported(),Object(I.e)(t,e),o),i=this.props.createdCommentLie&&t.commentId===this.props.createdCommentLie.newComment.commentId;return{onEditorFocus:this.cardOnBeginReplyCallback,onCardSelectExpand:this.cardOnSelectExpandCallback,onCardSelectCollapse:this.cardOnSelectCollapseCallback,onCardHighlight:this.cardOnHighlight,onDraftingInputSizeChange:this.cardOnDraftingInputSizeChange,mentionEditorProps:n,menuItems:r,onEditorBlur:this.cardOnEditorFocusLost,onFocusNextTabStop_deprecated:this.cardOnFocusNextTabStop_deprecated,onFocusPreviousTabStop_deprecated:this.cardOnFocusPreviousTabStop_deprecated,onCancel:i?this.onCardDraftCancel:this.onCardReplyCancel,onPost:i?this.cardOnCreate:this.cardOnPostReply,onSaveDraft:this.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:this.onSelectedTaskAssigneeUpdated}},e.prototype.onBackKeyCancelCreateThread_deprecated=function(t){var e=this.shouldDisplayDiscardDialogBasedOnCardContent(t);this.onCardDraftingCancelInner_deprecated(S.a.SharedComments,e,b.f.reserveTag(595715163))},e.prototype.onBackKeyCancelCardReply_deprecated=function(t){var e=this.shouldDisplayDiscardDialogBasedOnCardContent(t);this.onCardDraftingCancelInner_deprecated(S.a.SharedComments,e,b.f.reserveTag(595715165))},e.prototype.warnIfLowFidelity_deprecated=function(t,e){if(!this.props.focusedCommentInfo)return!1;var n=!t.parentId,o=t.commentFlags&l.a.LowFidelity||n&&e===I.a.LowFidelityWarningOnDelete&&this.props.dataItems.some(function(e){return Object(L.a)(e)&&e.commentModel.parentId===t.commentId&&!!(e.commentModel.commentFlags&l.a.LowFidelity)}),r=Object(I.c)(this.props.focusedCommentInfo.focusedComment.focusDetails)?this.props.focusedCommentInfo.focusedComment.selectedCardId:this.props.focusedCommentInfo.focusedComment.focusDetails.selectedPostId;return!(!o||r===t.commentId&&this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===e)&&(this.props.showLowFidelityWarning({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595953816)},t.commentId,e),!0)},e.prototype.closePaneNoDialog=function(){var t=Object(b.g)().createActivityObject("ClosePane",this.props.telemetryVisitor,b.a.None);t.addDataField(b.c.PaneCloseResult,N.NoDialog,b.d.SystemMetadata),t.successTag(595981209),this.props.requestClosePane({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595928261)})},e.prototype.onRequestLoadThreads=function(t){this.props.virtualized?this.props.requestLoadThreads({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595953824)},t):Object(b.g)().assertConditionTag(this.props.virtualized,"onRequestLoadThreads called for non-virtualized store",595981076)},e.prototype.onLowFidelityWarningCancel=function(){if(!this.props.focusedCommentInfo||this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession!==I.a.LowFidelityWarningOnDelete&&this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession!==I.a.LowFidelityWarningOnEdit)Object(b.g)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",595981078);else{var t=this.props.focusedCommentInfo.focusedComment.selectedCardId;Object(P.A)(t,this.props.focusedCommentInfo.focusedComment)?this.props.selectCommentCardExpand({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595953825)},t,S.a.SharedComments):this.props.selectCommentCardCollapse({renderContextType:this.props.componentTree.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:b.f.reserveTag(595953826)},t,S.a.SharedComments)}},e.prototype.onLowFidelityWarningConfirm=function(){if(this.props.focusedCommentInfo)if(Object(I.c)(this.props.focusedCommentInfo.focusedComment.focusDetails)){if(this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===I.a.LowFidelityWarningOnDelete){var t=this.props.focusedCommentInfo.focusedComment.selectedCardId;return void this.cardOnDelete(t)}if(this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===I.a.LowFidelityWarningOnEdit)return void Object(b.g)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",595981080)}else{t=this.props.focusedCommentInfo.focusedComment.focusDetails.selectedPostId;if(this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===I.a.LowFidelityWarningOnDelete)return void this.onPostDeleteInner(t);if(this.props.focusedCommentInfo.focusedComment.focusDetails.editingSession===I.a.LowFidelityWarningOnEdit)return void this.onPostEditInner(t)}else Object(b.g)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",595981079)},e.prototype.getCancelModalDialogMode=function(){var t=void 0!==this.props.focusedCommentInfo?this.props.focusedCommentInfo.focusedComment:void 0;return t?Object(I.c)(t.focusDetails)?this.props.createdCommentLie&&this.props.createdCommentLie.newComment.commentId===t.selectedCardId?_.a.CancelNewDraft:_.a.CancelReplyDraft:_.a.CancelPostEdit:(Object(b.g)().assertConditionTag(!1,"ModalDialogMode determination requires focused comment. Defaulting to ClosePaneDraft.",595883653),_.a.ClosePaneDraft)},e.prototype.getCancelModalDialogMode_deprecated=function(t,e){return Object(I.c)(t.focusDetails)?e&&e.newComment.commentId===t.selectedCardId?_.a.CancelNewDraft:_.a.CancelReplyDraft:_.a.CancelPostEdit},e.prototype.shouldShowGhostComment=function(){return this.props.componentTree.renderContextType===B.a.FullPane&&this.props.nextPopulatedContextDetails!==f.a.Unknown&&this.props.nextPopulatedContextDetails!==f.a.NoComments&&this.props.nextPopulatedContextDetails!==f.a.OnlyCommentsInCurrent},e.prototype.getContentManagerRef=function(t){this._contentManager=t},e.prototype.onGhostCommentClicked=function(){this.props.selectionManager.selectAcrossContexts(H.a.Next,this.props.componentTree.renderContextType)},e.prototype.tryGetFocusedComment=function(){if(this.props.focusedCommentInfo)return this.props.focusedCommentInfo.focusedComment},e.prototype.getRestrictActionControls=function(t,e){var n=void 0!==this.props.focusedCommentInfo?this.props.focusedCommentInfo.focusedComment:void 0,o=e||t;if(this.props.componentTree.renderContextType===B.a.FullPane&&D.a.Collapsed===V.b(o,n))return!0;if(y.b()){var r=Object(U.a)(e,this.props.componentTree.renderContextType,n,this.props.draftState);return void 0!==n&&void 0!==r&&(r!==j.a.InChildPost||!Object(I.f)(n.focusDetails)||n.focusDetails.selectedPostId!==t)}return!(!n||Object(I.c)(n.focusDetails)||!Object(I.i)(n.focusDetails)||n.focusDetails.selectedPostId===t)||!!(n&&Object(I.c)(n.focusDetails)&&Object(I.i)(n.focusDetails))},e.prototype.getLiveRegion=function(){return this.liveRegionRef.current},e.prototype.getCommentCardTaskHeaderProps=function(t,e,n,o,r,i){return V.d(t,e,n,o,r,i,this.onCardHeaderButtonPressed)},e.prototype.isReadyToRender=function(){return Object(E.a)({commentData:G.b(this.props.dataItems),pendingCommentLoad:this.props.pendingCommentLoad,virtualized:this.props.virtualized})},e}(a.Component);e.a=Q},688:function(t,e,n){"use strict";var o=n(91),r=n(13),i=n(210),a=n(3),s=n(20),c=n(32),l=n(678),d=n(679),p=n(656),u=n(315),f=n(19),h=n(1),m=n(601),y=n(0),g=n(139),b=n(309),v=n(17),C=n(108),x=n(16),T=n(642),O=n(310),S=n(306),E=n(645),P=n(25),w=n(646),I=n(680),k=n(657),R=n(304),A=n(648);var D=n(157),j=n(94),N=n(659),M=function(t){function e(e){var n=t.call(this,e)||this;n.liveRegionRef=y.createRef(),n.cardOnBeginReplyCallback=n.cardOnBeginReplyCallback.bind(n),n.cardOnCreate=n.cardOnCreate.bind(n),n.cardOnDelete=n.cardOnDelete.bind(n),n.cardOnHighlight=n.cardOnHighlight.bind(n),n.cardOnPostReply=n.cardOnPostReply.bind(n),n.cardOnReopenThread=n.cardOnReopenThread.bind(n),n.cardOnResolveThread=n.cardOnResolveThread.bind(n),n.cardOnSelectExpandCallback=n.cardOnSelectExpandCallback.bind(n),n.onCardReplyCancel=n.onCardReplyCancel.bind(n),n.onCardDraftCancel=n.onCardDraftCancel.bind(n),n.cardOnDraftingInputSizeChange=n.cardOnDraftingInputSizeChange.bind(n),n.cardOnEditorFocusLost=n.cardOnEditorFocusLost.bind(n),n.cardOnFocusNextTabStop_deprecated=n.cardOnFocusNextTabStop_deprecated.bind(n),n.cardOnFocusPreviousTabStop_deprecated=n.cardOnFocusPreviousTabStop_deprecated.bind(n),n.cardOnSaveDraft=n.cardOnSaveDraft.bind(n),n.getLiveRegion=n.getLiveRegion.bind(n),n.cardOnHeaderButtonPressed=n.cardOnHeaderButtonPressed.bind(n),n.showDiscardDialogOnPostCancel=n.showDiscardDialogOnPostCancel.bind(n),n.getCancelModalDialogMode=n.getCancelModalDialogMode.bind(n),n.getMentionableCommentEditorProps=Object(b.a)(n.getMentionableCommentEditorProps.bind(n)),n.getCommentCardTaskHeaderProps=Object(b.a)(n.getCommentCardTaskHeaderProps.bind(n)),n.onGetUserContacts=n.onGetUserContacts.bind(n),n.onMentionCreated=n.onMentionCreated.bind(n),n.onCurrentMentionsUpdated=n.onCurrentMentionsUpdated.bind(n),n.onSelectedTaskAssigneeUpdated=n.onSelectedTaskAssigneeUpdated.bind(n),n.onPostCancel=n.onPostCancel.bind(n),n.onPostCommit=n.onPostCommit.bind(n),n.onPostDelete=n.onPostDelete.bind(n),n.onPostEdit=n.onPostEdit.bind(n),n.onPostSaveDraft=n.onPostSaveDraft.bind(n),n.onRenderableItemSelect=n.onRenderableItemSelect.bind(n),n.getCommentPostStyleOptions=n.getCommentPostStyleOptions.bind(n),n.onRootPostEdit=n.onRootPostEdit.bind(n),n.commentPostCallbackProps={onDelete:n.onPostDelete,onEdit:n.onPostEdit,onCommit:n.onPostCommit,onCancel:n.onPostCancel,onSelect:n.onRenderableItemSelect,onSaveDraft:n.onPostSaveDraft},n.contextualMenuCallbackProps={onReopenThread:n.cardOnReopenThread,onResolveThread:n.cardOnResolveThread,onDeleteThread:n.cardOnDelete,onEditRootPost:n.onRootPostEdit};var o=Object(D.a)();return n.postActionBarItems=N.d(n.props.localizationAPI,n.commentPostCallbackProps,o),n.cardContextMenuItems=N.b(n.props.localizationAPI,n.contextualMenuCallbackProps,o),n.commentContentsKeyDownHandler=n.props.focusManager.commentContentsKeyDown(function(){return n.props.componentTree},r.a()?function(){return n.props.dataItems}:void 0),n}return h.d(e,t),e.prototype.focus=function(){var t=this;setTimeout(function(){return t.props.focusManager.focusCommentCardCommand(t.props.componentTree,t.props.threadId)},0),this.props.selectCommentCardExpand({renderContextType:this.props.componentTree.renderContextType,trackback:a.f.reserveTag(595907589),telemetryVisitor:this.props.telemetryVisitor},this.props.threadId,c.a.Canvas)},e.prototype.shouldComponentUpdate=function(t,n){return e.havePropsMeaningfullyChanged(t,this.props)},e.prototype.updateDraftRenderLockIfApplicable=function(t){if(this.props.focusState&&Object(x.g)(this.props.focusState)){var e=Object(v.z)(this.props.draftState);e&&this.props.updateRenderLockForDraft({renderContextType:this.props.componentTree.renderContextType,trackback:a.f.reserveTag(595857629),telemetryVisitor:this.props.telemetryVisitor},t,e.commentDraft.sessionConfiguration.draftId)}},e.prototype.componentDidMount=function(){this.props.componentRef&&this.props.componentRef(this),this.updateDraftRenderLockIfApplicable(!0)},e.prototype.componentWillUnmount=function(){this.props.componentTree.renderContextType===f.a.DiscreteIntegrated&&this.updateDraftRenderLockIfApplicable(!1)},e.prototype.componentDidUpdate=function(t,e){if(this.props.draftState!==t.draftState){var n=Object(v.z)(t.draftState),o=Object(v.z)(this.props.draftState);!o||void 0!==n&&n.renderContextType===o.renderContextType||this.updateDraftRenderLockIfApplicable(!0)}},e.havePropsMeaningfullyChanged=function(t,e){var n=Object.keys(t),o=Object.keys(e);return n.length!==o.length||n.some(function(n){if("thread"===n){if(e.dataItems.length!==t.dataItems.length)return!0;for(var o=0;o<e.dataItems.length;o++)if(e.dataItems[o]!==t.dataItems[o])return!0;return!1}return"object"==typeof e[n]?!function(t,e){if(!t&&e||t&&!e)return!1;if(!t&&!e)return!0;var n=Object.keys(t),o=Object.keys(e);return n.length===o.length&&n.every(function(n){return t[n]===e[n]})}(e[n],t[n]):e[n]!==t[n]})},e.prototype.getCancelModalDialogMode=function(){return this.props.isDraftThread||!this.props.focusState?(Object(a.g)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",595883608),S.a.CancelNewDraft):Object(x.c)(this.props.focusState.focusDetails)?S.a.CancelReplyDraft:S.a.CancelPostEdit},e.prototype.getMentionableCommentEditorProps=function(t,e){if(Object(I.a)(t,e))return{onMentionCreated:this.onMentionCreated,onCurrentMentionsUpdated:this.onCurrentMentionsUpdated,peoplePickerProps:{onGetUserContacts:this.onGetUserContacts,pickerLocalizationDetails:R.g(this.props.localizationAPI),preventDismissOnScroll:r.z()}}},e.prototype.getCommentCardTaskHeaderProps=function(t,e,n,o,r,i){return A.d(t,e,n,o,r,i,this.cardOnHeaderButtonPressed)},e.prototype.onPostDelete=function(t){k.t(a.f.reserveTag(595869957),t.getId(),this.props.dataItems,this.props.focusState,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor)},e.prototype.onPostEdit=function(t){k.u(a.f.reserveTag(595869958),t.getId(),this.props.dataItems,this.props.focusState,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.onRootPostEdit=function(t){k.u(a.f.reserveTag(595719761),t,this.props.dataItems,this.props.focusState,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.onPostCommit=function(t){k.s(a.f.reserveTag(595869959),t.getId(),this.props.dataItems,this.props.focusState,t.getContentsAsync(),this.props.atMentionState.capability===C.a.Enabled,this.props.componentTree,this.props,this.getLiveRegion(),this.props.telemetryVisitor)},e.prototype.onPostSaveDraft=function(t){k.o(a.f.reserveTag(595869960),t,this.props.componentTree.renderContextType,this.props.threadPostStates,this.props,this.props.telemetryVisitor)},e.prototype.onPostCancel=function(t){var e=this.showDiscardDialogOnPostCancel()&&this.props.getDiscardDraftCallback&&this.props.focusState?this.props.getDiscardDraftCallback(this.props.focusState,this.getCancelModalDialogMode()):void 0;k.r(a.f.reserveTag(595869961),t.getId(),t.setContents,this.props.dataItems,this.props.focusState,!1,e,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor)},e.prototype.onRenderableItemSelect=function(t){var e=t.getId(),n=this.props.dataItems.find(function(t){return j.d(t)===e});n?k.v(a.f.reserveTag(595869962),n,this.props.dataItems,this.props.focusState,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor):Object(a.g)().assertConditionTag(!1,"Comment not rendered within Card. Is something incorrect in the tree?",595883610)},e.prototype.cardOnResolveThread=function(t,e){k.i(a.f.reserveTag(595869964),t,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor,e)},e.prototype.cardOnReopenThread=function(t,e){k.h(a.f.reserveTag(595869965),t,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor,e)},e.prototype.cardOnDelete=function(t,e){var n=this.props.componentTree.renderContextType;Object(a.g)().assertConditionTag(n!==f.a.HalfPane,"Discard not yet fully supported for HalfPane in DHC",595869966),k.c(a.f.reserveTag(595869967),t,n,void 0,void 0,this.props,this.getLiveRegion(),this.props.telemetryVisitor,e)},e.prototype.cardOnCreate=function(t){k.b(a.f.reserveTag(595869968),t,this.props.focusState,this.props.atMentionState.capability===C.a.Enabled,{type:"CREATE"},this.props.componentTree,this.props,this.getLiveRegion(),this.props.telemetryVisitor,this.props.cardState.selectedTaskAssignee)},e.prototype.cardOnPostReply=function(t){k.b(a.f.reserveTag(595869969),t,this.props.focusState,this.props.atMentionState.capability===C.a.Enabled,{type:"REPLY",parentId:t.getId()},this.props.componentTree,this.props,this.getLiveRegion(),this.props.telemetryVisitor,this.props.cardState.selectedTaskAssignee)},e.prototype.cardOnSelectExpandCallback=function(t){k.k(a.f.reserveTag(595869970),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnSelectCollapseCallback=function(t){k.j(a.f.reserveTag(595869971),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnBeginReplyCallback=function(t){k.a(a.f.reserveTag(595869972),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnHighlight=function(t){k.g(a.f.reserveTag(595869973),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnDraftingInputSizeChange=function(t,e){k.e(a.f.reserveTag(595869974),t.getId(),e,this.props.componentTree.renderContextType,this.props.focusState,this.props,this.props.telemetryVisitor)},e.prototype.cardOnEditorFocusLost=function(t){k.f(a.f.reserveTag(595869975),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.cardOnHeaderButtonPressed=function(){r.a()&&(this.props.threadTaskState?k.l(a.f.reserveTag(595726989),this.props.threadId,this.props.threadTaskState,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),this.props.telemetryVisitor):Object(a.g)().assertConditionTag(!1,"props.threadTaskState is undefined",595724299))},e.prototype.cardOnFocusNextTabStop_deprecated=function(){if(r.e())return!1;var t=this.componentTree.getComponentById({componentType:P.b.Card,id:this.props.threadId,renderContextType:this.props.componentTree.renderContextType});return!!t&&(t.focus(),!0)},e.prototype.cardOnFocusPreviousTabStop_deprecated=function(){if(r.e())return!1;var t=this.componentTree.getComponentByTag_deprecated(P.a.LastCardElement,{id:this.props.threadId,renderContextType:this.props.componentTree.renderContextType});return!!t&&(t.focus(),!0)},e.prototype.cardOnSaveDraft=function(t){var e;k.o(a.f.reserveTag(595869976),t,this.props.componentTree.renderContextType,((e={})[this.props.threadId]=this.props.cardState,e),this.props,this.props.telemetryVisitor)},e.prototype.onCardReplyCancel=function(t){var e=this.props.componentTree.renderContextType===f.a.HalfPane&&t.draftHasContent();Object(a.g)().assertConditionTag(this.props.cardRelativeDraftingState===O.a.InCard,"Mismatch between focusedComment state and cancel reply callback.",595854432),k.d(a.f.reserveTag(595869977),e,this.props.focusState,this.getCancelModalDialogMode(),this.props.getDiscardDraftCallback,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),!1,this.props.cardState,this.props.draftState,this.props.telemetryVisitor)},e.prototype.onCardDraftCancel=function(t){var e=this.props.componentTree.renderContextType===f.a.HalfPane&&t.draftHasContent();k.d(a.f.reserveTag(595869978),e,this.props.focusState,this.getCancelModalDialogMode(),this.props.getDiscardDraftCallback,this.props.componentTree.renderContextType,this.props,this.getLiveRegion(),!1,this.props.cardState,this.props.draftState,this.props.telemetryVisitor)},e.prototype.getResolveSupported=function(){return r.D()?this.props.capabilities.resolve:this.props.commentAPI.resolveSupported()},e.prototype.getCommentCardStyleOptions=function(){return{highlightCard:this.props.isHighlighted,restrictActionControls:void 0!==this.props.cardRelativeDraftingState}},e.prototype.getCommentPostStyleOptions=function(t,e){var n=this.getRestrictActionControls(t,e),o=this.props.focusState,r=e||t,i=A.b(r,o),a=i===T.a.Expanded,s=i===T.a.Collapsed;return{restrictActionControls:n,hideTimestamp:s,showFullComment:a,collapsed:s}},e.prototype.getCommentCardCallbacksForParentThread=function(t,e,n){var o=N.c(this.cardContextMenuItems,t,this.getResolveSupported(),Object(x.e)(t,this.props.focusState),n);return{onEditorFocus:this.cardOnBeginReplyCallback,onCardSelectExpand:this.cardOnSelectExpandCallback,onCardSelectCollapse:this.cardOnSelectCollapseCallback,onCardHighlight:this.cardOnHighlight,onDraftingInputSizeChange:this.cardOnDraftingInputSizeChange,mentionEditorProps:e,menuItems:o,onEditorBlur:this.cardOnEditorFocusLost,onFocusNextTabStop_deprecated:this.cardOnFocusNextTabStop_deprecated,onFocusPreviousTabStop_deprecated:this.cardOnFocusPreviousTabStop_deprecated,onCancel:this.props.isDraftThread?this.onCardDraftCancel:this.onCardReplyCancel,onPost:this.props.isDraftThread?this.cardOnCreate:this.cardOnPostReply,onSaveDraft:this.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:this.onSelectedTaskAssigneeUpdated}},e.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:w.a.ExpandedCardOrFirstCardTabbable,postTabbingMode:w.b.ExpandedCardRootPostTabbable}},e.prototype.getRestrictActionControls=function(t,e){var n=e||t;return T.a.Collapsed===A.b(n,this.props.focusState)||void 0!==this.props.focusState&&void 0!==this.props.cardRelativeDraftingState&&!(this.props.cardRelativeDraftingState===O.a.InChildPost&&!Object(x.c)(this.props.focusState.focusDetails)&&this.props.focusState.focusDetails.selectedPostId===t)},e.prototype.onMentionCreated=function(t){k.n(a.f.reserveTag(595869979),a.f.reserveTag(595869980),t,this.props,this.props.telemetryVisitor)},e.prototype.onCurrentMentionsUpdated=function(t){r.a()&&k.p(a.f.reserveTag(595724292),t,this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor)},e.prototype.onSelectedTaskAssigneeUpdated=function(t){r.a()?k.q(a.f.reserveTag(595724293),this.props.componentTree.renderContextType,this.props,this.props.telemetryVisitor,t):Object(a.g)().assertConditionTag(!1,"Selected Task Assignee Updated action type is not supported",595687516)},e.prototype.onGetUserContacts=function(t,e,n){return k.m(t,e,n,this.props)},e.prototype.renderThread=function(t){return t},e.prototype.getLiveRegion=function(){return this.liveRegionRef.current},e.prototype.render=function(){var t=this.getMentionableCommentEditorProps(this.props.atMentionState.capability,this.props.atMentionState.authToken),e=this.getCommentCardStyleOptions(),n=!!(j.f(this.props.dataItems).commentFlags&g.a.Resolved),o=this.props.threadTaskState?this.getCommentCardTaskHeaderProps(this.props.threadId,this.props.threadTaskState,this.props.localizationAPI,this.props.componentTree.renderContextType,n,e.restrictActionControls):void 0,r={};r[this.props.threadId]=this.props.cardState;var i=A.g(this.props.dataItems,o,r,this.props.threadPostStates,this.commentPostCallbackProps,t,this.getCommentCardCallbacksForParentThread(j.f(this.props.dataItems),t,!!o),e,this.getCommentPostStyleOptions,this.props.componentTree.renderContextType!==f.a.HalfPane,this.props.localizationAPI,this.postActionBarItems,this.props.firstCardInCurrentContext,this.props.focusState,this.props.componentTree.renderContextType===f.a.HalfPane,this.props.atMentionState.capability===C.a.Enabled,this.props.isDraftThread,this.props.readOnly,this.getKeyboardingOptions(),this.props.personaIconPropertiesMap,this.props.draftState,this.props.cardRelativeDraftingState,{accessibilitySetSize:this.props.accessibilitySetSize,accessibilityPositionInSet:this.props.accessibilityPositionInSet},this.props.maximumDimensions);return y.createElement(E.b,null,this.renderThread(i))},e}(y.Component),_=n(689),B=n(136),L=n(26),F=Object(L.b)(function(t,e){return{cardContainer:Object(B.a)({position:"relative",zIndex:Object(A.e)(t,e)||Object(A.c)(t,e)?1:0})}}),H=n(640),U=function(t){function e(e){var n=t.call(this,e)||this;return n.componentTree=n.props.componentTree,n}return h.d(e,t),e.prototype.showDiscardDialogOnPostCancel=function(){return!1},e.prototype.getChildContext=function(){return{getComponent:this.componentTree.getComponent,getComponentById:this.componentTree.getComponentById,getComponentByTag_deprecated:this.componentTree.getComponentByTag_deprecated,isEventTarget:this.componentTree.isEventTarget,isFocusWithin:this.componentTree.isFocusWithin,isFocusWithinAny:this.componentTree.isFocusWithinAny,isFocusWithinPane:this.componentTree.isFocusWithinPane,isFocusOn:this.componentTree.isFocusOn,getCurrentlyFocused:this.componentTree.getCurrentlyFocused,renderContextType:this.componentTree.renderContextType}},e.prototype.renderThread=function(t){var e=F(t.props.id,this.props.focusState).cardContainer,n=y.createElement("div",{className:e,onKeyDown:this.commentContentsKeyDownHandler.onKeyDown},t,y.createElement(_.a,{ref:this.liveRegionRef}));return r.e()&&this.props.componentTree.renderContextType!==f.a.FullPane?y.createElement(m.a,{isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0},n):n},e.childContextTypes=h.a({},H.a),e}(M),z=n(658),V=n(690),q=n(660),K=n(683);n.d(e,"a",function(){return G});var G=Object(o.connect)(function(){var t=K.c(),e=K.j(t),n=K.f(e),o=K.k(e),i=K.e(),a=K.g(),s=K.b(),c=K.a(),l=K.i(),d=K.h(e,l);return function(t,p){V.a.setStartMarker(z.c.MapState2PropsStart);var u=e(t,p),f=r.a()?l(t,p):void 0,h={threadId:u.thread[0].commentId,dataItems:d(t,p),threadTaskState:f&&f.currentState,threadPostStates:o(t,p),focusState:i(t,p),readOnly:q.g(t),cardState:s(t,p),isHighlighted:a(t,p),personaIconPropertiesMap:q.h(t),isDraftThread:u.isDraftThread,atMentionState:q.a(t),draftState:q.e(t),firstCardInCurrentContext:n(t,p),cardRelativeDraftingState:c(t,p),capabilities:t.capabilities},m=V.a.getDurationMeasure(z.c.MapState2PropsStart,z.c.MapState2PropsEnd,z.c.MapState2PropsTimer);return V.a.updatePerfStruct(z.b.MapState2Props,m),h}},function(t,e){return{requestDeleteComment:function(e,n){t(s.x(e,n))},requestDeleteThread:function(e,n,o){t(s.y(e,n,o))},selectCommentCardExpand:function(e,n,o){t(s.F(e,n,void 0,s.c.ExpandCard,o))},selectCommentCardCollapse:function(e,n,o){t(s.F(e,n,void 0,s.c.CollapseCard,o))},selectCommentPost:function(e,n,o,r){t(s.F(e,n,o,s.c.SelectPost,r))},requestReopenThread:function(e,n,o){t(s.B(e,n,o))},requestEditCommentSession:function(n,o){t(Object(u.a)(n,e.commentAPI,{sessionType:"EDIT",commentId:o},!1,e.peopleAPI))},requestReplyCommentSession:function(n,o){t(Object(u.a)(n,e.commentAPI,{sessionType:"REPLY",threadId:o},!1,e.peopleAPI))},requestResolveThread:function(e,n,o){t(s.D(e,n,o))},commitCommentAndFocus:function(n,o,r,i,a,s){return t(Object(l.a)(n,e.peopleAPI,i,o,r,s)).then(function(t){return t.shareFailed&&e.focusManager.focusActiveEditor(r,a),t})},discardDraftAsync:function(e,n,o,r){return t(Object(d.a)(e,n,o,r))},saveDraft:function(e,n,o){t(s.E(e,{draftId:n,draftContent:o}))},updateRenderLockForDraft:function(e,n,o){t(s.L(e,n,o))},clearCommentHighlight:function(e){t(s.i(e,c.a.SharedComments))},highlightComment:function(n){t(s.o(n,e.resource.id,c.a.SharedComments))},requestDisplayConfiguration:function(n,o){return e.componentTree.renderContextType!==f.a.HalfPane?Promise.resolve():t(Object(p.a)(n,o))},showLowFidelityWarning:function(e,n,o){t(s.I(e,n,o))},checkUserAccess:function(t){return e.peopleAPI.checkUserAccess(t)},getUserContacts:function(t,n,o){return e.peopleAPI.capabilities&i.a.GetContactsForMentions?e.peopleAPI.getContactsForMentions(t,n,o):(Object(a.g)().assertConditionTag(!1,"Attempted to retrieve contacts on API without capability.",595870033),Promise.resolve([]))},updateCurrentMentionees:function(e,n){t(s.K(e,n))},updateSelectedTaskAssignee:function(e,n){t(s.N(e,n))}}})(U)},689:function(t,e,n){"use strict";var o=n(1),r=n(0),i=n(13),a=n(26),s=Object(a.b)(function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}}}),c=function(t){function e(e){var n=t.call(this,e)||this;return n.state={liveRegionUpdate:e.liveRegionUpdate,liveRegionCounter:0},n}return o.d(e,t),e.prototype.appendLiveRegionUpdate=function(t){var e=this,n=i.H()?this.state.liveRegionCounter+1:0;this.setState({liveRegionUpdate:t,liveRegionCounter:n}),i.H()&&setTimeout(function(){e.state.liveRegionCounter===n&&e.setState({liveRegionUpdate:void 0,liveRegionCounter:0})},1e3)},e.prototype.render=function(){var t=s();return r.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",tabIndex:-1,style:t.offscreenLiveRegion},this.state.liveRegionUpdate)},e}(r.PureComponent);e.a=c},690:function(t,e,n){"use strict";var o=n(79),r=n(658),i=new(function(){function t(){this.trackedMeasure={},this.isInitialized=!1}return t.prototype.createPerfStruct=function(t){return{perfType:t,totalTime:0,latestCallTime:0,functionCallNum:0,avgFunctionTime:0}},t.prototype.init=function(t){this.isInitialized||(this.perfUpdateHandler=t,this.trackedMeasure[r.a.ComputeTruncationTime]=this.createPerfStruct(r.b.ComputeTruncation),this.trackedMeasure[r.a.QuillToOfficeTime]=this.createPerfStruct(r.b.Quill2Office),this.trackedMeasure[r.a.OfficeToQuillTime]=this.createPerfStruct(r.b.Office2Quill),this.trackedMeasure[r.a.MapStateToProps]=this.createPerfStruct(r.b.MapState2Props),this.isInitialized=!0)},t.prototype.clearPerfStruct=function(t){var e=this.createPerfStruct(t);this.trackedMeasure[this.getMeasureNamefromType(t)]=e},t.prototype.getTrackedMeasure=function(t){return this.trackedMeasure[t]},t.prototype.getAllPerfMeasures=function(){return this.trackedMeasure},t.prototype.getMeasureTypeFromName=function(t){switch(t){case r.a.ComputeTruncationTime:return r.b.ComputeTruncation;case r.a.OfficeToQuillTime:return r.b.Office2Quill;case r.a.QuillToOfficeTime:return r.b.Quill2Office;case r.a.MapStateToProps:return r.b.MapState2Props;default:return r.b.NoMeasure}},t.prototype.getMeasureNamefromType=function(t){switch(t){case r.b.ComputeTruncation:return r.a.ComputeTruncationTime;case r.b.Office2Quill:return r.a.OfficeToQuillTime;case r.b.Quill2Office:return r.a.QuillToOfficeTime;case r.b.MapState2Props:return r.a.MapStateToProps;default:return r.a.NoMeasure}},t.prototype.updatePerfStruct=function(t,e){if(-1!==e&&this.isInitialized){var n=this.getTrackedMeasure(this.getMeasureNamefromType(t));n&&(n.totalTime=n.totalTime+e,n.latestCallTime=e,n.functionCallNum=n.functionCallNum+1,n.avgFunctionTime=n.totalTime/n.functionCallNum,this.perfUpdateHandler())}},t.prototype.setStartMarker=function(t){o.c&&performance.mark(t)},t.prototype.getDurationMeasure=function(t,e,n){var r=-1;if(o.c){performance.mark(e),performance.measure(n,t,e);var i=performance.getEntriesByName(n);i&&i.length&&(r=i[0].duration),performance.clearMarks(t),performance.clearMarks(e),performance.clearMeasures(n)}return r},t}());e.a=i},750:function(t,e,n){window,t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),r=n(9),i=n(10),a=n(17),s=n(18),c=n(19),l=n(20),d=n(21),p=n(7),u=n(13),f=n(14),h=n(12),m=n(3),y={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:o.default,Format:r.default,Leaf:i.default,Embed:l.default,Scroll:a.default,Block:c.default,Inline:s.default,Text:d.default,Attributor:{Attribute:p.default,Class:u.default,Style:f.default,Store:h.default}};e.default=y},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=n(23),i=n(5),a=n(2),s=n(6),c=String.fromCharCode(0),l=function(t){Array.isArray(t)?this.ops=t:null!=t&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]};l.prototype.insert=function(t,e){var n={};return 0===t.length?this:(n.insert=t,null!=e&&"object"===o(e)&&Object.keys(e).length>0&&(n.attributes=e),this.push(n))},l.prototype.delete=function(t){return t<=0?this:this.push({delete:t})},l.prototype.retain=function(t,e){if(t<=0)return this;var n={retain:t};return null!=e&&"object"===o(e)&&Object.keys(e).length>0&&(n.attributes=e),this.push(n)},l.prototype.push=function(t){var e=this.ops.length,n=this.ops[e-1];if(t=a(!0,{},t),"object"===o(n)){if("number"==typeof t.delete&&"number"==typeof n.delete)return this.ops[e-1]={delete:n.delete+t.delete},this;if("number"==typeof n.delete&&null!=t.insert&&(e-=1,"object"!==o(n=this.ops[e-1])))return this.ops.unshift(t),this;if(i(t.attributes,n.attributes)){if("string"==typeof t.insert&&"string"==typeof n.insert)return this.ops[e-1]={insert:n.insert+t.insert},"object"===o(t.attributes)&&(this.ops[e-1].attributes=t.attributes),this;if("number"==typeof t.retain&&"number"==typeof n.retain)return this.ops[e-1]={retain:n.retain+t.retain},"object"===o(t.attributes)&&(this.ops[e-1].attributes=t.attributes),this}}return e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),this},l.prototype.chop=function(){var t=this.ops[this.ops.length-1];return t&&t.retain&&!t.attributes&&this.ops.pop(),this},l.prototype.filter=function(t){return this.ops.filter(t)},l.prototype.forEach=function(t){this.ops.forEach(t)},l.prototype.map=function(t){return this.ops.map(t)},l.prototype.partition=function(t){var e=[],n=[];return this.forEach(function(o){(t(o)?e:n).push(o)}),[e,n]},l.prototype.reduce=function(t,e){return this.ops.reduce(t,e)},l.prototype.changeLength=function(){return this.reduce(function(t,e){return e.insert?t+s.length(e):e.delete?t-e.delete:t},0)},l.prototype.length=function(){return this.reduce(function(t,e){return t+s.length(e)},0)},l.prototype.slice=function(t,e){t=t||0,"number"!=typeof e&&(e=1/0);for(var n=[],o=s.iterator(this.ops),r=0;r<e&&o.hasNext();){var i;r<t?i=o.next(t-r):(i=o.next(e-r),n.push(i)),r+=s.length(i)}return new l(n)},l.prototype.compose=function(t){var e=s.iterator(this.ops),n=s.iterator(t.ops),o=[],r=n.peek();if(null!=r&&"number"==typeof r.retain&&null==r.attributes){for(var a=r.retain;"insert"===e.peekType()&&e.peekLength()<=a;)a-=e.peekLength(),o.push(e.next());r.retain-a>0&&n.next(r.retain-a)}for(var c=new l(o);e.hasNext()||n.hasNext();)if("insert"===n.peekType())c.push(n.next());else if("delete"===e.peekType())c.push(e.next());else{var d=Math.min(e.peekLength(),n.peekLength()),p=e.next(d),u=n.next(d);if("number"==typeof u.retain){var f={};"number"==typeof p.retain?f.retain=d:f.insert=p.insert;var h=s.attributes.compose(p.attributes,u.attributes,"number"==typeof p.retain);if(h&&(f.attributes=h),c.push(f),!n.hasNext()&&i(c.ops[c.ops.length-1],f)){var m=new l(e.rest());return c.concat(m).chop()}}else"number"==typeof u.delete&&"number"==typeof p.retain&&c.push(u)}return c.chop()},l.prototype.concat=function(t){var e=new l(this.ops.slice());return t.ops.length>0&&(e.push(t.ops[0]),e.ops=e.ops.concat(t.ops.slice(1))),e},l.prototype.diff=function(t,e){if(this.ops===t.ops)return new l;var n=[this,t].map(function(e){return e.map(function(n){if(null!=n.insert)return"string"==typeof n.insert?n.insert:c;throw new Error("diff() called "+(e===t?"on":"with")+" non-document")}).join("")}),o=new l,a=r(n[0],n[1],e),d=s.iterator(this.ops),p=s.iterator(t.ops);return a.forEach(function(t){for(var e=t[1].length;e>0;){var n=0;switch(t[0]){case r.INSERT:n=Math.min(p.peekLength(),e),o.push(p.next(n));break;case r.DELETE:n=Math.min(e,d.peekLength()),d.next(n),o.delete(n);break;case r.EQUAL:n=Math.min(d.peekLength(),p.peekLength(),e);var a=d.next(n),c=p.next(n);i(a.insert,c.insert)?o.retain(n,s.attributes.diff(a.attributes,c.attributes)):o.push(c).delete(n)}e-=n}}),o.chop()},l.prototype.eachLine=function(t,e){e=e||"\n";for(var n=s.iterator(this.ops),o=new l,r=0;n.hasNext();){if("insert"!==n.peekType())return;var i=n.peek(),a=s.length(i)-n.peekLength(),c="string"==typeof i.insert?i.insert.indexOf(e,a)-a:-1;if(c<0)o.push(n.next());else if(c>0)o.push(n.next(c));else{if(!1===t(o,n.next(1).attributes||{},r))return;r+=1,o=new l}}o.length()>0&&t(o,{},r)},l.prototype.transform=function(t,e){if(e=!!e,"number"==typeof t)return this.transformPosition(t,e);for(var n=s.iterator(this.ops),o=s.iterator(t.ops),r=new l;n.hasNext()||o.hasNext();)if("insert"!==n.peekType()||!e&&"insert"===o.peekType())if("insert"===o.peekType())r.push(o.next());else{var i=Math.min(n.peekLength(),o.peekLength()),a=n.next(i),c=o.next(i);if(a.delete)continue;c.delete?r.push(c):r.retain(i,s.attributes.transform(a.attributes,c.attributes,e))}else r.retain(s.length(n.next()));return r.chop()},l.prototype.transformPosition=function(t,e){e=!!e;for(var n=s.iterator(this.ops),o=0;n.hasNext()&&o<=t;){var r=n.peekLength(),i=n.peekType();n.next(),"delete"!==i?("insert"===i&&(o<t||!e)&&(t+=r),o+=r):t-=Math.min(r,t-o)}return t},t.exports=l},function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,c=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===i.call(t)},l=function(t){if(!t||"[object Object]"!==i.call(t))return!1;var e,n=r.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!o)return!1;for(e in t);return void 0===e||r.call(t,e)},d=function(t,e){a&&"__proto__"===e.name?a(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},p=function(t,e){if("__proto__"===e){if(!r.call(t,e))return;if(s)return s(t,e).value}return t[e]};t.exports=function t(){var e,n,r,i,a,s,u=arguments[0],f=1,h=arguments.length,m=!1;for("boolean"==typeof u&&(m=u,u=arguments[1]||{},f=2),(null==u||"object"!==o(u)&&"function"!=typeof u)&&(u={});f<h;++f)if(null!=(e=arguments[f]))for(n in e)r=p(u,n),u!==(i=p(e,n))&&(m&&i&&(l(i)||(a=c(i)))?(a?(a=!1,s=r&&c(r)?r:[]):s=r&&l(r)?r:{},d(u,{name:n,newValue:t(m,s,i)})):void 0!==i&&d(u,{name:n,newValue:i}));return u}},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e){var n=this;return e="[Parchment] "+e,(n=t.call(this,e)||this).message=e,n.name=n.constructor.name,n}return r(e,t),e}(Error);e.ParchmentError=i;var a,s={},c={},l={},d={};function p(t,e){var n;if(void 0===e&&(e=a.ANY),"string"==typeof t)n=d[t]||s[t];else if(t instanceof Text||t.nodeType===Node.TEXT_NODE)n=d.text;else if("number"==typeof t)t&a.LEVEL&a.BLOCK?n=d.block:t&a.LEVEL&a.INLINE&&(n=d.inline);else if(t instanceof HTMLElement){var o=(t.getAttribute("class")||"").split(/\s+/);for(var r in o)if(n=c[o[r]])break;n=n||l[t.tagName]}return null==n?null:e&a.LEVEL&n.scope&&e&a.TYPE&n.scope?n:null}e.DATA_KEY="__blot",function(t){t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY"}(a=e.Scope||(e.Scope={})),e.create=function(t,e){var n=p(t);if(null==n)throw new i("Unable to create "+t+" blot");var o=n,r=t instanceof Node||t.nodeType===Node.TEXT_NODE?t:o.create(e);return new o(r,e)},e.find=function t(n,o){return void 0===o&&(o=!1),null==n?null:null!=n[e.DATA_KEY]?n[e.DATA_KEY].blot:o?t(n.parentNode,o):null},e.query=p,e.register=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.length>1)return e.map(function(e){return t(e)});var o=e[0];if("string"!=typeof o.blotName&&"string"!=typeof o.attrName)throw new i("Invalid definition");if("abstract"===o.blotName)throw new i("Cannot register abstract class");return d[o.blotName||o.attrName]=o,"string"==typeof o.keyName?s[o.keyName]=o:(null!=o.className&&(c[o.className]=o),null!=o.tagName&&(Array.isArray(o.tagName)?o.tagName=o.tagName.map(function(t){return t.toUpperCase()}):o.tagName=o.tagName.toUpperCase(),(Array.isArray(o.tagName)?o.tagName:[o.tagName]).forEach(function(t){null!=l[t]&&null!=o.className||(l[t]=o)}))),o}},function(t,e,n){(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=function(){"use strict";function e(t,e){return null!=e&&t instanceof e}var o,r,i;try{o=Map}catch(t){o=function(){}}try{r=Set}catch(t){r=function(){}}try{i=Promise}catch(t){i=function(){}}function a(s,l,d,p,u){"object"===n(l)&&(d=l.depth,p=l.prototype,u=l.includeNonEnumerable,l=l.circular);var f=[],h=[],m=void 0!==t;return void 0===l&&(l=!0),void 0===d&&(d=1/0),function s(d,y){if(null===d)return null;if(0===y)return d;var g,b;if("object"!=n(d))return d;if(e(d,o))g=new o;else if(e(d,r))g=new r;else if(e(d,i))g=new i(function(t,e){d.then(function(e){t(s(e,y-1))},function(t){e(s(t,y-1))})});else if(a.__isArray(d))g=[];else if(a.__isRegExp(d))g=new RegExp(d.source,c(d)),d.lastIndex&&(g.lastIndex=d.lastIndex);else if(a.__isDate(d))g=new Date(d.getTime());else{if(m&&t.isBuffer(d))return g=t.allocUnsafe?t.allocUnsafe(d.length):new t(d.length),d.copy(g),g;e(d,Error)?g=Object.create(d):void 0===p?(b=Object.getPrototypeOf(d),g=Object.create(b)):(g=Object.create(p),b=p)}if(l){var v=f.indexOf(d);if(-1!=v)return h[v];f.push(d),h.push(g)}for(var C in e(d,o)&&d.forEach(function(t,e){var n=s(e,y-1),o=s(t,y-1);g.set(n,o)}),e(d,r)&&d.forEach(function(t){var e=s(t,y-1);g.add(e)}),d){var x;b&&(x=Object.getOwnPropertyDescriptor(b,C)),x&&null==x.set||(g[C]=s(d[C],y-1))}if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(d);for(C=0;C<T.length;C++){var O=T[C];(!(E=Object.getOwnPropertyDescriptor(d,O))||E.enumerable||u)&&(g[O]=s(d[O],y-1),E.enumerable||Object.defineProperty(g,O,{enumerable:!1}))}}if(u){var S=Object.getOwnPropertyNames(d);for(C=0;C<S.length;C++){var E,P=S[C];(E=Object.getOwnPropertyDescriptor(d,P))&&E.enumerable||(g[P]=s(d[P],y-1),Object.defineProperty(g,P,{enumerable:!1}))}}return g}(s,d)}function s(t){return Object.prototype.toString.call(t)}function c(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return a.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},a.__objToStr=s,a.__isDate=function(t){return"object"===n(t)&&"[object Date]"===s(t)},a.__isArray=function(t){return"object"===n(t)&&"[object Array]"===s(t)},a.__isRegExp=function(t){return"object"===n(t)&&"[object RegExp]"===s(t)},a.__getRegExpFlags=c,a}();"object"===n(e)&&e.exports&&(e.exports=o)}).call(this,n(26).Buffer,n(31)(t))},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=Array.prototype.slice,i=n(24),a=n(25),s=t.exports=function(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=o(t)&&"object"!=o(e)?n.strict?t===e:t==e:function(t,e,n){var d,p;if(c(t)||c(e))return!1;if(t.prototype!==e.prototype)return!1;if(a(t))return!!a(e)&&(t=r.call(t),e=r.call(e),s(t,e,n));if(l(t)){if(!l(e))return!1;if(t.length!==e.length)return!1;for(d=0;d<t.length;d++)if(t[d]!==e[d])return!1;return!0}try{var u=i(t),f=i(e)}catch(t){return!1}if(u.length!=f.length)return!1;for(u.sort(),f.sort(),d=u.length-1;d>=0;d--)if(u[d]!=f[d])return!1;for(d=u.length-1;d>=0;d--)if(p=u[d],!s(t[p],e[p],n))return!1;return o(t)===o(e)}(t,e,n))};function c(t){return null==t}function l(t){return!(!t||"object"!==o(t)||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}},function(t,e,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=n(5),i=n(2),a={attributes:{compose:function(t,e,n){"object"!==o(t)&&(t={}),"object"!==o(e)&&(e={});var r=i(!0,{},e);for(var a in n||(r=Object.keys(r).reduce(function(t,e){return null!=r[e]&&(t[e]=r[e]),t},{})),t)void 0!==t[a]&&void 0===e[a]&&(r[a]=t[a]);return Object.keys(r).length>0?r:void 0},diff:function(t,e){"object"!==o(t)&&(t={}),"object"!==o(e)&&(e={});var n=Object.keys(t).concat(Object.keys(e)).reduce(function(n,o){return r(t[o],e[o])||(n[o]=void 0===e[o]?null:e[o]),n},{});return Object.keys(n).length>0?n:void 0},transform:function(t,e,n){if("object"!==o(t))return e;if("object"===o(e)){if(!n)return e;var r=Object.keys(e).reduce(function(n,o){return void 0===t[o]&&(n[o]=e[o]),n},{});return Object.keys(r).length>0?r:void 0}}},iterator:function(t){return new s(t)},length:function(t){return"number"==typeof t.delete?t.delete:"number"==typeof t.retain?t.retain:"string"==typeof t.insert?t.insert.length:1}};function s(t){this.ops=t,this.index=0,this.offset=0}s.prototype.hasNext=function(){return this.peekLength()<1/0},s.prototype.next=function(t){t||(t=1/0);var e=this.ops[this.index];if(e){var n=this.offset,o=a.length(e);if(t>=o-n?(t=o-n,this.index+=1,this.offset=0):this.offset+=t,"number"==typeof e.delete)return{delete:t};var r={};return e.attributes&&(r.attributes=e.attributes),"number"==typeof e.retain?r.retain=t:"string"==typeof e.insert?r.insert=e.insert.substr(n,t):r.insert=e.insert,r}return{retain:1/0}},s.prototype.peek=function(){return this.ops[this.index]},s.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},s.prototype.peekType=function(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"},s.prototype.rest=function(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);var t=this.offset,e=this.index,n=this.next(),o=this.ops.slice(this.index);return this.offset=t,this.index=e,[n].concat(o)}return[]},t.exports=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(t,e,n){void 0===n&&(n={}),this.attrName=t,this.keyName=e;var r=o.Scope.TYPE&o.Scope.ATTRIBUTE;null!=n.scope?this.scope=n.scope&o.Scope.LEVEL|r:this.scope=o.Scope.ATTRIBUTE,null!=n.whitelist&&(this.whitelist=n.whitelist)}return t.keys=function(t){return[].map.call(t.attributes,function(t){return t.name})},t.prototype.add=function(t,e){return!!this.canAdd(t,e)&&(t.setAttribute(this.keyName,e),!0)},t.prototype.canAdd=function(t,e){return null!=o.query(t,o.Scope.BLOT&(this.scope|o.Scope.TYPE))&&(null==this.whitelist||("string"==typeof e?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1))},t.prototype.remove=function(t){t.removeAttribute(this.keyName)},t.prototype.value=function(t){var e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""},t}();e.default=r},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(16),a=n(11),s=n(3),c=function(t){function e(e){var n=t.call(this,e)||this;return n.build(),n}return r(e,t),e.prototype.appendChild=function(t){this.insertBefore(t)},e.prototype.attach=function(){t.prototype.attach.call(this),this.children.forEach(function(t){t.attach()})},e.prototype.build=function(){var t=this;this.children=new i.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(e){try{var n=l(e);t.insertBefore(n,t.children.head||void 0)}catch(t){if(t instanceof s.ParchmentError)return;throw t}})},e.prototype.deleteAt=function(t,e){if(0===t&&e===this.length())return this.remove();this.children.forEachAt(t,e,function(t,e,n){t.deleteAt(e,n)})},e.prototype.descendant=function(t,n){var o=this.children.find(n),r=o[0],i=o[1];return null==t.blotName&&t(r)||null!=t.blotName&&r instanceof t?[r,i]:r instanceof e?r.descendant(t,i):[null,-1]},e.prototype.descendants=function(t,n,o){void 0===n&&(n=0),void 0===o&&(o=Number.MAX_VALUE);var r=[],i=o;return this.children.forEachAt(n,o,function(n,o,a){(null==t.blotName&&t(n)||null!=t.blotName&&n instanceof t)&&r.push(n),n instanceof e&&(r=r.concat(n.descendants(t,o,i))),i-=a}),r},e.prototype.detach=function(){this.children.forEach(function(t){t.detach()}),t.prototype.detach.call(this)},e.prototype.formatAt=function(t,e,n,o){this.children.forEachAt(t,e,function(t,e,r){t.formatAt(e,r,n,o)})},e.prototype.insertAt=function(t,e,n){var o=this.children.find(t),r=o[0],i=o[1];if(r)r.insertAt(i,e,n);else{var a=null==n?s.create("text",e):s.create(e,n);this.appendChild(a)}},e.prototype.insertBefore=function(t,e){if(null!=this.statics.allowedChildren&&!this.statics.allowedChildren.some(function(e){return t instanceof e}))throw new s.ParchmentError("Cannot insert "+t.statics.blotName+" into "+this.statics.blotName);t.insertInto(this,e)},e.prototype.length=function(){return this.children.reduce(function(t,e){return t+e.length()},0)},e.prototype.moveChildren=function(t,e){this.children.forEach(function(n){t.insertBefore(n,e)})},e.prototype.optimize=function(e){if(t.prototype.optimize.call(this,e),0===this.children.length)if(null!=this.statics.defaultChild){var n=s.create(this.statics.defaultChild);this.appendChild(n),n.optimize(e)}else this.remove()},e.prototype.path=function(t,n){void 0===n&&(n=!1);var o=this.children.find(t,n),r=o[0],i=o[1],a=[[this,t]];return r instanceof e?a.concat(r.path(i,n)):(null!=r&&a.push([r,i]),a)},e.prototype.removeChild=function(t){this.children.remove(t)},e.prototype.replace=function(n){n instanceof e&&n.moveChildren(this),t.prototype.replace.call(this,n)},e.prototype.split=function(t,e){if(void 0===e&&(e=!1),!e){if(0===t)return this;if(t===this.length())return this.next}var n=this.clone();return this.parent.insertBefore(n,this.next),this.children.forEachAt(t,this.length(),function(t,o,r){t=t.split(o,e),n.appendChild(t)}),n},e.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},e.prototype.update=function(t,e){var n=this,o=[],r=[];t.forEach(function(t){t.target===n.domNode&&"childList"===t.type&&(o.push.apply(o,t.addedNodes),r.push.apply(r,t.removedNodes))}),r.forEach(function(t){if(!(null!=t.parentNode&&"IFRAME"!==t.tagName&&document.body.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var e=s.find(t);null!=e&&(null!=e.domNode.parentNode&&e.domNode.parentNode!==n.domNode||e.detach())}}),o.filter(function(t){return t.parentNode==n.domNode}).sort(function(t,e){return t===e?0:t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(t){var e=null;null!=t.nextSibling&&(e=s.find(t.nextSibling));var o=l(t);o.next==e&&null!=o.next||(null!=o.parent&&o.parent.removeChild(n),n.insertBefore(o,e||void 0))})},e}(a.default);function l(t){var e=s.find(t);if(null==e)try{e=s.create(t)}catch(n){e=s.create(s.Scope.INLINE),[].slice.call(t.childNodes).forEach(function(t){e.domNode.appendChild(t)}),t.parentNode&&t.parentNode.replaceChild(e.domNode,t),e.attach()}return e}e.default=c},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),a=n(12),s=n(8),c=n(3),l=function(t){function e(e){var n=t.call(this,e)||this;return n.attributes=new a.default(n.domNode),n}return r(e,t),e.formats=function(t){return"string"==typeof this.tagName||(Array.isArray(this.tagName)?t.tagName.toLowerCase():void 0)},e.prototype.format=function(t,e){var n=c.query(t);n instanceof i.default?this.attributes.attribute(n,e):e&&(null==n||t===this.statics.blotName&&this.formats()[t]===e||this.replaceWith(t,e))},e.prototype.formats=function(){var t=this.attributes.values(),e=this.statics.formats(this.domNode);return null!=e&&(t[this.statics.blotName]=e),t},e.prototype.replaceWith=function(e,n){var o=t.prototype.replaceWith.call(this,e,n);return this.attributes.copy(o),o},e.prototype.update=function(e,n){var o=this;t.prototype.update.call(this,e,n),e.some(function(t){return t.target===o.domNode&&"attributes"===t.type})&&this.attributes.build()},e.prototype.wrap=function(n,o){var r=t.prototype.wrap.call(this,n,o);return r instanceof e&&r.statics.scope===this.statics.scope&&this.attributes.move(r),r},e}(s.default);e.default=l},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),a=n(3),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.value=function(t){return!0},e.prototype.index=function(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1},e.prototype.position=function(t,e){var n=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return t>0&&(n+=1),[this.parent.domNode,n]},e.prototype.value=function(){var t;return(t={})[this.statics.blotName]=this.statics.value(this.domNode)||!0,t},e.scope=a.Scope.INLINE_BLOT,e}(i.default);e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(t){this.domNode=t,this.domNode[o.DATA_KEY]={blot:this}}return Object.defineProperty(t.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),t.create=function(t){if(null==this.tagName)throw new o.ParchmentError("Blot definition missing tagName");var e;return Array.isArray(this.tagName)?("string"==typeof t&&(t=t.toUpperCase(),parseInt(t).toString()===t&&(t=parseInt(t))),e="number"==typeof t?document.createElement(this.tagName[t-1]):this.tagName.indexOf(t)>-1?document.createElement(t):document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e},t.prototype.attach=function(){null!=this.parent&&(this.scroll=this.parent.scroll)},t.prototype.clone=function(){var t=this.domNode.cloneNode(!1);return o.create(t)},t.prototype.detach=function(){null!=this.parent&&this.parent.removeChild(this),delete this.domNode[o.DATA_KEY]},t.prototype.deleteAt=function(t,e){this.isolate(t,e).remove()},t.prototype.formatAt=function(t,e,n,r){var i=this.isolate(t,e);if(null!=o.query(n,o.Scope.BLOT)&&r)i.wrap(n,r);else if(null!=o.query(n,o.Scope.ATTRIBUTE)){var a=o.create(this.statics.scope);i.wrap(a),a.format(n,r)}},t.prototype.insertAt=function(t,e,n){var r=null==n?o.create("text",e):o.create(e,n),i=this.split(t);this.parent.insertBefore(r,i)},t.prototype.insertInto=function(t,e){void 0===e&&(e=null),null!=this.parent&&this.parent.children.remove(this);var n=null;t.children.insertBefore(this,e),null!=e&&(n=e.domNode),this.domNode.parentNode==t.domNode&&this.domNode.nextSibling==n||t.domNode.insertBefore(this.domNode,n),this.parent=t,this.attach()},t.prototype.isolate=function(t,e){var n=this.split(t);return n.split(e),n},t.prototype.length=function(){return 1},t.prototype.offset=function(t){return void 0===t&&(t=this.parent),null==this.parent||this==t?0:this.parent.children.offset(this)+this.parent.offset(t)},t.prototype.optimize=function(t){null!=this.domNode[o.DATA_KEY]&&delete this.domNode[o.DATA_KEY].mutations},t.prototype.remove=function(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},t.prototype.replace=function(t){null!=t.parent&&(t.parent.insertBefore(this,t.next),t.remove())},t.prototype.replaceWith=function(t,e){var n="string"==typeof t?o.create(t,e):t;return n.replace(this),n},t.prototype.split=function(t,e){return 0===t?this:this.next},t.prototype.update=function(t,e){},t.prototype.wrap=function(t,e){var n="string"==typeof t?o.create(t,e):t;return null!=this.parent&&this.parent.insertBefore(n,this.next),n.appendChild(this),n},t.blotName="abstract",t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),r=n(13),i=n(14),a=n(3),s=function(){function t(t){this.attributes={},this.domNode=t,this.build()}return t.prototype.attribute=function(t,e){e?t.add(this.domNode,e)&&(null!=t.value(this.domNode)?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])},t.prototype.build=function(){var t=this;this.attributes={};var e=o.default.keys(this.domNode),n=r.default.keys(this.domNode),s=i.default.keys(this.domNode);e.concat(n).concat(s).forEach(function(e){var n=a.query(e,a.Scope.ATTRIBUTE);n instanceof o.default&&(t.attributes[n.attrName]=n)})},t.prototype.copy=function(t){var e=this;Object.keys(this.attributes).forEach(function(n){var o=e.attributes[n].value(e.domNode);t.format(n,o)})},t.prototype.move=function(t){var e=this;this.copy(t),Object.keys(this.attributes).forEach(function(t){e.attributes[t].remove(e.domNode)}),this.attributes={}},t.prototype.values=function(){var t=this;return Object.keys(this.attributes).reduce(function(e,n){return e[n]=t.attributes[n].value(t.domNode),e},{})},t}();e.default=s},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function i(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter(function(t){return 0===t.indexOf(e+"-")})}Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.keys=function(t){return(t.getAttribute("class")||"").split(/\s+/).map(function(t){return t.split("-").slice(0,-1).join("-")})},e.prototype.add=function(t,e){return!!this.canAdd(t,e)&&(this.remove(t),t.classList.add(this.keyName+"-"+e),!0)},e.prototype.remove=function(t){i(t,this.keyName).forEach(function(e){t.classList.remove(e)}),0===t.classList.length&&t.removeAttribute("class")},e.prototype.value=function(t){var e=(i(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""},e}(n(7).default);e.default=a},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function i(t){var e=t.split("-"),n=e.slice(1).map(function(t){return t[0].toUpperCase()+t.slice(1)}).join("");return e[0]+n}Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.keys=function(t){return(t.getAttribute("style")||"").split(";").map(function(t){return t.split(":")[0].trim()})},e.prototype.add=function(t,e){return!!this.canAdd(t,e)&&(t.style[i(this.keyName)]=e,!0)},e.prototype.remove=function(t){t.style[i(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")},e.prototype.value=function(t){var e=t.style[i(this.keyName)];return this.canAdd(t,e)?e:""},e}(n(7).default);e.default=a},function(t,e,n){"use strict";var o=Object.prototype.hasOwnProperty,r="~";function i(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)o.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},s.prototype.listeners=function(t,e){var n=r?r+t:t,o=this._events[n];if(e)return!!o;if(!o)return[];if(o.fn)return[o.fn];for(var i=0,a=o.length,s=new Array(a);i<a;i++)s[i]=o[i].fn;return s},s.prototype.emit=function(t,e,n,o,i,a){var s=r?r+t:t;if(!this._events[s])return!1;var c,l,d=this._events[s],p=arguments.length;if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),p){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,e),!0;case 3:return d.fn.call(d.context,e,n),!0;case 4:return d.fn.call(d.context,e,n,o),!0;case 5:return d.fn.call(d.context,e,n,o,i),!0;case 6:return d.fn.call(d.context,e,n,o,i,a),!0}for(l=1,c=new Array(p-1);l<p;l++)c[l-1]=arguments[l];d.fn.apply(d.context,c)}else{var u,f=d.length;for(l=0;l<f;l++)switch(d[l].once&&this.removeListener(t,d[l].fn,void 0,!0),p){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,e);break;case 3:d[l].fn.call(d[l].context,e,n);break;case 4:d[l].fn.call(d[l].context,e,n,o);break;default:if(!c)for(u=1,c=new Array(p-1);u<p;u++)c[u-1]=arguments[u];d[l].fn.apply(d[l].context,c)}}return!0},s.prototype.on=function(t,e,n){var o=new a(e,n||this),i=r?r+t:t;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],o]:this._events[i].push(o):(this._events[i]=o,this._eventsCount++),this},s.prototype.once=function(t,e,n){var o=new a(e,n||this,!0),i=r?r+t:t;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],o]:this._events[i].push(o):(this._events[i]=o,this._eventsCount++),this},s.prototype.removeListener=function(t,e,n,o){var a=r?r+t:t;if(!this._events[a])return this;if(!e)return 0==--this._eventsCount?this._events=new i:delete this._events[a],this;var s=this._events[a];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||(0==--this._eventsCount?this._events=new i:delete this._events[a]);else{for(var c=0,l=[],d=s.length;c<d;c++)(s[c].fn!==e||o&&!s[c].once||n&&s[c].context!==n)&&l.push(s[c]);l.length?this._events[a]=1===l.length?l[0]:l:0==--this._eventsCount?this._events=new i:delete this._events[a]}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&(0==--this._eventsCount?this._events=new i:delete this._events[e])):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=r,s.EventEmitter=s,t.exports=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){this.head=this.tail=null,this.length=0}return t.prototype.append=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.insertBefore(t[0],null),t.length>1&&this.append.apply(this,t.slice(1))},t.prototype.contains=function(t){for(var e,n=this.iterator();e=n();)if(e===t)return!0;return!1},t.prototype.insertBefore=function(t,e){t&&(t.next=e,null!=e?(t.prev=e.prev,null!=e.prev&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):null!=this.tail?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)},t.prototype.offset=function(t){for(var e=0,n=this.head;null!=n;){if(n===t)return e;e+=n.length(),n=n.next}return-1},t.prototype.remove=function(t){this.contains(t)&&(null!=t.prev&&(t.prev.next=t.next),null!=t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)},t.prototype.iterator=function(t){return void 0===t&&(t=this.head),function(){var e=t;return null!=t&&(t=t.next),e}},t.prototype.find=function(t,e){void 0===e&&(e=!1);for(var n,o=this.iterator();n=o();){var r=n.length();if(t<r||e&&t===r&&(null==n.next||0!==n.next.length()))return[n,t];t-=r}return[null,0]},t.prototype.forEach=function(t){for(var e,n=this.iterator();e=n();)t(e)},t.prototype.forEachAt=function(t,e,n){if(!(e<=0))for(var o,r=this.find(t),i=r[0],a=t-r[1],s=this.iterator(i);(o=s())&&a<t+e;){var c=o.length();t>a?n(o,t-a,Math.min(e,a+c-t)):n(o,0,Math.min(c,t+e-a)),a+=c}},t.prototype.map=function(t){return this.reduce(function(e,n){return e.push(t(n)),e},[])},t.prototype.reduce=function(t,e){for(var n,o=this.iterator();n=o();)e=t(e,n);return e},t}();e.default=o},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),a=n(3),s={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},c=function(t){function e(e){var n=t.call(this,e)||this;return n.scroll=n,n.observer=new MutationObserver(function(t){n.update(t)}),n.observer.observe(n.domNode,s),n.attach(),n}return r(e,t),e.prototype.detach=function(){t.prototype.detach.call(this),this.observer.disconnect()},e.prototype.deleteAt=function(e,n){this.update(),0===e&&n===this.length()?this.children.forEach(function(t){t.remove()}):t.prototype.deleteAt.call(this,e,n)},e.prototype.formatAt=function(e,n,o,r){this.update(),t.prototype.formatAt.call(this,e,n,o,r)},e.prototype.insertAt=function(e,n,o){this.update(),t.prototype.insertAt.call(this,e,n,o)},e.prototype.optimize=function(e,n){var o=this;void 0===e&&(e=[]),void 0===n&&(n={}),t.prototype.optimize.call(this,n);for(var r=[].slice.call(this.observer.takeRecords());r.length>0;)e.push(r.pop());for(var s=function(t,e){void 0===e&&(e=!0),null!=t&&t!==o&&null!=t.domNode.parentNode&&(null==t.domNode[a.DATA_KEY].mutations&&(t.domNode[a.DATA_KEY].mutations=[]),e&&s(t.parent))},c=function(t){null!=t.domNode[a.DATA_KEY]&&null!=t.domNode[a.DATA_KEY].mutations&&(t instanceof i.default&&t.children.forEach(c),t.optimize(n))},l=e,d=0;l.length>0;d+=1){if(d>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(l.forEach(function(t){var e=a.find(t.target,!0);null!=e&&(e.domNode===t.target&&("childList"===t.type?(s(a.find(t.previousSibling,!1)),[].forEach.call(t.addedNodes,function(t){var e=a.find(t,!1);s(e,!1),e instanceof i.default&&e.children.forEach(function(t){s(t,!1)})})):"attributes"===t.type&&s(e.prev)),s(e))}),this.children.forEach(c),r=(l=[].slice.call(this.observer.takeRecords())).slice();r.length>0;)e.push(r.pop())}},e.prototype.update=function(e,n){var o=this;void 0===n&&(n={}),(e=e||this.observer.takeRecords()).map(function(t){var e=a.find(t.target,!0);return null==e?null:null==e.domNode[a.DATA_KEY].mutations?(e.domNode[a.DATA_KEY].mutations=[t],e):(e.domNode[a.DATA_KEY].mutations.push(t),null)}).forEach(function(t){null!=t&&t!==o&&null!=t.domNode[a.DATA_KEY]&&t.update(t.domNode[a.DATA_KEY].mutations||[],n)}),null!=this.domNode[a.DATA_KEY].mutations&&t.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,n),this.optimize(e,n)},e.blotName="scroll",e.defaultChild="block",e.scope=a.Scope.BLOCK_BLOT,e.tagName="DIV",e}(i.default);e.default=c},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),a=n(3),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.formats=function(n){if(n.tagName!==e.tagName)return t.formats.call(this,n)},e.prototype.format=function(n,o){var r=this;n!==this.statics.blotName||o?t.prototype.format.call(this,n,o):(this.children.forEach(function(t){t instanceof i.default||(t=t.wrap(e.blotName,!0)),r.attributes.copy(t)}),this.unwrap())},e.prototype.formatAt=function(e,n,o,r){null!=this.formats()[o]||a.query(o,a.Scope.ATTRIBUTE)?this.isolate(e,n).format(o,r):t.prototype.formatAt.call(this,e,n,o,r)},e.prototype.optimize=function(n){t.prototype.optimize.call(this,n);var o=this.formats();if(0===Object.keys(o).length)return this.unwrap();var r=this.next;r instanceof e&&r.prev===this&&function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var n in t)if(t[n]!==e[n])return!1;return!0}(o,r.formats())&&(r.moveChildren(this),r.remove())},e.blotName="inline",e.scope=a.Scope.INLINE_BLOT,e.tagName="SPAN",e}(i.default);e.default=s},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),a=n(3),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.formats=function(n){var o=a.query(e.blotName).tagName;if(n.tagName!==o)return t.formats.call(this,n)},e.prototype.format=function(n,o){null!=a.query(n,a.Scope.BLOCK)&&(n!==this.statics.blotName||o?t.prototype.format.call(this,n,o):this.replaceWith(e.blotName))},e.prototype.formatAt=function(e,n,o,r){null!=a.query(o,a.Scope.BLOCK)?this.format(o,r):t.prototype.formatAt.call(this,e,n,o,r)},e.prototype.insertAt=function(e,n,o){if(null==o||null!=a.query(n,a.Scope.INLINE))t.prototype.insertAt.call(this,e,n,o);else{var r=this.split(e),i=a.create(n,o);r.parent.insertBefore(i,r)}},e.prototype.update=function(e,n){navigator.userAgent.match(/Trident/)?this.build():t.prototype.update.call(this,e,n)},e.blotName="block",e.scope=a.Scope.BLOCK_BLOT,e.tagName="P",e}(i.default);e.default=s},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.formats=function(t){},e.prototype.format=function(e,n){t.prototype.formatAt.call(this,0,this.length(),e,n)},e.prototype.formatAt=function(e,n,o,r){0===e&&n===this.length()?this.format(o,r):t.prototype.formatAt.call(this,e,n,o,r)},e.prototype.formats=function(){return this.statics.formats(this.domNode)},e}(n(10).default);e.default=i},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(10),a=n(3),s=function(t){function e(e){var n=t.call(this,e)||this;return n.text=n.statics.value(n.domNode),n}return r(e,t),e.create=function(t){return document.createTextNode(t)},e.value=function(t){var e=t.data;return e.normalize&&(e=e.normalize()),e},e.prototype.deleteAt=function(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)},e.prototype.index=function(t,e){return this.domNode===t?e:-1},e.prototype.insertAt=function(e,n,o){null==o?(this.text=this.text.slice(0,e)+n+this.text.slice(e),this.domNode.data=this.text):t.prototype.insertAt.call(this,e,n,o)},e.prototype.length=function(){return this.text.length},e.prototype.optimize=function(n){t.prototype.optimize.call(this,n),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof e&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},e.prototype.position=function(t,e){return void 0===e&&(e=!1),[this.domNode,t]},e.prototype.split=function(t,e){if(void 0===e&&(e=!1),!e){if(0===t)return this;if(t===this.length())return this.next}var n=a.create(this.domNode.splitText(t));return this.parent.insertBefore(n,this.next),this.text=this.statics.value(this.domNode),n},e.prototype.update=function(t,e){var n=this;t.some(function(t){return"characterData"===t.type&&t.target===n.domNode})&&(this.text=this.statics.value(this.domNode))},e.prototype.value=function(){return this.text},e.blotName="text",e.scope=a.Scope.INLINE_BLOT,e}(i.default);e.default=s},function(t,e){var n=document.createElement("div");if(n.classList.toggle("test-class",!1),n.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return arguments.length>1&&!this.contains(t)==!e?e:o.call(this,t)}}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var n=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>n.length)&&(e=n.length),e-=t.length;var o=n.indexOf(t,e);return-1!==o&&o===e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),o=n.length>>>0,r=arguments[1],i=0;i<o;i++)if(e=n[i],t.call(r,e,i,n))return e}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,e){var n=-1,o=1,r=0;function i(t,e,l){if(t==e)return t?[[r,t]]:[];(l<0||t.length<l)&&(l=null);var p=s(t,e),u=t.substring(0,p);p=c(t=t.substring(p),e=e.substring(p));var f=t.substring(t.length-p),h=function(t,e){var l;if(!t)return[[o,e]];if(!e)return[[n,t]];var d=t.length>e.length?t:e,p=t.length>e.length?e:t,u=d.indexOf(p);if(-1!=u)return l=[[o,d.substring(0,u)],[r,p],[o,d.substring(u+p.length)]],t.length>e.length&&(l[0][0]=l[2][0]=n),l;if(1==p.length)return[[n,t],[o,e]];var f=function(t,e){var n=t.length>e.length?t:e,o=t.length>e.length?e:t;if(n.length<4||2*o.length<n.length)return null;function r(t,e,n){for(var o,r,i,a,l=t.substring(n,n+Math.floor(t.length/4)),d=-1,p="";-1!=(d=e.indexOf(l,d+1));){var u=s(t.substring(n),e.substring(d)),f=c(t.substring(0,n),e.substring(0,d));p.length<f+u&&(p=e.substring(d-f,d)+e.substring(d,d+u),o=t.substring(0,n-f),r=t.substring(n+u),i=e.substring(0,d-f),a=e.substring(d+u))}return 2*p.length>=t.length?[o,r,i,a,p]:null}var i,a,l,d,p,u=r(n,o,Math.ceil(n.length/4)),f=r(n,o,Math.ceil(n.length/2));return u||f?(i=f?u&&u[4].length>f[4].length?u:f:u,t.length>e.length?(a=i[0],l=i[1],d=i[2],p=i[3]):(d=i[0],p=i[1],a=i[2],l=i[3]),[a,l,d,p,i[4]]):null}(t,e);if(f){var h=f[0],m=f[1],y=f[2],g=f[3],b=f[4],v=i(h,y),C=i(m,g);return v.concat([[r,b]],C)}return function(t,e){for(var r=t.length,i=e.length,s=Math.ceil((r+i)/2),c=s,l=2*s,d=new Array(l),p=new Array(l),u=0;u<l;u++)d[u]=-1,p[u]=-1;d[c+1]=0,p[c+1]=0;for(var f=r-i,h=f%2!=0,m=0,y=0,g=0,b=0,v=0;v<s;v++){for(var C=-v+m;C<=v-y;C+=2){for(var x=c+C,T=(w=C==-v||C!=v&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-C;w<r&&T<i&&t.charAt(w)==e.charAt(T);)w++,T++;if(d[x]=w,w>r)y+=2;else if(T>i)m+=2;else if(h&&(E=c+f-C)>=0&&E<l&&-1!=p[E]){var O=r-p[E];if(w>=O)return a(t,e,w,T)}}for(var S=-v+g;S<=v-b;S+=2){for(var E=c+S,P=(O=S==-v||S!=v&&p[E-1]<p[E+1]?p[E+1]:p[E-1]+1)-S;O<r&&P<i&&t.charAt(r-O-1)==e.charAt(i-P-1);)O++,P++;if(p[E]=O,O>r)b+=2;else if(P>i)g+=2;else if(!h&&(x=c+f-S)>=0&&x<l&&-1!=d[x]){var w=d[x];if(T=c+w-x,w>=(O=r-O))return a(t,e,w,T)}}}return[[n,t],[o,e]]}(t,e)}(t=t.substring(0,t.length-p),e=e.substring(0,e.length-p));return u&&h.unshift([r,u]),f&&h.push([r,f]),function t(e){e.push([r,""]);for(var i,a=0,l=0,d=0,p="",u="";a<e.length;)switch(e[a][0]){case o:d++,u+=e[a][1],a++;break;case n:l++,p+=e[a][1],a++;break;case r:l+d>1?(0!==l&&0!==d&&(0!==(i=s(u,p))&&(a-l-d>0&&e[a-l-d-1][0]==r?e[a-l-d-1][1]+=u.substring(0,i):(e.splice(0,0,[r,u.substring(0,i)]),a++),u=u.substring(i),p=p.substring(i)),0!==(i=c(u,p))&&(e[a][1]=u.substring(u.length-i)+e[a][1],u=u.substring(0,u.length-i),p=p.substring(0,p.length-i))),0===l?e.splice(a-d,l+d,[o,u]):0===d?e.splice(a-l,l+d,[n,p]):e.splice(a-l-d,l+d,[n,p],[o,u]),a=a-l-d+(l?1:0)+(d?1:0)+1):0!==a&&e[a-1][0]==r?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,d=0,l=0,p="",u=""}""===e[e.length-1][1]&&e.pop();var f=!1;for(a=1;a<e.length-1;)e[a-1][0]==r&&e[a+1][0]==r&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)==e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),f=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),f=!0)),a++;f&&t(e)}(h),null!=l&&(h=function(t,e){var o=function(t,e){if(0===e)return[r,t];for(var o=0,i=0;i<t.length;i++){var a=t[i];if(a[0]===n||a[0]===r){var s=o+a[1].length;if(e===s)return[i+1,t];if(e<s){t=t.slice();var c=e-o,l=[a[0],a[1].slice(0,c)],d=[a[0],a[1].slice(c)];return t.splice(i,1,l,d),[i+1,t]}o=s}}throw new Error("cursor_pos is out of bounds!")}(t,e),i=o[1],a=o[0],s=i[a],c=i[a+1];if(null==s)return t;if(s[0]!==r)return t;if(null!=c&&s[1]+c[1]===c[1]+s[1])return i.splice(a,2,c,s),d(i,a,2);if(null!=c&&0===c[1].indexOf(s[1])){i.splice(a,2,[c[0],s[1]],[0,s[1]]);var l=c[1].slice(s[1].length);return l.length>0&&i.splice(a+2,0,[c[0],l]),d(i,a,3)}return t}(h,l)),function(t){for(var e=!1,i=function(t){return t.charCodeAt(0)>=56320&&t.charCodeAt(0)<=57343},a=function(t){return t.charCodeAt(t.length-1)>=55296&&t.charCodeAt(t.length-1)<=56319},s=2;s<t.length;s+=1)t[s-2][0]===r&&a(t[s-2][1])&&t[s-1][0]===n&&i(t[s-1][1])&&t[s][0]===o&&i(t[s][1])&&(e=!0,t[s-1][1]=t[s-2][1].slice(-1)+t[s-1][1],t[s][1]=t[s-2][1].slice(-1)+t[s][1],t[s-2][1]=t[s-2][1].slice(0,-1));if(!e)return t;var c=[];for(s=0;s<t.length;s+=1)t[s][1].length>0&&c.push(t[s]);return c}(h)}function a(t,e,n,o){var r=t.substring(0,n),a=e.substring(0,o),s=t.substring(n),c=e.substring(o),l=i(r,a),d=i(s,c);return l.concat(d)}function s(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,o=Math.min(t.length,e.length),r=o,i=0;n<r;)t.substring(i,r)==e.substring(i,r)?i=n=r:o=r,r=Math.floor((o-n)/2+n);return r}function c(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,o=Math.min(t.length,e.length),r=o,i=0;n<r;)t.substring(t.length-r,t.length-i)==e.substring(e.length-r,e.length-i)?i=n=r:o=r,r=Math.floor((o-n)/2+n);return r}var l=i;function d(t,e,n){for(var o=e+n-1;o>=0&&o>=e-1;o--)if(o+1<t.length){var r=t[o],i=t[o+1];r[0]===i[1]&&t.splice(o,2,[r[0],r[1]+i[1]])}return t}l.INSERT=o,l.DELETE=n,l.EQUAL=r,t.exports=l},function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function i(t){return t&&"object"==n(t)&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=o?r:i).supported=r,e.unsupported=i},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var o=n(28),r=n(29),i=n(30);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return p(this,t)}return l(this,t,e,n)}function l(t,e,n,o){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,o){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===o?new Uint8Array(e):void 0===o?new Uint8Array(e,n):new Uint8Array(e,n,o),c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=u(t,e),t}(t,e,n,o):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|h(e,n),r=(t=s(t,o)).write(e,n);return r!==o&&(t=t.slice(0,r)),t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|f(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(o=e.length)!=o?s(t,0):u(t,e);if("Buffer"===e.type&&i(e.data))return u(t,e.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function d(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function p(t,e){if(d(e),t=s(t,e<0?0:0|f(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function u(t,e){var n=e.length<0?0:0|f(e.length);t=s(t,n);for(var o=0;o<n;o+=1)t[o]=255&e[o];return t}function f(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function h(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(t).length;default:if(o)return H(t).length;e=(""+e).toLowerCase(),o=!0}}function m(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function y(t,e,n,o,r){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=c.from(e,o)),c.isBuffer(e))return 0===e.length?-1:g(t,e,n,o,r);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,o,r);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,o,r){var i,a=1,s=t.length,c=e.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(t.length<2||e.length<2)return-1;a=2,s/=2,c/=2,n/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(r){var d=-1;for(i=n;i<s;i++)if(l(t,i)===l(e,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===c)return d*a}else-1!==d&&(i-=i-d),d=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var p=!0,u=0;u<c;u++)if(l(t,i+u)!==l(e,u)){p=!1;break}if(p)return i}return-1}function b(t,e,n,o){n=Number(n)||0;var r=t.length-n;o?(o=Number(o))>r&&(o=r):o=r;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");o>i/2&&(o=i/2);for(var a=0;a<o;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function v(t,e,n,o){return z(H(e,t.length-n),t,n,o)}function C(t,e,n,o){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,o)}function x(t,e,n,o){return C(t,e,n,o)}function T(t,e,n,o){return z(U(e),t,n,o)}function O(t,e,n,o){return z(function(t,e){for(var n,o,r,i=[],a=0;a<t.length&&!((e-=2)<0);++a)o=(n=t.charCodeAt(a))>>8,r=n%256,i.push(r),i.push(o);return i}(e,t.length-n),t,n,o)}function S(t,e,n){return 0===e&&n===t.length?o.fromByteArray(t):o.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var o=[],r=e;r<n;){var i,a,s,c,l=t[r],d=null,p=l>239?4:l>223?3:l>191?2:1;if(r+p<=n)switch(p){case 1:l<128&&(d=l);break;case 2:128==(192&(i=t[r+1]))&&(c=(31&l)<<6|63&i)>127&&(d=c);break;case 3:i=t[r+1],a=t[r+2],128==(192&i)&&128==(192&a)&&(c=(15&l)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(d=c);break;case 4:i=t[r+1],a=t[r+2],s=t[r+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(d=c)}null===d?(d=65533,p=1):d>65535&&(d-=65536,o.push(d>>>10&1023|55296),d=56320|1023&d),o.push(d),r+=p}return function(t){var e=t.length;if(e<=P)return String.fromCharCode.apply(String,t);for(var n="",o=0;o<e;)n+=String.fromCharCode.apply(String,t.slice(o,o+=P));return n}(o)}e.Buffer=c,e.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return l(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,o){return d(e),e<=0?s(t,e):void 0!==n?"string"==typeof o?s(t,e).fill(n,o):s(t,e).fill(n):s(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return p(null,t)},c.allocUnsafeSlow=function(t){return p(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,o=e.length,r=0,i=Math.min(n,o);r<i;++r)if(t[r]!==e[r]){n=t[r],o=e[r];break}return n<o?-1:o<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var o=c.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(o,r),r+=a.length}return o},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):function(t,e,n){var o=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return w(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,n);default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,o,r){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===r&&(r=this.length),e<0||n>t.length||o<0||r>this.length)throw new RangeError("out of range index");if(o>=r&&e>=n)return 0;if(o>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(r>>>=0)-(o>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(i,a),l=this.slice(o,r),d=t.slice(e,n),p=0;p<s;++p)if(l[p]!==d[p]){i=l[p],a=d[p];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},c.prototype.write=function(t,e,n,o){if(void 0===e)o="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)o=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return v(this,t,e,n);case"ascii":return C(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return T(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function w(t,e,n){var o="";n=Math.min(t.length,n);for(var r=e;r<n;++r)o+=String.fromCharCode(127&t[r]);return o}function I(t,e,n){var o="";n=Math.min(t.length,n);for(var r=e;r<n;++r)o+=String.fromCharCode(t[r]);return o}function k(t,e,n){var o=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>o)&&(n=o);for(var r="",i=e;i<n;++i)r+=F(t[i]);return r}function R(t,e,n){for(var o=t.slice(e,n),r="",i=0;i<o.length;i+=2)r+=String.fromCharCode(o[i]+256*o[i+1]);return r}function A(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,n,o,r,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<i)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function j(t,e,n,o){e<0&&(e=65535+e+1);for(var r=0,i=Math.min(t.length-n,2);r<i;++r)t[n+r]=(e&255<<8*(o?r:1-r))>>>8*(o?r:1-r)}function N(t,e,n,o){e<0&&(e=4294967295+e+1);for(var r=0,i=Math.min(t.length-n,4);r<i;++r)t[n+r]=e>>>8*(o?r:3-r)&255}function M(t,e,n,o,r,i){if(n+o>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function _(t,e,n,o,i){return i||M(t,0,n,4),r.write(t,e,n,o,23,4),n+4}function B(t,e,n,o,i){return i||M(t,0,n,8),r.write(t,e,n,o,52,8),n+8}c.prototype.slice=function(t,e){var n,o=this.length;if((t=~~t)<0?(t+=o)<0&&(t=0):t>o&&(t=o),(e=void 0===e?o:~~e)<0?(e+=o)<0&&(e=0):e>o&&(e=o),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var r=e-t;n=new c(r,void 0);for(var i=0;i<r;++i)n[i]=this[i+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var o=this[t],r=1,i=0;++i<e&&(r*=256);)o+=this[t+i]*r;return o},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var o=this[t+--e],r=1;e>0&&(r*=256);)o+=this[t+--e]*r;return o},c.prototype.readUInt8=function(t,e){return e||A(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||A(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||A(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||A(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var o=this[t],r=1,i=0;++i<e&&(r*=256);)o+=this[t+i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var o=e,r=1,i=this[t+--o];o>0&&(r*=256);)i+=this[t+--o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return e||A(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||A(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||A(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||A(t,4,this.length),r.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||A(t,4,this.length),r.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||A(t,8,this.length),r.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||A(t,8,this.length),r.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,o){t=+t,e|=0,n|=0,o||D(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,i=0;for(this[e]=255&t;++i<n&&(r*=256);)this[e+i]=t/r&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,o){t=+t,e|=0,n|=0,o||D(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,i=1;for(this[e+r]=255&t;--r>=0&&(i*=256);)this[e+r]=t/i&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):N(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,o){if(t=+t,e|=0,!o){var r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}var i=0,a=1,s=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,o){if(t=+t,e|=0,!o){var r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}var i=n-1,a=1,s=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return _(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return _(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,o){if(n||(n=0),o||0===o||(o=this.length),e>=t.length&&(e=t.length),e||(e=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-n&&(o=t.length-e+n);var r,i=o-n;if(this===t&&n<e&&e<o)for(r=i-1;r>=0;--r)t[r+e]=this[r+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<i;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},c.prototype.fill=function(t,e,n,o){if("string"==typeof t){if("string"==typeof e?(o=e,e=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!c.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var a=c.isBuffer(t)?t:H(new c(t,o).toString()),s=a.length;for(i=0;i<n-e;++i)this[i+e]=a[i%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){var n;e=e||1/0;for(var o=t.length,r=null,i=[],a=0;a<o;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===o){(e-=3)>-1&&i.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&i.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function U(t){return o.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(L,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,o){for(var r=0;r<o&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(27))},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":n(window))&&(o=window)}t.exports=o},function(t,e,n){"use strict";e.byteLength=function(t){var e=l(t),n=e[0],o=e[1];return 3*(n+o)/4-o},e.toByteArray=function(t){for(var e,n=l(t),o=n[0],a=n[1],s=new i(3*(o+a)/4-a),c=0,d=a>0?o-4:o,p=0;p<d;p+=4)e=r[t.charCodeAt(p)]<<18|r[t.charCodeAt(p+1)]<<12|r[t.charCodeAt(p+2)]<<6|r[t.charCodeAt(p+3)],s[c++]=e>>16&255,s[c++]=e>>8&255,s[c++]=255&e;return 2===a&&(e=r[t.charCodeAt(p)]<<2|r[t.charCodeAt(p+1)]>>4,s[c++]=255&e),1===a&&(e=r[t.charCodeAt(p)]<<10|r[t.charCodeAt(p+1)]<<4|r[t.charCodeAt(p+2)]>>2,s[c++]=e>>8&255,s[c++]=255&e),s},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,i=[],a=0,s=n-r;a<s;a+=16383)i.push(d(t,a,a+16383>s?s:a+16383));return 1===r?(e=t[n-1],i.push(o[e>>2]+o[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],i.push(o[e>>10]+o[e>>4&63]+o[e<<2&63]+"=")),i.join("")};for(var o=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)o[s]=a[s],r[a.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function d(t,e,n){for(var r,i,a=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(o[(i=r)>>18&63]+o[i>>12&63]+o[i>>6&63]+o[63&i]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,o,r){var i,a,s=8*r-o-1,c=(1<<s)-1,l=c>>1,d=-7,p=n?r-1:0,u=n?-1:1,f=t[e+p];for(p+=u,i=f&(1<<-d)-1,f>>=-d,d+=s;d>0;i=256*i+t[e+p],p+=u,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=o;d>0;a=256*a+t[e+p],p+=u,d-=8);if(0===i)i=1-l;else{if(i===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,o),i-=l}return(f?-1:1)*a*Math.pow(2,i-o)},e.write=function(t,e,n,o,r,i){var a,s,c,l=8*i-r-1,d=(1<<l)-1,p=d>>1,u=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=o?0:i-1,h=o?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=d):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),(e+=a+p>=1?u/c:u*Math.pow(2,1-p))*c>=2&&(a++,c/=2),a+p>=d?(s=0,a=d):a+p>=1?(s=(e*c-1)*Math.pow(2,r),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,r),a=0));r>=8;t[n+f]=255&s,f+=h,s/=256,r-=8);for(a=a<<r|s,l+=r;l>0;t[n+f]=255&a,f+=h,a/=256,l-=8);t[n+f-h]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),i=(n(22),n(1)),a=n.n(i),s=n(6),c=n.n(s),l=n(2),d=n.n(l);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,h(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,r.a.Embed),n=e,i=[{key:"value",value:function(){}}],(o=[{key:"insertInto",value:function(t,n){0===t.children.length?f(h(e.prototype),"insertInto",this).call(this,t,n):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}])&&u(n.prototype,o),i&&u(n,i),e}();y.blotName="break",y.tagName="BR";var g=y;function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var x=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,v(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(e,r.a.Text),e}();function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function S(t,e,n){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var w=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,E(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,r.a.Inline),n=e,i=[{key:"compare",value:function(t,n){var o=e.order.indexOf(t),r=e.order.indexOf(n);return o>=0||r>=0?o-r:t===n?0:t<n?-1:1}}],(o=[{key:"formatAt",value:function(t,n,o,i){if(e.compare(this.statics.blotName,o)<0&&r.a.query(o,r.a.Scope.BLOT)){var a=this.isolate(t,n);i&&a.wrap(o,i)}else S(E(e.prototype),"formatAt",this).call(this,t,n,o,i)}},{key:"optimize",value:function(t){if(S(E(e.prototype),"optimize",this).call(this,t),this.parent instanceof e&&e.compare(this.statics.blotName,this.parent.statics.blotName)>0){var n=this.parent.isolate(this.offset(),this.length());this.moveChildren(n),n.wrap(this)}}}])&&O(n.prototype,o),i&&O(n,i),e}();w.allowedChildren=[w,r.a.Embed,x],w.order=["cursor","inline","underline","strike","italic","bold","script","link","code"];var I=w;function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function D(t,e,n){return e&&A(t.prototype,e),n&&A(t,n),t}function j(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function N(t,e,n){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}var B=function(t){function e(){return R(this,e),j(this,M(e).apply(this,arguments))}return _(e,r.a.Embed),D(e,[{key:"attach",value:function(){N(M(e.prototype),"attach",this).call(this),this.attributes=new r.a.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return(new a.a).insert(this.value(),d()(this.formats(),this.attributes.values()))}},{key:"format",value:function(t,e){var n=r.a.query(t,r.a.Scope.BLOCK_ATTRIBUTE);null!=n&&this.attributes.attribute(n,e)}},{key:"formatAt",value:function(t,e,n,o){this.format(n,o)}},{key:"insertAt",value:function(t,n,o){if("string"==typeof n&&n.endsWith("\n")){var i=r.a.create(L.blotName);this.parent.insertBefore(i,0===t?this:this.next),i.insertAt(0,n.slice(0,-1))}else N(M(e.prototype),"insertAt",this).call(this,t,n,o)}}]),e}();B.scope=r.a.Scope.BLOCK_BLOT;var L=function(t){function e(t){var n;return R(this,e),(n=j(this,M(e).call(this,t))).cache={},n}return _(e,r.a.Block),D(e,[{key:"delta",value:function(){return null==this.cache.delta&&(this.cache.delta=this.descendants(r.a.Leaf).reduce(function(t,e){return 0===e.length()?t:t.insert(e.value(),F(e))},new a.a).insert("\n",F(this))),this.cache.delta}},{key:"deleteAt",value:function(t,n){N(M(e.prototype),"deleteAt",this).call(this,t,n),this.cache={}}},{key:"formatAt",value:function(t,n,o,i){n<=0||(r.a.query(o,r.a.Scope.BLOCK)?t+n===this.length()&&this.format(o,i):N(M(e.prototype),"formatAt",this).call(this,t,Math.min(n,this.length()-t-1),o,i),this.cache={})}},{key:"insertAt",value:function(t,n,o){if(null!=o)return N(M(e.prototype),"insertAt",this).call(this,t,n,o);if(0!==n.length){var r=n.split("\n"),i=r.shift();i.length>0&&(t<this.length()-1||null==this.children.tail?N(M(e.prototype),"insertAt",this).call(this,Math.min(t,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});var a=this;r.reduce(function(t,e){return(a=a.split(t,!0)).insertAt(0,e),e.length},t+i.length)}}},{key:"insertBefore",value:function(t,n){var o=this.children.head;N(M(e.prototype),"insertBefore",this).call(this,t,n),o instanceof g&&o.remove(),this.cache={}}},{key:"length",value:function(){return null==this.cache.length&&(this.cache.length=N(M(e.prototype),"length",this).call(this)+1),this.cache.length}},{key:"moveChildren",value:function(t,n){N(M(e.prototype),"moveChildren",this).call(this,t,n),this.cache={}}},{key:"optimize",value:function(t){N(M(e.prototype),"optimize",this).call(this,t),this.cache={}}},{key:"path",value:function(t){return N(M(e.prototype),"path",this).call(this,t,!0)}},{key:"removeChild",value:function(t){N(M(e.prototype),"removeChild",this).call(this,t),this.cache={}}},{key:"split",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n&&(0===t||t>=this.length()-1)){var o=this.clone();return 0===t?(this.parent.insertBefore(o,this),this):(this.parent.insertBefore(o,this.next),o)}var r=N(M(e.prototype),"split",this).call(this,t,n);return this.cache={},r}}]),e}();function F(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==t?e:("function"==typeof t.formats&&(e=d()(e,t.formats())),null==t.parent||"scroll"==t.parent.blotName||t.parent.statics.scope!==t.statics.scope?e:F(t.parent,e))}function H(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function U(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function z(t,e,n){return(z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=G(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t,e){return!e||"object"!==V(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}L.blotName="block",L.tagName="P",L.defaultChild="break",L.allowedChildren=[I,r.a.Embed,x];var Y=function(t){function e(){return q(this,e),K(this,G(e).apply(this,arguments))}return W(e,I),e}();Y.blotName="code",Y.tagName="CODE";var Q=function(t){function e(){return q(this,e),K(this,G(e).apply(this,arguments))}var n,o,i;return W(e,L),n=e,i=[{key:"create",value:function(t){var n=z(G(e),"create",this).call(this,t);return n.setAttribute("spellcheck",!1),n}},{key:"formats",value:function(){return!0}}],(o=[{key:"delta",value:function(){var t=this,e=this.domNode.textContent;return e.endsWith("\n")&&(e=e.slice(0,-1)),e.split("\n").reduce(function(e,n){return e.insert(n).insert("\n",t.formats())},new a.a)}},{key:"format",value:function(t,n){if(t!==this.statics.blotName||!n){var o=H(this.descendant(x,this.length()-1),1)[0];null!=o&&o.deleteAt(o.length()-1,1),z(G(e.prototype),"format",this).call(this,t,n)}}},{key:"formatAt",value:function(t,n,o,i){if(0!==n&&null!=r.a.query(o,r.a.Scope.BLOCK)&&(o!==this.statics.blotName||i!==this.statics.formats(this.domNode))){var a=this.newlineIndex(t);if(!(a<0||a>=t+n)){var s=this.newlineIndex(t,!0)+1,c=a-s+1,l=this.isolate(s,c),d=l.next;l.format(o,i),d instanceof e&&d.formatAt(0,t-s+n-c,o,i)}}}},{key:"insertAt",value:function(t,e,n){if(null==n){var o=H(this.descendant(x,t),2),r=o[0],i=o[1];r.insertAt(i,e)}}},{key:"length",value:function(){var t=this.domNode.textContent.length;return this.domNode.textContent.endsWith("\n")?t:t+1}},{key:"newlineIndex",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return this.domNode.textContent.slice(0,t).lastIndexOf("\n");var e=this.domNode.textContent.slice(t).indexOf("\n");return e>-1?t+e:-1}},{key:"optimize",value:function(t){this.domNode.textContent.endsWith("\n")||this.appendChild(r.a.create("text","\n")),z(G(e.prototype),"optimize",this).call(this,t);var n=this.next;null!=n&&n.prev===this&&n.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===n.statics.formats(n.domNode)&&(n.optimize(t),n.moveChildren(this),n.remove())}},{key:"replace",value:function(t){z(G(e.prototype),"replace",this).call(this,t),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(t){var e=r.a.find(t);null==e?t.parentNode.removeChild(t):e instanceof r.a.Embed?e.remove():e.unwrap()})}}])&&U(n.prototype,o),i&&U(n,i),e}();function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function X(t,e,n){return(X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Z(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Z(t){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function tt(t,e,n){return e&&$(t.prototype,e),n&&$(t,n),t}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Q.blotName="code-block",Q.tagName="PRE",Q.TAB="  ";var nt=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,Z(e).call(this,t))).selection=n,o.textNode=document.createTextNode(e.CONTENTS),o.domNode.appendChild(o.textNode),o._length=0,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(e,r.a.Embed),tt(e,null,[{key:"value",value:function(){}}]),tt(e,[{key:"detach",value:function(){null!=this.parent&&this.parent.removeChild(this)}},{key:"format",value:function(t,n){if(0!==this._length)return X(Z(e.prototype),"format",this).call(this,t,n);for(var o=this,i=0;null!=o&&o.statics.scope!==r.a.Scope.BLOCK_BLOT;)i+=o.offset(o.parent),o=o.parent;null!=o&&(this._length=e.CONTENTS.length,o.optimize(),o.formatAt(i,e.CONTENTS.length,t,n),this._length=0)}},{key:"index",value:function(t,n){return t===this.textNode?0:X(Z(e.prototype),"index",this).call(this,t,n)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){X(Z(e.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!this.selection.composing&&null!=this.parent){var t,n,o,i=this.textNode,a=this.selection.getNativeRange();if(null!=a&&a.start.node===i&&a.end.node===i){var s=[i,a.start.offset,a.end.offset];t=s[0],n=s[1],o=s[2]}for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==e.CONTENTS){var c=this.textNode.data.split(e.CONTENTS).join("");this.next instanceof x?(t=this.next.domNode,this.next.insertAt(0,c),this.textNode.data=e.CONTENTS):(this.textNode.data=c,this.parent.insertBefore(r.a.create(this.textNode),this),this.textNode=document.createTextNode(e.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),null!=n){var l=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}([n,o].map(function(e){return Math.max(0,Math.min(t.data.length,e-1))}),2);return n=l[0],o=l[1],{startNode:t,startOffset:n,endNode:t,endOffset:o}}}}},{key:"update",value:function(t,e){var n=this;if(t.some(function(t){return"characterData"===t.type&&t.target===n.textNode})){var o=this.restore();o&&(e.range=o)}}},{key:"value",value:function(){return""}}]),e}();nt.blotName="cursor",nt.className="ql-cursor",nt.tagName="span",nt.CONTENTS="\ufeff";var ot=nt,rt=n(4),it=n.n(rt),at=n(5),st=n.n(at);function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function dt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var pt=/^[ -~]*$/;function ut(t,e){return Object.keys(e).reduce(function(n,o){return null==t[o]?n:(e[o]===t[o]?n[o]=e[o]:Array.isArray(e[o])?e[o].indexOf(t[o])<0&&(n[o]=e[o].concat([t[o]])):n[o]=[e[o],t[o]],n)},{})}var ft=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scroll=e,this.delta=this.getDelta()}var e,n;return e=t,(n=[{key:"applyDelta",value:function(t){var e=this,n=!1;this.scroll.update();var o=this.scroll.length();return this.scroll.batchStart(),(t=function(t){return t.reduce(function(t,e){if(1===e.insert){var n=it()(e.attributes);return delete n.image,t.insert({image:e.attributes.image},n)}if(null==e.attributes||!0!==e.attributes.list&&!0!==e.attributes.bullet||((e=it()(e)).attributes.list?e.attributes.list="ordered":(e.attributes.list="bullet",delete e.attributes.bullet)),"string"==typeof e.insert){var o=e.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return t.insert(o,e.attributes)}return t.push(e)},new a.a)}(t)).reduce(function(t,i){var a=i.retain||i.delete||i.insert.length||1,s=i.attributes||{};if(null!=i.insert){if("string"==typeof i.insert){var l=i.insert;l.endsWith("\n")&&n&&(n=!1,l=l.slice(0,-1)),t>=o&&!l.endsWith("\n")&&(n=!0),e.scroll.insertAt(t,l);var p=lt(e.scroll.line(t),2),u=p[0],f=p[1],h=d()({},F(u));if(u instanceof L){var m=lt(u.descendant(r.a.Leaf,f),1)[0];h=d()(h,F(m))}s=c.a.attributes.diff(h,s)||{}}else if("object"===ct(i.insert)){var y=Object.keys(i.insert)[0];if(null==y)return t;e.scroll.insertAt(t,y,i.insert[y])}o+=a}return Object.keys(s).forEach(function(n){e.scroll.formatAt(t,a,n,s[n])}),t+a},0),t.reduce(function(t,n){return"number"==typeof n.delete?(e.scroll.deleteAt(t,n.delete),t):t+(n.retain||n.insert.length||1)},0),this.scroll.batchEnd(),this.update(t)}},{key:"deleteText",value:function(t,e){return this.scroll.deleteAt(t,e),this.update((new a.a).retain(t).delete(e))}},{key:"formatLine",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.scroll.update(),Object.keys(o).forEach(function(r){if(null==n.scroll.whitelist||n.scroll.whitelist[r]){var i=n.scroll.lines(t,Math.max(e,1)),a=e;i.forEach(function(e){var i=e.length();if(e instanceof Q){var s=t-e.offset(n.scroll),c=e.newlineIndex(s+a)-s+1;e.formatAt(s,c,r,o[r])}else e.format(r,o[r]);a-=i})}}),this.scroll.optimize(),this.update((new a.a).retain(t).retain(e,it()(o)))}},{key:"formatText",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.keys(o).forEach(function(r){n.scroll.formatAt(t,e,r,o[r])}),this.update((new a.a).retain(t).retain(e,it()(o)))}},{key:"getContents",value:function(t,e){return this.delta.slice(t,t+e)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(t,e){return t.concat(e.delta())},new a.a)}},{key:"getFormat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],o=[];0===e?this.scroll.path(t).forEach(function(t){var e=lt(t,1)[0];e instanceof L?n.push(e):e instanceof r.a.Leaf&&o.push(e)}):(n=this.scroll.lines(t,e),o=this.scroll.descendants(r.a.Leaf,t,e));var i=[n,o].map(function(t){if(0===t.length)return{};for(var e=F(t.shift());Object.keys(e).length>0;){var n=t.shift();if(null==n)return e;e=ut(F(n),e)}return e});return d.a.apply(d.a,i)}},{key:"getText",value:function(t,e){return this.getContents(t,e).filter(function(t){return"string"==typeof t.insert}).map(function(t){return t.insert}).join("")}},{key:"insertEmbed",value:function(t,e,n){return this.scroll.insertAt(t,e,n),this.update((new a.a).retain(t).insert(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,n)))}},{key:"insertText",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(t,e),Object.keys(o).forEach(function(r){n.scroll.formatAt(t,e.length,r,o[r])}),this.update((new a.a).retain(t).insert(e,it()(o)))}},{key:"isBlank",value:function(){if(0==this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;var t=this.scroll.children.head;return t.statics.blotName===L.blotName&&!(t.children.length>1)&&t.children.head instanceof g}},{key:"removeFormat",value:function(t,e){var n=this.getText(t,e),o=lt(this.scroll.line(t+e),2),r=o[0],i=o[1],s=0,c=new a.a;null!=r&&(s=r instanceof Q?r.newlineIndex(i)-i+1:r.length()-i,c=r.delta().slice(i,i+s-1).insert("\n"));var l=this.getContents(t,e+s).diff((new a.a).insert(n).concat(c)),d=(new a.a).retain(t).concat(l);return this.applyDelta(d)}},{key:"update",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=this.delta;if(1===e.length&&"characterData"===e[0].type&&e[0].target.data.match(pt)&&r.a.find(e[0].target)){var i=r.a.find(e[0].target),s=F(i),c=i.offset(this.scroll),l=e[0].oldValue.replace(ot.CONTENTS,""),d=(new a.a).insert(l),p=(new a.a).insert(i.value());t=(new a.a).retain(c).concat(d.diff(p,n)).reduce(function(t,e){return e.insert?t.insert(e.insert,s):t.push(e)},new a.a),this.delta=o.compose(t)}else this.delta=this.getDelta(),t&&st()(o.compose(t),this.delta)||(t=o.diff(this.delta,n));return t}}])&&dt(e.prototype,n),t}(),ht=n(15),mt=n.n(ht),yt=["error","warn","log","info"],gt="warn";function bt(t){if(yt.indexOf(t)<=yt.indexOf(gt)){for(var e,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(e=console)[t].apply(e,o)}}function vt(t){return yt.reduce(function(e,n){return e[n]=bt.bind(console,n,t),e},{})}bt.level=vt.level=function(t){gt=t};var Ct=vt;function xt(t){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ot(t,e,n){return(Ot="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pt=Ct("quill:events");["selectionchange","mousedown","mouseup","click"].forEach(function(t){document.addEventListener(t,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(t){var n;t.__quill&&t.__quill.emitter&&(n=t.__quill.emitter).handleDOM.apply(n,e)})})});var wt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e){return!e||"object"!==xt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,St(e).call(this))).listeners={},t.on("error",Pt.error),t}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(e,mt.a),n=e,(o=[{key:"emit",value:function(){Pt.log.apply(Pt,arguments),Ot(St(e.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];(this.listeners[t.type]||[]).forEach(function(e){var o=e.node,r=e.handler;(t.target===o||o.contains(t.target))&&r.apply(void 0,[t].concat(n))})}},{key:"listenDOM",value:function(t,e,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push({node:e,handler:n})}}])&&Tt(n.prototype,o),e}();wt.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},wt.sources={API:"api",SILENT:"silent",USER:"user"};var It=wt,kt=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quill=e,this.options=n};kt.DEFAULTS={};var Rt=kt;function At(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Dt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function jt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Mt=Ct("quill:selection"),_t=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Nt(this,t),this.index=e,this.length=n},Bt=function(){function t(e,n){var o=this;Nt(this,t),this.emitter=n,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=r.a.create("cursor",this),this.lastRange=this.savedRange=new _t(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){o.mouseDown||setTimeout(o.update.bind(o,It.sources.USER),1)}),this.emitter.on(It.events.EDITOR_CHANGE,function(t,e){t===It.events.TEXT_CHANGE&&e.length()>0&&o.update(It.sources.SILENT)}),this.emitter.on(It.events.SCROLL_BEFORE_UPDATE,function(){if(o.hasFocus()){var t=o.getNativeRange();null!=t&&t.start.node!==o.cursor.textNode&&o.emitter.once(It.events.SCROLL_UPDATE,function(){try{o.setNativeRange(t.start.node,t.start.offset,t.end.node,t.end.offset)}catch(t){}})}}),this.emitter.on(It.events.SCROLL_OPTIMIZE,function(t,e){if(e.range){var n=e.range,r=n.startNode,i=n.startOffset,a=n.endNode,s=n.endOffset;o.setNativeRange(r,i,a,s)}}),this.update(It.sources.SILENT)}var e,n;return e=t,(n=[{key:"handleComposition",value:function(){var t=this;this.root.addEventListener("compositionstart",function(){t.composing=!0}),this.root.addEventListener("compositionend",function(){if(t.composing=!1,t.cursor.parent){var e=t.cursor.restore();if(!e)return;setTimeout(function(){t.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}},{key:"handleDragging",value:function(){var t=this;this.emitter.listenDOM("mousedown",document.body,function(){t.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){t.mouseDown=!1,t.update(It.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(t,e){if(null==this.scroll.whitelist||this.scroll.whitelist[t]){this.scroll.update();var n=this.getNativeRange();if(null!=n&&n.native.collapsed&&!r.a.query(t,r.a.Scope.BLOCK)){if(n.start.node!==this.cursor.textNode){var o=r.a.find(n.start.node,!1);if(null==o)return;if(o instanceof r.a.Leaf){var i=o.split(n.start.offset);o.parent.insertBefore(this.cursor,i)}else o.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scroll.length();t=Math.min(t,n-1),e=Math.min(t+e,n-1)-t;var o,r=Dt(this.scroll.leaf(t),2),i=r[0],a=r[1];if(null==i)return null;var s=Dt(i.position(a,!0),2);o=s[0],a=s[1];var c=document.createRange();if(e>0){c.setStart(o,a);var l=Dt(this.scroll.leaf(t+e),2);if(i=l[0],a=l[1],null==i)return null;var d=Dt(i.position(a,!0),2);return o=d[0],a=d[1],c.setEnd(o,a),c.getBoundingClientRect()}var p,u="left";return o instanceof Text?(a<o.data.length?(c.setStart(o,a),c.setEnd(o,a+1)):(c.setStart(o,a-1),c.setEnd(o,a),u="right"),p=c.getBoundingClientRect()):(p=i.domNode.getBoundingClientRect(),a>0&&(u="right")),{bottom:p.top+p.height,height:p.height,left:p[u],right:p[u],top:p.top,width:0}}},{key:"getNativeRange",value:function(){var t=document.getSelection();if(null==t||t.rangeCount<=0)return null;var e=t.getRangeAt(0);if(null==e)return null;var n=this.normalizeNative(e);return Mt.info("getNativeRange",n),n}},{key:"getRange",value:function(){var t=this.getNativeRange();return null==t?[null,null]:[this.normalizedToRange(t),t]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(t){var e=this,n=[[t.start.node,t.start.offset]];t.native.collapsed||n.push([t.end.node,t.end.offset]);var o=n.map(function(t){var n=Dt(t,2),o=n[0],i=n[1],a=r.a.find(o,!0),s=a.offset(e.scroll);return 0===i?s:a instanceof r.a.Container?s+a.length():s+a.index(o,i)}),i=Math.min(Math.max.apply(Math,At(o)),this.scroll.length()-1),a=Math.min.apply(Math,[i].concat(At(o)));return new _t(a,i-a)}},{key:"normalizeNative",value:function(t){if(!Lt(this.root,t.startContainer)||!t.collapsed&&!Lt(this.root,t.endContainer))return null;var e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach(function(t){for(var e=t.node,n=t.offset;!(e instanceof Text)&&e.childNodes.length>0;)if(e.childNodes.length>n)e=e.childNodes[n],n=0;else{if(e.childNodes.length!==n)break;n=(e=e.lastChild)instanceof Text?e.data.length:e.childNodes.length+1}t.node=e,t.offset=n}),e}},{key:"rangeToNative",value:function(t){var e=this,n=t.collapsed?[t.index]:[t.index,t.index+t.length],o=[],r=this.scroll.length();return n.forEach(function(t,n){t=Math.min(r-1,t);var i,a=Dt(e.scroll.leaf(t),2),s=a[0],c=a[1],l=Dt(s.position(c,0!==n),2);i=l[0],c=l[1],o.push(i,c)}),o.length<2&&(o=o.concat(o)),o}},{key:"scrollIntoView",value:function(t){var e=this.lastRange;if(null!=e){var n=this.getBounds(e.index,e.length);if(null!=n){var o=this.scroll.length()-1,r=Dt(this.scroll.line(Math.min(e.index,o)),1)[0],i=r;if(e.length>0&&(i=Dt(this.scroll.line(Math.min(e.index+e.length,o)),1)[0]),null!=r&&null!=i){var a=t.getBoundingClientRect();n.top<a.top?t.scrollTop-=a.top-n.top:n.bottom>a.bottom&&(t.scrollTop+=n.bottom-a.bottom)}}}}},{key:"setNativeRange",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Mt.info("setNativeRange",t,e,n,o),null==t||null!=this.root.parentNode&&null!=t.parentNode&&null!=n.parentNode){var i=document.getSelection();if(null!=i)if(null!=t){this.hasFocus()||this.root.focus();var a=(this.getNativeRange()||{}).native;if(null==a||r||t!==a.startContainer||e!==a.startOffset||n!==a.endContainer||o!==a.endOffset){"BR"==t.tagName&&(e=[].indexOf.call(t.parentNode.childNodes,t),t=t.parentNode),"BR"==n.tagName&&(o=[].indexOf.call(n.parentNode.childNodes,n),n=n.parentNode);var s=document.createRange();s.setStart(t,e),s.setEnd(n,o),i.removeAllRanges(),i.addRange(s)}}else i.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:It.sources.API;if("string"==typeof e&&(n=e,e=!1),Mt.info("setRange",t),null!=t){var o=this.rangeToNative(t);this.setNativeRange.apply(this,At(o).concat([e]))}else this.setNativeRange(null);this.update(n)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It.sources.USER,e=this.lastRange,n=Dt(this.getRange(),2),o=n[0],r=n[1];if(this.lastRange=o,null!=this.lastRange&&(this.savedRange=this.lastRange),!st()(e,this.lastRange)){var i;!this.composing&&null!=r&&r.native.collapsed&&r.start.node!==this.cursor.textNode&&this.cursor.restore();var a,s=[It.events.SELECTION_CHANGE,it()(this.lastRange),it()(e),t];(i=this.emitter).emit.apply(i,[It.events.EDITOR_CHANGE].concat(s)),t!==It.sources.SILENT&&(a=this.emitter).emit.apply(a,s)}}}])&&jt(e.prototype,n),t}();function Lt(t,e){try{e.parentNode}catch(t){return!1}return e instanceof Text&&(e=e.parentNode),t.contains(e)}function Ft(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Ht=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quill=e,this.options=n,this.modules={}}var e,n;return e=t,(n=[{key:"init",value:function(){var t=this;Object.keys(this.options.modules).forEach(function(e){null==t.modules[e]&&t.addModule(e)})}},{key:"addModule",value:function(t){var e=this.quill.constructor.import("modules/".concat(t));return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}}])&&Ft(e.prototype,n),t}();Ht.DEFAULTS={modules:{}},Ht.themes={default:Ht};var Ut=Ht;function zt(t){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Kt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Gt(t,e,n){return e&&Kt(t.prototype,e),n&&Kt(t,n),t}var Wt=Ct("quill"),Yt=function(){function t(e){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=function(t,e){if((e=d()(!0,{container:t,modules:{clipboard:!0,keyboard:!0,history:!0}},e)).theme&&e.theme!==Yt.DEFAULTS.theme){if(e.theme=Yt.import("themes/".concat(e.theme)),null==e.theme)throw new Error("Invalid theme ".concat(e.theme,". Did you register it?"))}else e.theme=Ut;var n=d()(!0,{},e.theme.DEFAULTS);[n,e].forEach(function(t){t.modules=t.modules||{},Object.keys(t.modules).forEach(function(e){!0===t.modules[e]&&(t.modules[e]={})})});var o=Object.keys(n.modules).concat(Object.keys(e.modules)).reduce(function(t,e){var n=Yt.import("modules/".concat(e));return null==n?Wt.error("Cannot load ".concat(e," module. Are you sure you registered it?")):t[e]=n.DEFAULTS||{},t},{});return null!=e.modules&&e.modules.toolbar&&e.modules.toolbar.constructor!==Object&&(e.modules.toolbar={container:e.modules.toolbar}),e=d()(!0,{},Yt.DEFAULTS,{modules:o},n,e),["bounds","container","scrollingContainer"].forEach(function(t){"string"==typeof e[t]&&(e[t]=document.querySelector(e[t]))}),e.modules=Object.keys(e.modules).reduce(function(t,n){return e.modules[n]&&(t[n]=e.modules[n]),t},{}),e}(e,o),this.container=this.options.container,null==this.container)return Wt.error("Invalid Quill container",e);this.options.debug&&t.debug(this.options.debug);var i=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new It,this.scroll=r.a.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new ft(this.scroll),this.selection=new Bt(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(It.events.EDITOR_CHANGE,function(t){t===It.events.TEXT_CHANGE&&n.root.classList.toggle("ql-blank",n.editor.isBlank())}),this.emitter.on(It.events.SCROLL_UPDATE,function(t,e){var o=n.selection.lastRange,r=o&&0===o.length?o.index:void 0;Qt.call(n,function(){return n.editor.update(null,e,r)},t)});var a=this.clipboard.convert("<div class='ql-editor' style=\"white-space: normal;\">".concat(i,"<p><br></p></div>"));this.setContents(a),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return Gt(t,null,[{key:"debug",value:function(t){!0===t&&(t="log"),Ct.level(t)}},{key:"find",value:function(t){return t.__quill||r.a.find(t)}},{key:"import",value:function(t){return null==this.imports[t]&&Wt.error("Cannot import ".concat(t,". Are you sure it was registered?")),this.imports[t]}},{key:"register",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof t){var i=t.attrName||t.blotName;"string"==typeof i?this.register("formats/"+i,t,e):Object.keys(t).forEach(function(o){n.register(o,t[o],e)})}else null==this.imports[t]||o||Wt.warn("Overwriting ".concat(t," with"),e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&"abstract"!==e.blotName?r.a.register(e):t.startsWith("modules")&&"function"==typeof e.register&&e.register()}}]),Gt(t,[{key:"addContainer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof t){var n=t;(t=document.createElement("div")).classList.add(n)}return this.container.insertBefore(t,e),t}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(t,e,n){var o=this,r=qt(Jt(t,e,n),4);return t=r[0],e=r[1],n=r[3],Qt.call(this,function(){return o.editor.deleteText(t,e)},n,t,-1*e)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}},{key:"focus",value:function(){var t=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=t,this.scrollIntoView()}},{key:"format",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:It.sources.API;return Qt.call(this,function(){var o=n.getSelection(!0),i=new a.a;if(null==o)return i;if(r.a.query(t,r.a.Scope.BLOCK))i=n.editor.formatLine(o.index,o.length,Vt({},t,e));else{if(0===o.length)return n.selection.format(t,e),i;i=n.editor.formatText(o.index,o.length,Vt({},t,e))}return n.setSelection(o,It.sources.SILENT),i},o)}},{key:"formatLine",value:function(t,e,n,o,r){var i,a=this,s=qt(Jt(t,e,n,o,r),4);return t=s[0],e=s[1],i=s[2],r=s[3],Qt.call(this,function(){return a.editor.formatLine(t,e,i)},r,t,0)}},{key:"formatText",value:function(t,e,n,o,r){var i,a=this,s=qt(Jt(t,e,n,o,r),4);return t=s[0],e=s[1],i=s[2],r=s[3],Qt.call(this,function(){return a.editor.formatText(t,e,i)},r,t,0)}},{key:"getBounds",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e="number"==typeof t?this.selection.getBounds(t,n):this.selection.getBounds(t.index,t.length);var o=this.container.getBoundingClientRect();return{bottom:e.bottom-o.top,height:e.height,left:e.left-o.left,right:e.right-o.left,top:e.top-o.top,width:e.width}}},{key:"getContents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-t,n=qt(Jt(t,e),2);return t=n[0],e=n[1],this.editor.getContents(t,e)}},{key:"getFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof t?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}},{key:"getIndex",value:function(t){return t.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(t){return this.scroll.leaf(t)}},{key:"getLine",value:function(t){return this.scroll.line(t)}},{key:"getLines",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof t?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}},{key:"getModule",value:function(t){return this.theme.modules[t]}},{key:"getSelection",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-t,n=qt(Jt(t,e),2);return t=n[0],e=n[1],this.editor.getText(t,e)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(e,n,o){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.sources.API;return Qt.call(this,function(){return r.editor.insertEmbed(e,n,o)},i,e)}},{key:"insertText",value:function(t,e,n,o,r){var i,a=this,s=qt(Jt(t,0,n,o,r),4);return t=s[0],i=s[2],r=s[3],Qt.call(this,function(){return a.editor.insertText(t,e,i)},r,t,e.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(t,e,n){this.clipboard.dangerouslyPasteHTML(t,e,n)}},{key:"removeFormat",value:function(t,e,n){var o=this,r=qt(Jt(t,e,n),4);return t=r[0],e=r[1],n=r[3],Qt.call(this,function(){return o.editor.removeFormat(t,e)},n,t)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:It.sources.API;return Qt.call(this,function(){t=new a.a(t);var n=e.getLength(),o=e.editor.deleteText(0,n),r=e.editor.applyDelta(t),i=r.ops[r.ops.length-1];return null!=i&&"string"==typeof i.insert&&"\n"===i.insert[i.insert.length-1]&&(e.editor.deleteText(e.getLength()-1,1),r.delete(1)),o.compose(r)},n)}},{key:"setSelection",value:function(e,n,o){if(null==e)this.selection.setRange(null,n||t.sources.API);else{var r=qt(Jt(e,n,o),4);e=r[0],n=r[1],o=r[3],this.selection.setRange(new _t(e,n),o),o!==It.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:It.sources.API,n=(new a.a).insert(t);return this.setContents(n,e)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It.sources.USER,e=this.scroll.update(t);return this.selection.update(t),e}},{key:"updateContents",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:It.sources.API;return Qt.call(this,function(){return t=new a.a(t),e.editor.applyDelta(t,n)},n,!0)}}]),t}();function Qt(t,e,n,o){if(this.options.strict&&!this.isEnabled()&&e===It.sources.USER)return new a.a;var r=null==n?null:this.getSelection(),i=this.editor.delta,s=t();if(null!=r&&(!0===n&&(n=r.index),null==o?r=Xt(r,s,e):0!==o&&(r=Xt(r,n,o,e)),this.setSelection(r,It.sources.SILENT)),s.length()>0){var c,l,d=[It.events.TEXT_CHANGE,s,i,e];(c=this.emitter).emit.apply(c,[It.events.EDITOR_CHANGE].concat(d)),e!==It.sources.SILENT&&(l=this.emitter).emit.apply(l,d)}return s}function Jt(t,e,n,o,r){var i={};return"number"==typeof t.index&&"number"==typeof t.length?"number"!=typeof e?(r=o,o=n,n=e,e=t.length,t=t.index):(e=t.length,t=t.index):"number"!=typeof e&&(r=o,o=n,n=e,e=0),"object"===zt(n)?(i=n,r=o):"string"==typeof n&&(null!=o?i[n]=o:r=n),[t,e,i,r=r||It.sources.API]}function Xt(t,e,n,o){if(null==t)return null;var r,i;if(e instanceof a.a){var s=qt([t.index,t.index+t.length].map(function(t){return e.transformPosition(t,o!==It.sources.USER)}),2);r=s[0],i=s[1]}else{var c=qt([t.index,t.index+t.length].map(function(t){return t<e||t===e&&o===It.sources.USER?t:n>=0?t+n:Math.max(e,t+n)}),2);r=c[0],i=c[1]}return new _t(r,i-r)}function Zt(t){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $t(t){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function te(t,e){return(te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Yt.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},Yt.events=It.events,Yt.sources=It.sources,Yt.version="undefined"==typeof QUILL_VERSION?"dev":QUILL_VERSION,Yt.imports={delta:a.a,parchment:r.a,"core/module":Rt,"core/theme":Ut};var ee=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==Zt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,$t(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&te(t,e)}(e,r.a.Container),e}();ee.allowedChildren=[L,B,ee];var ne=ee;function oe(t){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function re(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ie(t,e,n){return(ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ae(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function se(t,e){return(se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ce="\ufeff",le=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==oe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,ae(e).call(this,t))).contentNode=document.createElement("span"),n.contentNode.setAttribute("contenteditable",!1),[].slice.call(n.domNode.childNodes).forEach(function(t){n.contentNode.appendChild(t)}),n.leftGuard=document.createTextNode(ce),n.rightGuard=document.createTextNode(ce),n.domNode.appendChild(n.leftGuard),n.domNode.appendChild(n.contentNode),n.domNode.appendChild(n.rightGuard),n}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&se(t,e)}(e,r.a.Embed),n=e,(o=[{key:"index",value:function(t,n){return t===this.leftGuard?0:t===this.rightGuard?1:ie(ae(e.prototype),"index",this).call(this,t,n)}},{key:"restore",value:function(t){var e,n,o=t.data.split(ce).join("");if(t===this.leftGuard)if(this.prev instanceof x){var i=this.prev.length();this.prev.insertAt(i,o),e={startNode:this.prev.domNode,startOffset:i+o.length}}else n=document.createTextNode(o),this.parent.insertBefore(r.a.create(n),this),e={startNode:n,startOffset:o.length};else t===this.rightGuard&&(this.next instanceof x?(this.next.insertAt(0,o),e={startNode:this.next.domNode,startOffset:o.length}):(n=document.createTextNode(o),this.parent.insertBefore(r.a.create(n),this.next),e={startNode:n,startOffset:o.length}));return t.data=ce,e}},{key:"update",value:function(t,e){var n=this;t.forEach(function(t){if("characterData"===t.type&&(t.target===n.leftGuard||t.target===n.rightGuard)){var o=n.restore(t.target);o&&(e.range=o)}})}}])&&re(n.prototype,o),e}();function de(t){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ue(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fe(t,e,n){return(fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=he(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function he(t){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function me(t,e){return(me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ye(t){return t instanceof L||t instanceof B}var ge=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e){return!e||"object"!==de(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,he(e).call(this,t))).emitter=n.emitter,Array.isArray(n.whitelist)&&(o.whitelist=n.whitelist.reduce(function(t,e){return t[e]=!0,t},{})),o.domNode.addEventListener("DOMNodeInserted",function(){}),o.optimize(),o.enable(),o}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&me(t,e)}(e,r.a.Scroll),n=e,(o=[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(t,n){var o=pe(this.line(t),2),r=o[0],i=o[1],a=pe(this.line(t+n),1)[0];if(fe(he(e.prototype),"deleteAt",this).call(this,t,n),null!=a&&r!==a&&i>0){if(r instanceof B||a instanceof B)return void this.optimize();if(r instanceof Q){var s=r.newlineIndex(r.length(),!0);if(s>-1&&(r=r.split(s+1))===a)return void this.optimize()}else if(a instanceof Q){var c=a.newlineIndex(0);c>-1&&a.split(c+1)}var l=a.children.head instanceof g?null:a.children.head;r.moveChildren(a,l),r.remove()}this.optimize()}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",t)}},{key:"formatAt",value:function(t,n,o,r){(null==this.whitelist||this.whitelist[o])&&(fe(he(e.prototype),"formatAt",this).call(this,t,n,o,r),this.optimize())}},{key:"insertAt",value:function(t,n,o){if(null==o||null==this.whitelist||this.whitelist[n]){if(t>=this.length())if(null==o||null==r.a.query(n,r.a.Scope.BLOCK)){var i=r.a.create(this.statics.defaultChild);this.appendChild(i),null==o&&n.endsWith("\n")&&(n=n.slice(0,-1)),i.insertAt(0,n,o)}else{var a=r.a.create(n,o);this.appendChild(a)}else fe(he(e.prototype),"insertAt",this).call(this,t,n,o);this.optimize()}}},{key:"insertBefore",value:function(t,n){if(t.statics.scope===r.a.Scope.INLINE_BLOT){var o=r.a.create(this.statics.defaultChild);o.appendChild(t),t=o}fe(he(e.prototype),"insertBefore",this).call(this,t,n)}},{key:"leaf",value:function(t){return this.path(t).pop()||[null,-1]}},{key:"line",value:function(t){return t===this.length()?this.line(t-1):this.descendant(ye,t)}},{key:"lines",value:function(){return function t(e,n,o){var i=[],a=o;return e.children.forEachAt(n,o,function(e,n,o){ye(e)?i.push(e):e instanceof r.a.Container&&(i=i.concat(t(e,n,a))),a-=o}),i}(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE)}},{key:"optimize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!0!==this.batch&&(fe(he(e.prototype),"optimize",this).call(this,t,n),t.length>0&&this.emitter.emit(It.events.SCROLL_OPTIMIZE,t,n))}},{key:"path",value:function(t){return fe(he(e.prototype),"path",this).call(this,t).slice(1)}},{key:"update",value:function(t){if(!0!==this.batch){var n=It.sources.USER;"string"==typeof t&&(n=t),Array.isArray(t)||(t=this.observer.takeRecords()),t.length>0&&this.emitter.emit(It.events.SCROLL_BEFORE_UPDATE,n,t),fe(he(e.prototype),"update",this).call(this,t.concat([])),t.length>0&&this.emitter.emit(It.events.SCROLL_UPDATE,n,t)}}}])&&ue(n.prototype,o),e}();ge.blotName="scroll",ge.className="ql-editor",ge.tagName="DIV",ge.defaultChild="block",ge.allowedChildren=[L,B,ne];var be=ge;function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ce(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function xe(t,e,n){return(xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Te(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Te(t){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Se=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==ve(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,Te(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(e,I),n=e,r=[{key:"create",value:function(t){var n=xe(Te(e),"create",this).call(this,t);return t=this.sanitize(t),n.setAttribute("href",t),n.setAttribute("target","_blank"),n}},{key:"formats",value:function(t){return t.getAttribute("href")}},{key:"sanitize",value:function(t){return function(t,e){var n=document.createElement("a");n.href=t;var o=n.href.slice(0,n.href.indexOf(":"));return e.indexOf(o)>-1}(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}}],(o=[{key:"format",value:function(t,n){if(t!==this.statics.blotName||!n)return xe(Te(e.prototype),"format",this).call(this,t,n);n=this.constructor.sanitize(n),this.domNode.setAttribute("href",n)}}])&&Ce(n.prototype,o),r&&Ce(n,r),e}();function Ee(t){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function we(t,e,n){return(we="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ie(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ie(t){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ke(t,e){return(ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Se.blotName="link",Se.tagName="A",Se.SANITIZED_URL="about:blank",Se.PROTOCOL_WHITELIST=["http","https","mailto","tel"];var Re=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==Ee(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,Ie(e).apply(this,arguments))}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ke(t,e)}(e,r.a.Attributor.Style),n=e,(o=[{key:"value",value:function(t){var n=we(Ie(e.prototype),"value",this).call(this,t);return n.startsWith("rgb(")?"#"+(n=n.replace(/^[^\d]+/,"").replace(/[^\d]+$/,"")).split(",").map(function(t){return("00"+parseInt(t).toString(16)).slice(-2)}).join(""):n}}])&&Pe(n.prototype,o),e}(),Ae=(new r.a.Attributor.Class("color","ql-color",{scope:r.a.Scope.INLINE}),new Re("color","color",{scope:r.a.Scope.INLINE}));function De(t){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ne(t,e,n){return(Ne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Me(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Me(t){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _e(t,e){return(_e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Be={scope:r.a.Scope.INLINE,whitelist:["serif","monospace"]},Le=(new r.a.Attributor.Class("font","ql-font",Be),new(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==De(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,Me(e).apply(this,arguments))}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_e(t,e)}(e,r.a.Attributor.Style),n=e,(o=[{key:"value",value:function(t){return Ne(Me(e.prototype),"value",this).call(this,t).replace(/["']/g,"")}}])&&je(n.prototype,o),e}())("font","font-family",Be)),Fe=(new r.a.Attributor.Class("size","ql-size",{scope:r.a.Scope.INLINE,whitelist:["small","large","huge"]}),new r.a.Attributor.Style("size","font-size",{scope:r.a.Scope.INLINE,whitelist:["10px","18px","32px"]})),He=(new r.a.Attributor.Class("background","ql-bg",{scope:r.a.Scope.INLINE}),new Re("background","background-color",{scope:r.a.Scope.INLINE}));function Ue(t){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ze(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ve(t,e,n){return(Ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qe(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qe(t){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ke(t,e){return(Ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ge=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==Ue(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,qe(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ke(t,e)}(e,I),n=e,r=[{key:"create",value:function(){return Ve(qe(e),"create",this).call(this)}},{key:"formats",value:function(){return!0}}],(o=[{key:"optimize",value:function(t){Ve(qe(e.prototype),"optimize",this).call(this,t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}])&&ze(n.prototype,o),r&&ze(n,r),e}();Ge.blotName="bold",Ge.tagName=["STRONG","B"];var We=Ge;function Ye(t){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qe(t){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Je(t,e){return(Je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==Ye(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,Qe(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Je(t,e)}(e,We),e}();Xe.blotName="italic",Xe.tagName=["EM","I"];var Ze=Xe;function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t){return(tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function en(t,e){return(en=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==$e(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,tn(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&en(t,e)}(e,I),e}();nn.blotName="underline",nn.tagName="U";var on=nn;function rn(t){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sn(t,e){return(sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==rn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,an(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sn(t,e)}(e,I),e}();cn.blotName="strike",cn.tagName="S";var ln=cn;function dn(t){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function un(t,e,n){return(un="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fn(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function fn(t){return(fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hn(t,e){return(hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,fn(e).apply(this,arguments))}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hn(t,e)}(e,I),n=e,(o=[{key:"create",value:function(t){return"super"===t?document.createElement("sup"):"sub"===t?document.createElement("sub"):un(fn(e),"create",this).call(this,t)}},{key:"formats",value:function(t){return"SUB"===t.tagName?"sub":"SUP"===t.tagName?"super":void 0}}])&&pn(n,o),e}();mn.blotName="script",mn.tagName=["SUB","SUP"];var yn=mn,gn={scope:r.a.Scope.BLOCK,whitelist:["right","center","justify"]},bn=new r.a.Attributor.Attribute("align","align",gn),vn=(new r.a.Attributor.Class("align","ql-align",gn),new r.a.Attributor.Style("align","text-align",gn)),Cn={scope:r.a.Scope.BLOCK,whitelist:["rtl"]},xn=new r.a.Attributor.Attribute("direction","dir",Cn),Tn=(new r.a.Attributor.Class("direction","ql-direction",Cn),new r.a.Attributor.Style("direction","direction",Cn));function On(t){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function En(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Pn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wn(t){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function In(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kn(t,e){return(kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rn=Ct("quill:clipboard"),An="__ql-matcher",Dn=[[Node.TEXT_NODE,function(t,e){var n=t.data;if("O:P"===t.parentNode.tagName)return e.insert(n.trim());if(0===n.trim().length&&t.parentNode.classList.contains("ql-clipboard"))return e;if(!Bn(t.parentNode).whiteSpace.startsWith("pre")){var o=function(t,e){return(e=e.replace(/[^\u00a0]/g,"")).length<1&&t?" ":e};n=(n=n.replace(/\r\n/g," ").replace(/\n/g," ")).replace(/\s\s+/g,o.bind(o,!0)),(null==t.previousSibling&&Fn(t.parentNode)||null!=t.previousSibling&&Fn(t.previousSibling))&&(n=n.replace(/^\s+/,o.bind(o,!1))),(null==t.nextSibling&&Fn(t.parentNode)||null!=t.nextSibling&&Fn(t.nextSibling))&&(n=n.replace(/\s+$/,o.bind(o,!1)))}return e.insert(n)}],[Node.TEXT_NODE,Un],["br",function(t,e){return Ln(e,"\n")||e.insert("\n"),e}],[Node.ELEMENT_NODE,Un],[Node.ELEMENT_NODE,function(t,e){var n=r.a.query(t);if(null==n)return e;if(n.prototype instanceof r.a.Embed){var o={},i=n.value(t);null!=i&&(o[n.blotName]=i,e=(new a.a).insert(o,n.formats(t)))}else"function"==typeof n.formats&&(e=_n(e,n.blotName,n.formats(t)));return e}],[Node.ELEMENT_NODE,zn],[Node.ELEMENT_NODE,function(t,e){var n=r.a.Attributor.Attribute.keys(t),o=r.a.Attributor.Class.keys(t),i=r.a.Attributor.Style.keys(t),a={};return n.concat(o).concat(i).forEach(function(e){var n=r.a.query(e,r.a.Scope.ATTRIBUTE);null!=n&&(a[n.attrName]=n.value(t),a[n.attrName])||(null==(n=jn[e])||n.attrName!==e&&n.keyName!==e||(a[n.attrName]=n.value(t)||void 0),null==(n=Nn[e])||n.attrName!==e&&n.keyName!==e||(n=Nn[e],a[n.attrName]=n.value(t)||void 0))}),Object.keys(a).length>0&&(e=_n(e,a)),e}],[Node.ELEMENT_NODE,function(t,e){var n={},o=t.style||{};return o.fontStyle&&"italic"===Bn(t).fontStyle&&(n.italic=!0),o.fontWeight&&(Bn(t).fontWeight.startsWith("bold")||parseInt(Bn(t).fontWeight)>=700)&&(n.bold=!0),Object.keys(n).length>0&&(e=_n(e,n)),parseFloat(o.textIndent||0)>0&&(e=(new a.a).insert("\t").concat(e)),e}],["li",function(t,e){var n=r.a.query(t);if(null==n||"list-item"!==n.blotName||!Ln(e,"\n"))return e;for(var o=-1,i=t.parentNode;!i.classList.contains("ql-clipboard");)"list"===(r.a.query(i)||{}).blotName&&(o+=1),i=i.parentNode;return o<=0?e:e.compose((new a.a).retain(e.length()-1).retain(1,{indent:o}))}],["b",Hn.bind(Hn,"bold")],["i",Hn.bind(Hn,"italic")],["style",function(){return new a.a}]],jn=[bn,xn].reduce(function(t,e){return t[e.keyName]=e,t},{}),Nn=[vn,He,Ae,Tn,Le,Fe].reduce(function(t,e){return t[e.keyName]=e,t},{}),Mn=function(t){function e(t,n){var o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=wn(e).call(this,t,n),(o=!r||"object"!==On(r)&&"function"!=typeof r?In(this):r).quill.root.addEventListener("paste",o.onPaste.bind(In(o))),o.container=o.quill.addContainer("ql-clipboard"),o.container.setAttribute("contenteditable",!0),o.container.setAttribute("tabindex",-1),o.matchers=[],Dn.concat(o.options.matchers).forEach(function(t){var e=En(t,2),r=e[0],i=e[1];(n.matchVisual||i!==zn)&&o.addMatcher(r,i)}),o}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kn(t,e)}(e,Rt),n=e,(o=[{key:"addMatcher",value:function(t,e){this.matchers.push([t,e])}},{key:"convert",value:function(t){if("string"==typeof t)return this.container.innerHTML=t.replace(/\>\r?\n +\</g,"><"),this.convert();var e=this.quill.getFormat(this.quill.selection.savedRange.index);if(e[Q.blotName]){var n=this.container.innerText;return this.container.innerHTML="",(new a.a).insert(n,Sn({},Q.blotName,e[Q.blotName]))}var o=En(this.prepareMatching(),2),r=o[0],i=o[1],s=function t(e,n,o){return e.nodeType===e.TEXT_NODE?o.reduce(function(t,n){return n(e,t)},new a.a):e.nodeType===e.ELEMENT_NODE?[].reduce.call(e.childNodes||[],function(r,i){var a=t(i,n,o);return i.nodeType===e.ELEMENT_NODE&&(a=n.reduce(function(t,e){return e(i,t)},a),a=(i[An]||[]).reduce(function(t,e){return e(i,t)},a)),r.concat(a)},new a.a):new a.a}(this.container,r,i);return Ln(s,"\n")&&null==s.ops[s.ops.length-1].attributes&&(s=s.compose((new a.a).retain(s.length()-1).delete(1))),Rn.log("convert",this.container.innerHTML,s),this.container.innerHTML="",s}},{key:"dangerouslyPasteHTML",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yt.sources.API;if("string"==typeof t)this.quill.setContents(this.convert(t),e),this.quill.setSelection(0,Yt.sources.SILENT);else{var o=this.convert(e);this.quill.updateContents((new a.a).retain(t).concat(o),n),this.quill.setSelection(t+o.length(),Yt.sources.SILENT)}}},{key:"onPaste",value:function(t){var e=this;if(!t.defaultPrevented&&this.quill.isEnabled()){var n=this.quill.getSelection(),o=(new a.a).retain(n.index),r=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(Yt.sources.SILENT),setTimeout(function(){o=o.concat(e.convert()).delete(n.length),e.quill.updateContents(o,Yt.sources.USER),e.quill.setSelection(o.length()-n.length,Yt.sources.SILENT),e.quill.scrollingContainer.scrollTop=r,e.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var t=this,e=[],n=[];return this.matchers.forEach(function(o){var r=En(o,2),i=r[0],a=r[1];switch(i){case Node.TEXT_NODE:n.push(a);break;case Node.ELEMENT_NODE:e.push(a);break;default:[].forEach.call(t.container.querySelectorAll(i),function(t){t[An]=t[An]||[],t[An].push(a)})}}),[e,n]}}])&&Pn(n.prototype,o),e}();function _n(t,e,n){return"object"===On(e)?Object.keys(e).reduce(function(t,n){return _n(t,n,e[n])},t):t.reduce(function(t,o){return o.attributes&&o.attributes[e]?t.push(o):t.insert(o.insert,d()({},Sn({},e,n),o.attributes))},new a.a)}function Bn(t){return t.nodeType!==Node.ELEMENT_NODE?{}:t["__ql-computed-style"]||(t["__ql-computed-style"]=window.getComputedStyle(t))}function Ln(t,e){for(var n="",o=t.ops.length-1;o>=0&&n.length<e.length;--o){var r=t.ops[o];if("string"!=typeof r.insert)break;n=r.insert+n}return n.slice(-1*e.length)===e}function Fn(t){if(0===t.childNodes.length)return!1;var e=Bn(t);return["block","list-item"].indexOf(e.display)>-1}function Hn(t,e,n){return _n(n,t,!0)}function Un(t,e){return Ln(e,"\n")||(Fn(t)||e.length()>0&&t.nextSibling&&Fn(t.nextSibling))&&e.insert("\n"),e}function zn(t,e){if(Fn(t)&&null!=t.nextElementSibling&&!Ln(e,"\n\n")){var n=t.offsetHeight+parseFloat(Bn(t).marginTop)+parseFloat(Bn(t).marginBottom);t.nextElementSibling.offsetTop>t.offsetTop+1.5*n&&e.insert("\n")}return e}function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kn(t){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wn(t,e){return(Wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Mn.DEFAULTS={matchers:[],matchVisual:!0};var Yn=function(t){function e(t,n){var o,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=Kn(e).call(this,t,n),(o=!r||"object"!==Vn(r)&&"function"!=typeof r?Gn(this):r).lastRecorded=0,o.ignoreChange=!1,o.clear(),o.quill.on(Yt.events.EDITOR_CHANGE,function(t,e,n,r){t!==Yt.events.TEXT_CHANGE||o.ignoreChange||(o.options.userOnly&&r!==Yt.sources.USER?o.transform(e):o.record(e,n))}),o.quill.keyboard.addBinding({key:"Z",shortKey:!0},o.undo.bind(Gn(o))),o.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},o.redo.bind(Gn(o))),/Win/i.test(navigator.platform)&&o.quill.keyboard.addBinding({key:"Y",shortKey:!0},o.redo.bind(Gn(o))),o}var n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wn(t,e)}(e,Rt),n=e,(o=[{key:"change",value:function(t,e){if(0!==this.stack[t].length){var n=this.stack[t].pop();this.stack[e].push(n),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n[t],Yt.sources.USER),this.ignoreChange=!1;var o=function(t){var e=t.reduce(function(t,e){return t+(e.delete||0)},0),n=t.length()-e;return function(t){var e=t.ops[t.ops.length-1];return null!=e&&(null!=e.insert?"string"==typeof e.insert&&e.insert.endsWith("\n"):null!=e.attributes&&Object.keys(e.attributes).some(function(t){return null!=r.a.query(t,r.a.Scope.BLOCK)}))}(t)&&(n-=1),n}(n[t]);this.quill.setSelection(o)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(t,e){if(0!==t.ops.length){this.stack.redo=[];var n=this.quill.getContents().diff(e),o=Date.now();if(this.lastRecorded+this.options.delay>o&&this.stack.undo.length>0){var r=this.stack.undo.pop();n=n.compose(r.undo),t=r.redo.compose(t)}else this.lastRecorded=o;this.stack.undo.push({redo:t,undo:n}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(t){this.stack.undo.forEach(function(e){e.undo=t.transform(e.undo,!0),e.redo=t.transform(e.redo,!0)}),this.stack.redo.forEach(function(e){e.undo=t.transform(e.undo,!0),e.redo=t.transform(e.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}])&&qn(n.prototype,o),e}();function Qn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jn(t){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function to(t,e,n){return e&&$n(t.prototype,e),n&&$n(t,n),t}function eo(t,e){return(eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Yn.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};var no=Ct("quill:keyboard"),oo=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",ro=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e){return!e||"object"!==Jn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,Zn(e).call(this,t,n))).bindings={},Object.keys(o.options.bindings).forEach(function(e){("list autofill"!==e||null==t.scroll.whitelist||t.scroll.whitelist.list)&&o.options.bindings[e]&&o.addBinding(o.options.bindings[e])}),o.addBinding({key:e.keys.ENTER,shiftKey:null},lo),o.addBinding({key:e.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(o.addBinding({key:e.keys.BACKSPACE},{collapsed:!0},ao),o.addBinding({key:e.keys.DELETE},{collapsed:!0},so)):(o.addBinding({key:e.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},ao),o.addBinding({key:e.keys.DELETE},{collapsed:!0,suffix:/^.?$/},so)),o.addBinding({key:e.keys.BACKSPACE},{collapsed:!1},co),o.addBinding({key:e.keys.DELETE},{collapsed:!1},co),o.addBinding({key:e.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},ao),o.listen(),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eo(t,e)}(e,Rt),to(e,null,[{key:"match",value:function(t,e){return e=fo(e),!["altKey","ctrlKey","metaKey","shiftKey"].some(function(n){return!!e[n]!==t[n]&&null!==e[n]})&&e.key===(t.which||t.keyCode)}}]),to(e,[{key:"addBinding",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=fo(t);if(null==o||null==o.key)return no.warn("Attempted to add invalid keyboard binding",o);"function"==typeof e&&(e={handler:e}),"function"==typeof n&&(n={handler:n}),o=d()(o,e,n),this.bindings[o.key]=this.bindings[o.key]||[],this.bindings[o.key].push(o)}},{key:"listen",value:function(){var t=this;this.quill.root.addEventListener("keydown",function(n){if(!n.defaultPrevented){var o=n.which||n.keyCode,i=(t.bindings[o]||[]).filter(function(t){return e.match(n,t)});if(0!==i.length){var a=t.quill.getSelection();if(null!=a&&t.quill.hasFocus()){var s=Xn(t.quill.getLine(a.index),2),c=s[0],l=s[1],d=Xn(t.quill.getLeaf(a.index),2),p=d[0],u=d[1],f=Xn(0===a.length?[p,u]:t.quill.getLeaf(a.index+a.length),2),h=f[0],m=f[1],y=p instanceof r.a.Text?p.value().slice(0,u):"",g=h instanceof r.a.Text?h.value().slice(m):"",b={collapsed:0===a.length,empty:0===a.length&&c.length()<=1,format:t.quill.getFormat(a),offset:l,prefix:y,suffix:g};i.some(function(e){if(null!=e.collapsed&&e.collapsed!==b.collapsed)return!1;if(null!=e.empty&&e.empty!==b.empty)return!1;if(null!=e.offset&&e.offset!==b.offset)return!1;if(Array.isArray(e.format)){if(e.format.every(function(t){return null==b.format[t]}))return!1}else if("object"===Jn(e.format)&&!Object.keys(e.format).every(function(t){return!0===e.format[t]?null!=b.format[t]:!1===e.format[t]?null==b.format[t]:st()(e.format[t],b.format[t])}))return!1;return!(null!=e.prefix&&!e.prefix.test(b.prefix)||null!=e.suffix&&!e.suffix.test(b.suffix)||!0===e.handler.call(t,a,b))})&&n.preventDefault()}}}})}}]),e}();function io(t,e){var n,o=t===ro.keys.LEFT?"prefix":"suffix";return Qn(n={key:t,shiftKey:e,altKey:null},o,/^$/),Qn(n,"handler",function(n){var o=n.index;return t===ro.keys.RIGHT&&(o+=n.length+1),!(Xn(this.quill.getLeaf(o),1)[0]instanceof r.a.Embed&&(t===ro.keys.LEFT?e?this.quill.setSelection(n.index-1,n.length+1,Yt.sources.USER):this.quill.setSelection(n.index-1,Yt.sources.USER):e?this.quill.setSelection(n.index,n.length+1,Yt.sources.USER):this.quill.setSelection(n.index+n.length+1,Yt.sources.USER),1))}),n}function ao(t,e){if(!(0===t.index||this.quill.getLength()<=1)){var n=Xn(this.quill.getLine(t.index),1)[0],o={};if(0===e.offset){var r=Xn(this.quill.getLine(t.index-1),1)[0];if(null!=r&&r.length()>1){var i=n.formats(),a=this.quill.getFormat(t.index-1,1);o=c.a.attributes.diff(i,a)||{}}}var s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;this.quill.deleteText(t.index-s,s,Yt.sources.USER),Object.keys(o).length>0&&this.quill.formatLine(t.index-s,s,o,Yt.sources.USER),this.quill.focus()}}function so(t,e){var n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(!(t.index>=this.quill.getLength()-n)){var o={},r=0,i=Xn(this.quill.getLine(t.index),1)[0];if(e.offset>=i.length()-1){var a=Xn(this.quill.getLine(t.index+1),1)[0];if(a){var s=i.formats(),l=this.quill.getFormat(t.index,1);o=c.a.attributes.diff(s,l)||{},r=a.length()}}this.quill.deleteText(t.index,n,Yt.sources.USER),Object.keys(o).length>0&&this.quill.formatLine(t.index+r-1,n,o,Yt.sources.USER)}}function co(t){var e=this.quill.getLines(t),n={};if(e.length>1){var o=e[0].formats(),r=e[e.length-1].formats();n=c.a.attributes.diff(r,o)||{}}this.quill.deleteText(t,Yt.sources.USER),Object.keys(n).length>0&&this.quill.formatLine(t.index,1,n,Yt.sources.USER),this.quill.setSelection(t.index,Yt.sources.SILENT),this.quill.focus()}function lo(t,e){var n=this;t.length>0&&this.quill.scroll.deleteAt(t.index,t.length);var o=Object.keys(e.format).reduce(function(t,n){return r.a.query(n,r.a.Scope.BLOCK)&&!Array.isArray(e.format[n])&&(t[n]=e.format[n]),t},{});this.quill.insertText(t.index,"\n",o,Yt.sources.USER),this.quill.setSelection(t.index+1,Yt.sources.SILENT),this.quill.focus(),Object.keys(e.format).forEach(function(t){null==o[t]&&(Array.isArray(e.format[t])||"link"!==t&&n.quill.format(t,e.format[t],Yt.sources.USER))})}function po(t){return{key:ro.keys.TAB,shiftKey:!t,format:{"code-block":!0},handler:function(e){var n=r.a.query("code-block"),o=e.index,i=e.length,a=Xn(this.quill.scroll.descendant(n,o),2),s=a[0],c=a[1];if(null!=s){var l=this.quill.getIndex(s),d=s.newlineIndex(c,!0)+1,p=s.newlineIndex(l+c+i),u=s.domNode.textContent.slice(d,p).split("\n");c=0,u.forEach(function(e,r){t?(s.insertAt(d+c,n.TAB),c+=n.TAB.length,0===r?o+=n.TAB.length:i+=n.TAB.length):e.startsWith(n.TAB)&&(s.deleteAt(d+c,n.TAB.length),c-=n.TAB.length,0===r?o-=n.TAB.length:i-=n.TAB.length),c+=e.length+1}),this.quill.update(Yt.sources.USER),this.quill.setSelection(o,i,Yt.sources.SILENT)}}}}function uo(t){return{key:t[0].toUpperCase(),shortKey:!0,handler:function(e,n){this.quill.format(t,!n.format[t],Yt.sources.USER)}}}function fo(t){if("string"==typeof t||"number"==typeof t)return fo({key:t});if("object"===Jn(t)&&(t=it()(t,!1)),"string"==typeof t.key)if(null!=ro.keys[t.key.toUpperCase()])t.key=ro.keys[t.key.toUpperCase()];else{if(1!==t.key.length)return null;t.key=t.key.toUpperCase().charCodeAt(0)}return t.shortKey&&(t[oo]=t.shortKey,delete t.shortKey),t}ro.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},ro.DEFAULTS={bindings:{bold:uo("bold"),italic:uo("italic"),underline:uo("underline"),indent:{key:ro.keys.TAB,format:["blockquote","indent","list"],handler:function(t,e){if(e.collapsed&&0!==e.offset)return!0;this.quill.format("indent","+1",Yt.sources.USER)}},outdent:{key:ro.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(t,e){if(e.collapsed&&0!==e.offset)return!0;this.quill.format("indent","-1",Yt.sources.USER)}},"outdent backspace":{key:ro.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(t,e){null!=e.format.indent?this.quill.format("indent","-1",Yt.sources.USER):null!=e.format.list&&this.quill.format("list",!1,Yt.sources.USER)}},"indent code-block":po(!0),"outdent code-block":po(!1),"remove tab":{key:ro.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(t){this.quill.deleteText(t.index-1,1,Yt.sources.USER)}},tab:{key:ro.keys.TAB,handler:function(t){this.quill.history.cutoff();var e=(new a.a).retain(t.index).delete(t.length).insert("\t");this.quill.updateContents(e,Yt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,Yt.sources.SILENT)}},"list empty enter":{key:ro.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(t,e){this.quill.format("list",!1,Yt.sources.USER),e.format.indent&&this.quill.format("indent",!1,Yt.sources.USER)}},"checklist enter":{key:ro.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(t){var e=Xn(this.quill.getLine(t.index),2),n=e[0],o=e[1],r=d()({},n.formats(),{list:"checked"}),i=(new a.a).retain(t.index).insert("\n",r).retain(n.length()-o-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,Yt.sources.USER),this.quill.setSelection(t.index+1,Yt.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:ro.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(t,e){var n=Xn(this.quill.getLine(t.index),2),o=n[0],r=n[1],i=(new a.a).retain(t.index).insert("\n",e.format).retain(o.length()-r-1).retain(1,{header:null});this.quill.updateContents(i,Yt.sources.USER),this.quill.setSelection(t.index+1,Yt.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(t,e){var n,o=e.prefix.length,r=Xn(this.quill.getLine(t.index),2),i=r[0],s=r[1];if(s>o)return!0;switch(e.prefix.trim()){case"[]":case"[ ]":n="unchecked";break;case"[x]":n="checked";break;case"-":case"*":n="bullet";break;default:n="ordered"}this.quill.insertText(t.index," ",Yt.sources.USER),this.quill.history.cutoff();var c=(new a.a).retain(t.index-s).delete(o+1).retain(i.length()-2-s).retain(1,{list:n});this.quill.updateContents(c,Yt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-o,Yt.sources.SILENT)}},"code exit":{key:ro.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(t){var e=Xn(this.quill.getLine(t.index),2),n=e[0],o=e[1],r=(new a.a).retain(t.index+n.length()-o-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(r,Yt.sources.USER)}},"embed left":io(ro.keys.LEFT,!1),"embed left shift":io(ro.keys.LEFT,!0),"embed right":io(ro.keys.RIGHT,!1),"embed right shift":io(ro.keys.RIGHT,!0)}},Yt.register({"blots/block":L,"blots/block/embed":B,"blots/break":g,"blots/container":ne,"blots/cursor":ot,"blots/embed":le,"blots/inline":I,"blots/scroll":be,"blots/text":x,"formats/link":Se,"formats/color":Ae,"formats/font":Le,"formats/size":Fe,"formats/background":He,"formats/bold":We,"formats/italic":Ze,"formats/underline":on,"formats/strike":ln,"formats/script":yn,"modules/clipboard":Mn,"modules/history":Yn,"modules/keyboard":ro}),r.a.register(L,g,ot,I,be,x),e.default=Yt}])},751:function(t,e,n){var o=n(0);function r(t){return o.createElement("svg",t,[o.createElement("defs",{key:0},[o.createElement("rect",{id:"path-1",x:"2",y:"1",width:"270",height:"60",key:0}),o.createElement("filter",{x:"-1.3%",y:"-4.2%",width:"102.6%",height:"111.7%",filterUnits:"objectBoundingBox",id:"filter-2",key:1},[o.createElement("feOffset",{dx:"0",dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter1",key:0}),o.createElement("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter1",result:"shadowBlurOuter1",key:1}),o.createElement("feComposite",{in:"shadowBlurOuter1",in2:"SourceAlpha",operator:"out",result:"shadowBlurOuter1",key:2}),o.createElement("feColorMatrix",{values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0",type:"matrix",in:"shadowBlurOuter1",key:3})])]),o.createElement("g",{id:"Redlines",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",opacity:"0.718693388",key:1},o.createElement("g",{id:"GhostCard_52px"},[o.createElement("g",{id:"Rectangle-2",key:0},[o.createElement("use",{fill:"black",fillOpacity:"1",filter:"url(#filter-2)",xlinkHref:"#path-1",key:0}),o.createElement("use",{fill:"#FFFFFF",fillRule:"evenodd",xlinkHref:"#path-1",key:1}),o.createElement("rect",{stroke:"#EAEAEA",strokeWidth:"1",x:"2.5",y:"1.5",width:"269",height:"59",key:2})]),o.createElement("circle",{id:"Oval-8",fill:"#EAEAEA",cx:"27",cy:"28",r:"14",key:1}),o.createElement("rect",{id:"Rectangle1",fill:"#EAEAEA",x:"55",y:"16",width:"92",height:"11",rx:"5.5",key:2}),o.createElement("rect",{id:"Rectangle2",fill:"#EAEAEA",x:"55",y:"34",width:"204",height:"11",rx:"5.5",key:3})]))])}r.defaultProps={width:"274px",height:"52px",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 274 52",focusable:"false",version:"1.1"},t.exports=r,r.default=r},752:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(753);e.Text=o.Text},753:function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),s=n(754),c=n(69),l={defaultStyle:{position:"relative",display:"inline",flex:"0 0 auto",overflow:"hidden",whiteSpace:"pre-wrap",overflowWrap:"break-word",msHyphens:"auto"},ellipsis:{position:"relative",display:"inline",flex:"0 0 auto",overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"}},d={SmallStandard:"ms-font-s",SmallSecondary:"ms-font-s",MediumStandard:"ms-font-m",MediumSecondary:"ms-font-m",MediumApp:"ms-font-m",MediumBold:"ms-font-m ms-fontWeight-semibold",MediumBoldApp:"ms-font-m ms-fontWeight-semibold",LargeStandard:"ms-font-m-plus",LargePlusStandard:"ms-font-l",ExtraLargeStandard:"ms-font-xl",HugeStandard:"ms-font-xxl"},p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.render=function(){return"string"==typeof this.props.children&&"\n"===this.props.children?a.createElement("br",null):a.createElement("div",{style:this._getStyles(),className:d[this.props.textStyle]||"ms-font-m"},this.props.children)},e.prototype._getStyles=function(){var t=this.context.palette?this.context.palette:s.Palettes.Default,e=i({},1===this.props.numberOfLines?l.ellipsis:l.defaultStyle);if(this.props.disabled)e.color=t.TextDisabled;else switch(this.props.textStyle){case"SmallStandard":e.color=t.Text;break;case"SmallSecondary":e.color=t.TextSecondary;break;case"MediumStandard":e.color=t.Text;break;case"MediumSecondary":e.color=t.TextSecondary;break;case"MediumApp":e.color=t.TextEmphasis;break;case"MediumBold":e.color=t.Text;break;case"MediumBoldApp":e.color=t.TextEmphasis;break;case"LargeStandard":case"LargePlusStandard":case"ExtraLargeStandard":case"HugeStandard":e.color=t.Text;break;default:e.color=t.Text}return e},e.contextTypes={palette:c.object},e}(a.Component);e.Text=p,e.default=p},754:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(755);e.Palettes=o.Palettes;var r=n(0).createContext(o.Palettes.Default);e.PalettesContext=r},755:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=function(){function t(){this._buildIn={ID:0,Bkg:"#FFFFFF",Text:"#262626",TextSecondary:"#666666",TextEmphasis:"#2B579A",TextDisabled:"#B1B1B1",AccentLight:"#E6E6E6",BkgCtl:"#FFFFFFFF",BkgHover:"#EDEBE9",BkgPressed:"#E1DFDD",BkgDisabled:"#D2D0CE",TextRest:"#262626FF",TextHover:"#262626FF",TextPressed:"#262626FF",TextLink:"357FCAFF"}}return Object.defineProperty(t.prototype,"Default",{get:function(){return this._buildIn},enumerable:!0,configurable:!0}),t.prototype.getPalette=function(t){return this._buildIn},t}();e.PalettesCollection=r,e.Palettes=new r,e.PalettesContext=o.createContext(e.Palettes.Default)}}]);
//# sourceMappingURL=sharedCommentsLazy.min.js.map